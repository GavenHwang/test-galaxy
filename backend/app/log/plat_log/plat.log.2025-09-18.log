[2025-09-18 11:16:16,506] [INFO] Started server process [14152]
[2025-09-18 11:16:16,506] [INFO] Waiting for application startup.
[2025-09-18 11:16:16,506] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 11:16:16,531] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 11:16:16,558] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000018FD6E1E150> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 11:16:16,559] [DEBUG] SELECT `id`,`app`,`content`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 11:16:16,564] [DEBUG] select version() as version: None
[2025-09-18 11:16:16,567] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 11:16:16,567] [DEBUG] SELECT `updated_time`,`created_time`,`parent_id`,`path`,`label`,`icon`,`id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/home', 2]
[2025-09-18 11:16:16,569] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 10, 17, 56, 46, 309331, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 11, 16, 16, 569640, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '首页', '/home', 'house', None, 1]
[2025-09-18 11:16:16,572] [DEBUG] SELECT `updated_time`,`created_time`,`parent_id`,`path`,`label`,`icon`,`id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/', 2]
[2025-09-18 11:16:16,573] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 10, 17, 56, 46, 311314, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 11, 16, 16, 573113, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '环境', '/', 'location', None, 2]
[2025-09-18 11:16:16,575] [DEBUG] SELECT `updated_time`,`created_time`,`parent_id`,`path`,`label`,`icon`,`id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/env/info', 2]
[2025-09-18 11:16:16,576] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 10, 17, 56, 46, 313314, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 11, 16, 16, 576344, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '环境信息', '/env/info', 'setting', 2, 3]
[2025-09-18 11:16:16,577] [DEBUG] SELECT `updated_time`,`created_time`,`parent_id`,`path`,`label`,`icon`,`id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/env/version', 2]
[2025-09-18 11:16:16,578] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 10, 17, 56, 46, 315313, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 11, 16, 16, 578541, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '组件版本', '/env/version', 'setting', 2, 4]
[2025-09-18 11:16:16,580] [DEBUG] SELECT `updated_time`,`created_time`,`parent_id`,`path`,`label`,`icon`,`id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/env/compare', 2]
[2025-09-18 11:16:16,581] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 10, 17, 56, 46, 317314, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 11, 16, 16, 581197, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '版本比较', '/env/compare', 'setting', 2, 5]
[2025-09-18 11:16:16,582] [DEBUG] SELECT `updated_time`,`created_time`,`parent_id`,`path`,`label`,`icon`,`id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/user', 2]
[2025-09-18 11:16:16,583] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 10, 17, 56, 46, 319315, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 11, 16, 16, 583108, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '用户管理', '/user', 'user', None, 6]
[2025-09-18 11:16:16,585] [DEBUG] SELECT `updated_time`,`created_time`,`parent_id`,`path`,`label`,`icon`,`id` FROM `menu`: []
[2025-09-18 11:16:16,586] [DEBUG] SELECT `updated_time`,`created_time`,`parent_id`,`path`,`label`,`icon`,`id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/user', 2]
[2025-09-18 11:16:16,587] [DEBUG] SELECT `desc`,`updated_time`,`created_time`,`name`,`id` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 11:16:16,588] [DEBUG] DELETE FROM `role_menu` WHERE `role_id`=%s: [1]
[2025-09-18 11:16:16,590] [DEBUG] SELECT `menu_id` FROM `role_menu` WHERE `role_id`=%s AND `menu_id` IN (%s,%s,%s,%s,%s,%s): [1, 1, 2, 3, 4, 5, 6]
[2025-09-18 11:16:16,591] [DEBUG] INSERT INTO `role_menu` (`menu_id`,`role_id`) VALUES (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s): [1, 1, 2, 1, 3, 1, 4, 1, 5, 1, 6, 1]
[2025-09-18 11:16:16,593] [DEBUG] SELECT `desc`,`updated_time`,`created_time`,`name`,`id` FROM `role` WHERE `name`=%s LIMIT %s: ['common', 2]
[2025-09-18 11:16:16,594] [DEBUG] DELETE FROM `role_menu` WHERE `role_id`=%s: [2]
[2025-09-18 11:16:16,595] [DEBUG] SELECT `menu_id` FROM `role_menu` WHERE `role_id`=%s AND `menu_id` IN (%s,%s,%s,%s,%s): [2, 1, 2, 3, 4, 5]
[2025-09-18 11:16:16,596] [DEBUG] INSERT INTO `role_menu` (`menu_id`,`role_id`) VALUES (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s): [1, 2, 2, 2, 3, 2, 4, 2, 5, 2]
[2025-09-18 11:16:16,598] [DEBUG] SELECT `desc`,`updated_time`,`created_time`,`name`,`id` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 11:16:16,599] [DEBUG] SELECT `updated_time`,`last_login_time`,`_password`,`created_time`,`role_id`,`username`,`is_active`,`is_delete`,`id` FROM `user` WHERE `username`=%s LIMIT %s: ['admin', 2]
[2025-09-18 11:16:16,601] [INFO] 超级管理员已存在
[2025-09-18 11:16:16,601] [INFO] Application startup complete.
[2025-09-18 11:16:19,885] [INFO] 127.0.0.1:10301 - "GET /api/user/get_menu HTTP/1.1" 401
[2025-09-18 11:16:24,140] [DEBUG] Calling on_field_start with no data
[2025-09-18 11:16:24,140] [DEBUG] Calling on_field_name with data[0:8]
[2025-09-18 11:16:24,140] [DEBUG] Calling on_field_data with data[9:18]
[2025-09-18 11:16:24,140] [DEBUG] Calling on_field_end with no data
[2025-09-18 11:16:24,140] [DEBUG] Calling on_field_start with no data
[2025-09-18 11:16:24,140] [DEBUG] Calling on_field_name with data[19:27]
[2025-09-18 11:16:24,140] [DEBUG] Calling on_field_data with data[28:36]
[2025-09-18 11:16:24,140] [DEBUG] Calling on_field_end with no data
[2025-09-18 11:16:24,140] [DEBUG] Calling on_end with no data
[2025-09-18 11:16:24,143] [DEBUG] SELECT `updated_time`,`last_login_time`,`_password`,`created_time`,`role_id`,`username`,`is_active`,`is_delete`,`id` FROM `user` WHERE `username`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 11:16:24,516] [DEBUG] UPDATE `user` SET `created_time`=%s,`updated_time`=%s,`username`=%s,`_password`=%s,`is_active`=%s,`is_delete`=%s,`last_login_time`=%s,`role_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 10, 17, 56, 46, 523247, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 11, 16, 24, 516700, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), 'superuser', '$2b$12$eFMO7BX7aMPlXwdeaZs/H.BLqpzyX26wQaM42fLMrG/GWgt3LJcRC', False, False, datetime.datetime(2025, 9, 18, 11, 16, 24, 515715), 1, 1]
[2025-09-18 11:16:24,531] [INFO] 127.0.0.1:10301 - "POST /api/login HTTP/1.1" 200
[2025-09-18 11:16:24,551] [INFO] 127.0.0.1:10301 - "OPTIONS /api/user/get_menu HTTP/1.1" 200
[2025-09-18 11:16:24,557] [DEBUG] SELECT `user`.`updated_time`,`user`.`last_login_time`,`user`.`_password`,`user`.`created_time`,`user`.`role_id`,`user`.`username`,`user`.`is_active`,`user`.`is_delete`,`user`.`id`,`user__role`.`desc` `user__role.desc`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`id` `user__role.id` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [1, 2]
[2025-09-18 11:16:24,559] [DEBUG] SELECT `desc`,`updated_time`,`created_time`,`name`,`id` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 11:16:24,560] [DEBUG] SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`menu`.`updated_time` `updated_time`,`menu`.`created_time` `created_time`,`menu`.`parent_id` `parent_id`,`menu`.`path` `path`,`menu`.`label` `label`,`menu`.`icon` `icon`,`menu`.`id` `id` FROM `menu` JOIN (SELECT `role_id` `_backward_relation_key`,`menu_id` `_forward_relation_key` FROM `role_menu` WHERE `role_id` IN (%s)) `sq0` ON `sq0`.`_forward_relation_key`=`menu`.`id`: [1]
[2025-09-18 11:16:24,564] [DEBUG] SELECT `menu`.`id` `id`,`menu`.`label` `label`,`menu`.`path` `path`,`menu`.`icon` `icon`,`menu`.`parent_id` `parent_id` FROM `menu` LEFT OUTER JOIN `role_menu` ON `menu`.`id`=`role_menu`.`menu_id` WHERE `role_menu`.`role_id`=%s: [1]
[2025-09-18 11:16:24,566] [INFO] 127.0.0.1:10301 - "GET /api/user/get_menu HTTP/1.1" 200
[2025-09-18 11:16:26,807] [INFO] 127.0.0.1:10301 - "OPTIONS /api/logout HTTP/1.1" 200
[2025-09-18 11:16:26,809] [INFO] 127.0.0.1:10301 - "POST /api/logout HTTP/1.1" 200
[2025-09-18 11:16:32,112] [DEBUG] Calling on_field_start with no data
[2025-09-18 11:16:32,112] [DEBUG] Calling on_field_name with data[0:8]
[2025-09-18 11:16:32,113] [DEBUG] Calling on_field_data with data[9:15]
[2025-09-18 11:16:32,113] [DEBUG] Calling on_field_end with no data
[2025-09-18 11:16:32,113] [DEBUG] Calling on_field_start with no data
[2025-09-18 11:16:32,113] [DEBUG] Calling on_field_name with data[16:24]
[2025-09-18 11:16:32,113] [DEBUG] Calling on_field_data with data[25:33]
[2025-09-18 11:16:32,113] [DEBUG] Calling on_field_end with no data
[2025-09-18 11:16:32,113] [DEBUG] Calling on_end with no data
[2025-09-18 11:16:32,114] [DEBUG] SELECT `updated_time`,`last_login_time`,`_password`,`created_time`,`role_id`,`username`,`is_active`,`is_delete`,`id` FROM `user` WHERE `username`=%s LIMIT %s: ['common', 2]
[2025-09-18 11:16:32,510] [DEBUG] UPDATE `user` SET `created_time`=%s,`updated_time`=%s,`username`=%s,`_password`=%s,`is_active`=%s,`is_delete`=%s,`last_login_time`=%s,`role_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 11, 15, 29, 0, 287124, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 11, 16, 32, 510844, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), 'common', '$2b$12$2iiv51Qm6jlaI3/jRpfRwO1o9pB.4c0rl0l1u2X30E9LsiHc2k14O', False, False, datetime.datetime(2025, 9, 18, 11, 16, 32, 510844), 2, 2]
[2025-09-18 11:16:32,515] [INFO] 127.0.0.1:22869 - "POST /api/login HTTP/1.1" 200
[2025-09-18 11:16:32,566] [DEBUG] SELECT `user`.`updated_time`,`user`.`last_login_time`,`user`.`_password`,`user`.`created_time`,`user`.`role_id`,`user`.`username`,`user`.`is_active`,`user`.`is_delete`,`user`.`id`,`user__role`.`desc` `user__role.desc`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`id` `user__role.id` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [2, 2]
[2025-09-18 11:16:32,568] [DEBUG] SELECT `desc`,`updated_time`,`created_time`,`name`,`id` FROM `role` WHERE `name`=%s LIMIT %s: ['common', 2]
[2025-09-18 11:16:32,569] [DEBUG] SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`menu`.`updated_time` `updated_time`,`menu`.`created_time` `created_time`,`menu`.`parent_id` `parent_id`,`menu`.`path` `path`,`menu`.`label` `label`,`menu`.`icon` `icon`,`menu`.`id` `id` FROM `menu` JOIN (SELECT `role_id` `_backward_relation_key`,`menu_id` `_forward_relation_key` FROM `role_menu` WHERE `role_id` IN (%s)) `sq0` ON `sq0`.`_forward_relation_key`=`menu`.`id`: [2]
[2025-09-18 11:16:32,571] [DEBUG] SELECT `menu`.`id` `id`,`menu`.`label` `label`,`menu`.`path` `path`,`menu`.`icon` `icon`,`menu`.`parent_id` `parent_id` FROM `menu` LEFT OUTER JOIN `role_menu` ON `menu`.`id`=`role_menu`.`menu_id` WHERE `role_menu`.`role_id`=%s: [2]
[2025-09-18 11:16:32,573] [INFO] 127.0.0.1:22869 - "GET /api/user/get_menu HTTP/1.1" 200
[2025-09-18 11:16:37,450] [DEBUG] SELECT `user`.`updated_time`,`user`.`last_login_time`,`user`.`_password`,`user`.`created_time`,`user`.`role_id`,`user`.`username`,`user`.`is_active`,`user`.`is_delete`,`user`.`id`,`user__role`.`desc` `user__role.desc`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`id` `user__role.id` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [2, 2]
[2025-09-18 11:16:37,453] [INFO] 127.0.0.1:22869 - "GET /api/env/getEnvData HTTP/1.1" 404
[2025-09-18 11:16:39,330] [INFO] 127.0.0.1:22869 - "POST /api/logout HTTP/1.1" 200
[2025-09-18 11:16:43,830] [DEBUG] Calling on_field_start with no data
[2025-09-18 11:16:43,830] [DEBUG] Calling on_field_name with data[0:8]
[2025-09-18 11:16:43,830] [DEBUG] Calling on_field_data with data[9:18]
[2025-09-18 11:16:43,830] [DEBUG] Calling on_field_end with no data
[2025-09-18 11:16:43,830] [DEBUG] Calling on_field_start with no data
[2025-09-18 11:16:43,831] [DEBUG] Calling on_field_name with data[19:27]
[2025-09-18 11:16:43,831] [DEBUG] Calling on_field_data with data[28:36]
[2025-09-18 11:16:43,831] [DEBUG] Calling on_field_end with no data
[2025-09-18 11:16:43,831] [DEBUG] Calling on_end with no data
[2025-09-18 11:16:43,831] [DEBUG] SELECT `updated_time`,`last_login_time`,`_password`,`created_time`,`role_id`,`username`,`is_active`,`is_delete`,`id` FROM `user` WHERE `username`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 11:16:44,168] [DEBUG] UPDATE `user` SET `created_time`=%s,`updated_time`=%s,`username`=%s,`_password`=%s,`is_active`=%s,`is_delete`=%s,`last_login_time`=%s,`role_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 10, 17, 56, 46, 523247, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 11, 16, 44, 168664, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), 'superuser', '$2b$12$eFMO7BX7aMPlXwdeaZs/H.BLqpzyX26wQaM42fLMrG/GWgt3LJcRC', False, False, datetime.datetime(2025, 9, 18, 11, 16, 44, 168664), 1, 1]
[2025-09-18 11:16:44,173] [INFO] 127.0.0.1:22869 - "POST /api/login HTTP/1.1" 200
[2025-09-18 11:16:44,191] [DEBUG] SELECT `user`.`updated_time`,`user`.`last_login_time`,`user`.`_password`,`user`.`created_time`,`user`.`role_id`,`user`.`username`,`user`.`is_active`,`user`.`is_delete`,`user`.`id`,`user__role`.`desc` `user__role.desc`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`id` `user__role.id` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [1, 2]
[2025-09-18 11:16:44,193] [DEBUG] SELECT `desc`,`updated_time`,`created_time`,`name`,`id` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 11:16:44,195] [DEBUG] SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`menu`.`updated_time` `updated_time`,`menu`.`created_time` `created_time`,`menu`.`parent_id` `parent_id`,`menu`.`path` `path`,`menu`.`label` `label`,`menu`.`icon` `icon`,`menu`.`id` `id` FROM `menu` JOIN (SELECT `role_id` `_backward_relation_key`,`menu_id` `_forward_relation_key` FROM `role_menu` WHERE `role_id` IN (%s)) `sq0` ON `sq0`.`_forward_relation_key`=`menu`.`id`: [1]
[2025-09-18 11:16:44,197] [DEBUG] SELECT `menu`.`id` `id`,`menu`.`label` `label`,`menu`.`path` `path`,`menu`.`icon` `icon`,`menu`.`parent_id` `parent_id` FROM `menu` LEFT OUTER JOIN `role_menu` ON `menu`.`id`=`role_menu`.`menu_id` WHERE `role_menu`.`role_id`=%s: [1]
[2025-09-18 11:16:44,200] [INFO] 127.0.0.1:22869 - "GET /api/user/get_menu HTTP/1.1" 200
[2025-09-18 11:16:47,060] [DEBUG] SELECT `user`.`updated_time`,`user`.`last_login_time`,`user`.`_password`,`user`.`created_time`,`user`.`role_id`,`user`.`username`,`user`.`is_active`,`user`.`is_delete`,`user`.`id`,`user__role`.`desc` `user__role.desc`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`id` `user__role.id` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [1, 2]
[2025-09-18 11:16:47,063] [INFO] 127.0.0.1:22869 - "GET /api/env/getEnvData HTTP/1.1" 404
[2025-09-18 11:16:55,628] [INFO] 127.0.0.1:53970 - "POST /api/logout HTTP/1.1" 200
[2025-09-18 11:17:01,635] [DEBUG] Calling on_field_start with no data
[2025-09-18 11:17:01,635] [DEBUG] Calling on_field_name with data[0:8]
[2025-09-18 11:17:01,635] [DEBUG] Calling on_field_data with data[9:18]
[2025-09-18 11:17:01,635] [DEBUG] Calling on_field_end with no data
[2025-09-18 11:17:01,635] [DEBUG] Calling on_field_start with no data
[2025-09-18 11:17:01,635] [DEBUG] Calling on_field_name with data[19:27]
[2025-09-18 11:17:01,635] [DEBUG] Calling on_field_data with data[28:36]
[2025-09-18 11:17:01,636] [DEBUG] Calling on_field_end with no data
[2025-09-18 11:17:01,636] [DEBUG] Calling on_end with no data
[2025-09-18 11:17:01,637] [DEBUG] SELECT `updated_time`,`last_login_time`,`_password`,`created_time`,`role_id`,`username`,`is_active`,`is_delete`,`id` FROM `user` WHERE `username`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 11:17:01,998] [DEBUG] UPDATE `user` SET `created_time`=%s,`updated_time`=%s,`username`=%s,`_password`=%s,`is_active`=%s,`is_delete`=%s,`last_login_time`=%s,`role_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 10, 17, 56, 46, 523247, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 11, 17, 1, 998405, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), 'superuser', '$2b$12$eFMO7BX7aMPlXwdeaZs/H.BLqpzyX26wQaM42fLMrG/GWgt3LJcRC', False, False, datetime.datetime(2025, 9, 18, 11, 17, 1, 998405), 1, 1]
[2025-09-18 11:17:02,002] [INFO] 127.0.0.1:47577 - "POST /api/login HTTP/1.1" 200
[2025-09-18 11:17:02,026] [DEBUG] SELECT `user`.`updated_time`,`user`.`last_login_time`,`user`.`_password`,`user`.`created_time`,`user`.`role_id`,`user`.`username`,`user`.`is_active`,`user`.`is_delete`,`user`.`id`,`user__role`.`desc` `user__role.desc`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`id` `user__role.id` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [1, 2]
[2025-09-18 11:17:02,029] [DEBUG] SELECT `desc`,`updated_time`,`created_time`,`name`,`id` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 11:17:02,030] [DEBUG] SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`menu`.`updated_time` `updated_time`,`menu`.`created_time` `created_time`,`menu`.`parent_id` `parent_id`,`menu`.`path` `path`,`menu`.`label` `label`,`menu`.`icon` `icon`,`menu`.`id` `id` FROM `menu` JOIN (SELECT `role_id` `_backward_relation_key`,`menu_id` `_forward_relation_key` FROM `role_menu` WHERE `role_id` IN (%s)) `sq0` ON `sq0`.`_forward_relation_key`=`menu`.`id`: [1]
[2025-09-18 11:17:02,034] [DEBUG] SELECT `menu`.`id` `id`,`menu`.`label` `label`,`menu`.`path` `path`,`menu`.`icon` `icon`,`menu`.`parent_id` `parent_id` FROM `menu` LEFT OUTER JOIN `role_menu` ON `menu`.`id`=`role_menu`.`menu_id` WHERE `role_menu`.`role_id`=%s: [1]
[2025-09-18 11:17:02,035] [INFO] 127.0.0.1:47577 - "GET /api/user/get_menu HTTP/1.1" 200
[2025-09-18 11:17:03,342] [INFO] 127.0.0.1:47577 - "OPTIONS /api/user/info?page=1&size=10&username= HTTP/1.1" 200
[2025-09-18 11:17:03,345] [DEBUG] SELECT `user`.`updated_time`,`user`.`last_login_time`,`user`.`_password`,`user`.`created_time`,`user`.`role_id`,`user`.`username`,`user`.`is_active`,`user`.`is_delete`,`user`.`id`,`user__role`.`desc` `user__role.desc`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`id` `user__role.id` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [1, 2]
[2025-09-18 11:17:03,347] [DEBUG] SELECT COUNT(*) FROM `user` WHERE `is_delete`=%s: [False]
[2025-09-18 11:17:03,349] [DEBUG] SELECT `updated_time`,`last_login_time`,`_password`,`created_time`,`role_id`,`username`,`is_active`,`is_delete`,`id` FROM `user` WHERE `is_delete`=%s ORDER BY `id` DESC LIMIT %s OFFSET %s: [False, 10, 0]
[2025-09-18 11:17:03,351] [DEBUG] SELECT `desc`,`updated_time`,`created_time`,`name`,`id` FROM `role` WHERE `id` IN (%s,%s): [2, 1]
[2025-09-18 11:17:03,354] [INFO] 127.0.0.1:47577 - "GET /api/user/info?page=1&size=10&username= HTTP/1.1" 200
[2025-09-18 11:17:05,604] [INFO] 127.0.0.1:47577 - "POST /api/logout HTTP/1.1" 200
[2025-09-18 11:17:09,228] [DEBUG] Calling on_field_start with no data
[2025-09-18 11:17:09,228] [DEBUG] Calling on_field_name with data[0:8]
[2025-09-18 11:17:09,228] [DEBUG] Calling on_field_data with data[9:17]
[2025-09-18 11:17:09,228] [DEBUG] Calling on_field_end with no data
[2025-09-18 11:17:09,228] [DEBUG] Calling on_field_start with no data
[2025-09-18 11:17:09,228] [DEBUG] Calling on_field_name with data[18:26]
[2025-09-18 11:17:09,228] [DEBUG] Calling on_field_data with data[27:35]
[2025-09-18 11:17:09,229] [DEBUG] Calling on_field_end with no data
[2025-09-18 11:17:09,229] [DEBUG] Calling on_end with no data
[2025-09-18 11:17:09,229] [DEBUG] SELECT `updated_time`,`last_login_time`,`_password`,`created_time`,`role_id`,`username`,`is_active`,`is_delete`,`id` FROM `user` WHERE `username`=%s LIMIT %s: ['yaoshuai', 2]
[2025-09-18 11:17:09,231] [INFO] 127.0.0.1:47577 - "POST /api/login HTTP/1.1" 200
[2025-09-18 11:17:21,110] [DEBUG] Calling on_field_start with no data
[2025-09-18 11:17:21,111] [DEBUG] Calling on_field_name with data[0:8]
[2025-09-18 11:17:21,111] [DEBUG] Calling on_field_data with data[9:15]
[2025-09-18 11:17:21,111] [DEBUG] Calling on_field_end with no data
[2025-09-18 11:17:21,111] [DEBUG] Calling on_field_start with no data
[2025-09-18 11:17:21,111] [DEBUG] Calling on_field_name with data[16:24]
[2025-09-18 11:17:21,111] [DEBUG] Calling on_field_data with data[25:33]
[2025-09-18 11:17:21,111] [DEBUG] Calling on_field_end with no data
[2025-09-18 11:17:21,111] [DEBUG] Calling on_end with no data
[2025-09-18 11:17:21,112] [DEBUG] SELECT `updated_time`,`last_login_time`,`_password`,`created_time`,`role_id`,`username`,`is_active`,`is_delete`,`id` FROM `user` WHERE `username`=%s LIMIT %s: ['common', 2]
[2025-09-18 11:17:21,480] [DEBUG] UPDATE `user` SET `created_time`=%s,`updated_time`=%s,`username`=%s,`_password`=%s,`is_active`=%s,`is_delete`=%s,`last_login_time`=%s,`role_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 11, 15, 29, 0, 287124, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 11, 17, 21, 480803, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), 'common', '$2b$12$2iiv51Qm6jlaI3/jRpfRwO1o9pB.4c0rl0l1u2X30E9LsiHc2k14O', False, False, datetime.datetime(2025, 9, 18, 11, 17, 21, 480803), 2, 2]
[2025-09-18 11:17:21,485] [INFO] 127.0.0.1:9020 - "POST /api/login HTTP/1.1" 200
[2025-09-18 11:17:21,504] [DEBUG] SELECT `user`.`updated_time`,`user`.`last_login_time`,`user`.`_password`,`user`.`created_time`,`user`.`role_id`,`user`.`username`,`user`.`is_active`,`user`.`is_delete`,`user`.`id`,`user__role`.`desc` `user__role.desc`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`id` `user__role.id` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [2, 2]
[2025-09-18 11:17:21,506] [DEBUG] SELECT `desc`,`updated_time`,`created_time`,`name`,`id` FROM `role` WHERE `name`=%s LIMIT %s: ['common', 2]
[2025-09-18 11:17:21,508] [DEBUG] SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`menu`.`updated_time` `updated_time`,`menu`.`created_time` `created_time`,`menu`.`parent_id` `parent_id`,`menu`.`path` `path`,`menu`.`label` `label`,`menu`.`icon` `icon`,`menu`.`id` `id` FROM `menu` JOIN (SELECT `role_id` `_backward_relation_key`,`menu_id` `_forward_relation_key` FROM `role_menu` WHERE `role_id` IN (%s)) `sq0` ON `sq0`.`_forward_relation_key`=`menu`.`id`: [2]
[2025-09-18 11:17:21,510] [DEBUG] SELECT `menu`.`id` `id`,`menu`.`label` `label`,`menu`.`path` `path`,`menu`.`icon` `icon`,`menu`.`parent_id` `parent_id` FROM `menu` LEFT OUTER JOIN `role_menu` ON `menu`.`id`=`role_menu`.`menu_id` WHERE `role_menu`.`role_id`=%s: [2]
[2025-09-18 11:17:21,512] [INFO] 127.0.0.1:9020 - "GET /api/user/get_menu HTTP/1.1" 200
[2025-09-18 11:17:23,347] [DEBUG] SELECT `user`.`updated_time`,`user`.`last_login_time`,`user`.`_password`,`user`.`created_time`,`user`.`role_id`,`user`.`username`,`user`.`is_active`,`user`.`is_delete`,`user`.`id`,`user__role`.`desc` `user__role.desc`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`id` `user__role.id` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [2, 2]
[2025-09-18 11:17:23,349] [DEBUG] SELECT COUNT(*) FROM `user` WHERE `is_delete`=%s: [False]
[2025-09-18 11:17:23,349] [DEBUG] SELECT `updated_time`,`last_login_time`,`_password`,`created_time`,`role_id`,`username`,`is_active`,`is_delete`,`id` FROM `user` WHERE `is_delete`=%s ORDER BY `id` DESC LIMIT %s OFFSET %s: [False, 10, 0]
[2025-09-18 11:17:23,351] [DEBUG] SELECT `desc`,`updated_time`,`created_time`,`name`,`id` FROM `role` WHERE `id` IN (%s,%s): [2, 1]
[2025-09-18 11:17:23,354] [INFO] 127.0.0.1:9020 - "GET /api/user/info?page=1&size=10&username= HTTP/1.1" 200
[2025-09-18 11:17:26,328] [DEBUG] SELECT `user`.`updated_time`,`user`.`last_login_time`,`user`.`_password`,`user`.`created_time`,`user`.`role_id`,`user`.`username`,`user`.`is_active`,`user`.`is_delete`,`user`.`id`,`user__role`.`desc` `user__role.desc`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`id` `user__role.id` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [2, 2]
[2025-09-18 11:17:26,330] [INFO] 127.0.0.1:9020 - "GET /api/env/getEnvData HTTP/1.1" 404
[2025-09-18 11:23:05,091] [INFO] 127.0.0.1:49353 - "POST /api/logout HTTP/1.1" 200
[2025-09-18 11:23:11,961] [INFO] 127.0.0.1:5261 - "GET /api/user/get_menu HTTP/1.1" 401
[2025-09-18 11:23:18,289] [DEBUG] Calling on_field_start with no data
[2025-09-18 11:23:18,290] [DEBUG] Calling on_field_name with data[0:8]
[2025-09-18 11:23:18,290] [DEBUG] Calling on_field_data with data[9:18]
[2025-09-18 11:23:18,290] [DEBUG] Calling on_field_end with no data
[2025-09-18 11:23:18,290] [DEBUG] Calling on_field_start with no data
[2025-09-18 11:23:18,290] [DEBUG] Calling on_field_name with data[19:27]
[2025-09-18 11:23:18,290] [DEBUG] Calling on_field_data with data[28:36]
[2025-09-18 11:23:18,290] [DEBUG] Calling on_field_end with no data
[2025-09-18 11:23:18,290] [DEBUG] Calling on_end with no data
[2025-09-18 11:23:18,291] [DEBUG] SELECT `updated_time`,`last_login_time`,`_password`,`created_time`,`role_id`,`username`,`is_active`,`is_delete`,`id` FROM `user` WHERE `username`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 11:23:18,476] [DEBUG] UPDATE `user` SET `created_time`=%s,`updated_time`=%s,`username`=%s,`_password`=%s,`is_active`=%s,`is_delete`=%s,`last_login_time`=%s,`role_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 10, 17, 56, 46, 523247, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 11, 23, 18, 476412, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), 'superuser', '$2b$12$eFMO7BX7aMPlXwdeaZs/H.BLqpzyX26wQaM42fLMrG/GWgt3LJcRC', False, False, datetime.datetime(2025, 9, 18, 11, 23, 18, 476412), 1, 1]
[2025-09-18 11:23:18,480] [INFO] 127.0.0.1:2150 - "POST /api/login HTTP/1.1" 200
[2025-09-18 11:23:18,497] [DEBUG] SELECT `user`.`updated_time`,`user`.`last_login_time`,`user`.`_password`,`user`.`created_time`,`user`.`role_id`,`user`.`username`,`user`.`is_active`,`user`.`is_delete`,`user`.`id`,`user__role`.`desc` `user__role.desc`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`id` `user__role.id` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [1, 2]
[2025-09-18 11:23:18,500] [DEBUG] SELECT `desc`,`updated_time`,`created_time`,`name`,`id` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 11:23:18,501] [DEBUG] SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`menu`.`updated_time` `updated_time`,`menu`.`created_time` `created_time`,`menu`.`parent_id` `parent_id`,`menu`.`path` `path`,`menu`.`label` `label`,`menu`.`icon` `icon`,`menu`.`id` `id` FROM `menu` JOIN (SELECT `role_id` `_backward_relation_key`,`menu_id` `_forward_relation_key` FROM `role_menu` WHERE `role_id` IN (%s)) `sq0` ON `sq0`.`_forward_relation_key`=`menu`.`id`: [1]
[2025-09-18 11:23:18,503] [DEBUG] SELECT `menu`.`id` `id`,`menu`.`label` `label`,`menu`.`path` `path`,`menu`.`icon` `icon`,`menu`.`parent_id` `parent_id` FROM `menu` LEFT OUTER JOIN `role_menu` ON `menu`.`id`=`role_menu`.`menu_id` WHERE `role_menu`.`role_id`=%s: [1]
[2025-09-18 11:23:18,504] [INFO] 127.0.0.1:2150 - "GET /api/user/get_menu HTTP/1.1" 200
[2025-09-18 11:23:19,764] [DEBUG] SELECT `user`.`updated_time`,`user`.`last_login_time`,`user`.`_password`,`user`.`created_time`,`user`.`role_id`,`user`.`username`,`user`.`is_active`,`user`.`is_delete`,`user`.`id`,`user__role`.`desc` `user__role.desc`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`id` `user__role.id` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [1, 2]
[2025-09-18 11:23:19,765] [DEBUG] SELECT COUNT(*) FROM `user` WHERE `is_delete`=%s: [False]
[2025-09-18 11:23:19,766] [DEBUG] SELECT `updated_time`,`last_login_time`,`_password`,`created_time`,`role_id`,`username`,`is_active`,`is_delete`,`id` FROM `user` WHERE `is_delete`=%s ORDER BY `id` DESC LIMIT %s OFFSET %s: [False, 10, 0]
[2025-09-18 11:23:19,767] [DEBUG] SELECT `desc`,`updated_time`,`created_time`,`name`,`id` FROM `role` WHERE `id` IN (%s,%s): [2, 1]
[2025-09-18 11:23:19,769] [INFO] 127.0.0.1:2150 - "GET /api/user/info?page=1&size=10&username= HTTP/1.1" 200
[2025-09-18 11:23:25,476] [DEBUG] SELECT `user`.`updated_time`,`user`.`last_login_time`,`user`.`_password`,`user`.`created_time`,`user`.`role_id`,`user`.`username`,`user`.`is_active`,`user`.`is_delete`,`user`.`id`,`user__role`.`desc` `user__role.desc`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`id` `user__role.id` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [1, 2]
[2025-09-18 11:23:25,482] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 11:23:25,484] [DEBUG] SELECT `user`.`updated_time`,`user`.`last_login_time`,`user`.`_password`,`user`.`created_time`,`user`.`role_id`,`user`.`username`,`user`.`is_active`,`user`.`is_delete`,`user`.`id`,`user__role`.`desc` `user__role.desc`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`id` `user__role.id` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [1, 2]
[2025-09-18 11:23:25,485] [DEBUG] SELECT `desc`,`updated_time`,`created_time`,`name`,`id` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 11:23:25,486] [DEBUG] SELECT COUNT(*) FROM `user` WHERE `is_delete`=%s: [False]
[2025-09-18 11:23:25,487] [DEBUG] SELECT `updated_time`,`last_login_time`,`_password`,`created_time`,`role_id`,`username`,`is_active`,`is_delete`,`id` FROM `user` WHERE `is_delete`=%s ORDER BY `id` DESC LIMIT %s OFFSET %s: [False, 10, 0]
[2025-09-18 11:23:25,489] [DEBUG] SELECT `desc`,`updated_time`,`created_time`,`name`,`id` FROM `role` WHERE `id` IN (%s,%s): [2, 1]
[2025-09-18 11:23:25,489] [DEBUG] SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`menu`.`updated_time` `updated_time`,`menu`.`created_time` `created_time`,`menu`.`parent_id` `parent_id`,`menu`.`path` `path`,`menu`.`label` `label`,`menu`.`icon` `icon`,`menu`.`id` `id` FROM `menu` JOIN (SELECT `role_id` `_backward_relation_key`,`menu_id` `_forward_relation_key` FROM `role_menu` WHERE `role_id` IN (%s)) `sq0` ON `sq0`.`_forward_relation_key`=`menu`.`id`: [1]
[2025-09-18 11:23:25,490] [INFO] 127.0.0.1:8779 - "GET /api/user/info?page=1&size=10&username= HTTP/1.1" 200
[2025-09-18 11:23:25,492] [DEBUG] SELECT `menu`.`id` `id`,`menu`.`label` `label`,`menu`.`path` `path`,`menu`.`icon` `icon`,`menu`.`parent_id` `parent_id` FROM `menu` LEFT OUTER JOIN `role_menu` ON `menu`.`id`=`role_menu`.`menu_id` WHERE `role_menu`.`role_id`=%s: [1]
[2025-09-18 11:23:25,494] [INFO] 127.0.0.1:27635 - "GET /api/user/get_menu HTTP/1.1" 200
[2025-09-18 11:23:25,591] [DEBUG] SELECT `user`.`updated_time`,`user`.`last_login_time`,`user`.`_password`,`user`.`created_time`,`user`.`role_id`,`user`.`username`,`user`.`is_active`,`user`.`is_delete`,`user`.`id`,`user__role`.`desc` `user__role.desc`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`id` `user__role.id` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [1, 2]
[2025-09-18 11:23:25,593] [DEBUG] SELECT `user`.`updated_time`,`user`.`last_login_time`,`user`.`_password`,`user`.`created_time`,`user`.`role_id`,`user`.`username`,`user`.`is_active`,`user`.`is_delete`,`user`.`id`,`user__role`.`desc` `user__role.desc`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`id` `user__role.id` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [1, 2]
[2025-09-18 11:23:25,594] [DEBUG] SELECT `desc`,`updated_time`,`created_time`,`name`,`id` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 11:23:25,594] [DEBUG] SELECT COUNT(*) FROM `user` WHERE `is_delete`=%s: [False]
[2025-09-18 11:23:25,596] [DEBUG] SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`menu`.`updated_time` `updated_time`,`menu`.`created_time` `created_time`,`menu`.`parent_id` `parent_id`,`menu`.`path` `path`,`menu`.`label` `label`,`menu`.`icon` `icon`,`menu`.`id` `id` FROM `menu` JOIN (SELECT `role_id` `_backward_relation_key`,`menu_id` `_forward_relation_key` FROM `role_menu` WHERE `role_id` IN (%s)) `sq0` ON `sq0`.`_forward_relation_key`=`menu`.`id`: [1]
[2025-09-18 11:23:25,596] [DEBUG] SELECT `updated_time`,`last_login_time`,`_password`,`created_time`,`role_id`,`username`,`is_active`,`is_delete`,`id` FROM `user` WHERE `is_delete`=%s ORDER BY `id` DESC LIMIT %s OFFSET %s: [False, 10, 0]
[2025-09-18 11:23:25,597] [DEBUG] SELECT `menu`.`id` `id`,`menu`.`label` `label`,`menu`.`path` `path`,`menu`.`icon` `icon`,`menu`.`parent_id` `parent_id` FROM `menu` LEFT OUTER JOIN `role_menu` ON `menu`.`id`=`role_menu`.`menu_id` WHERE `role_menu`.`role_id`=%s: [1]
[2025-09-18 11:23:25,598] [DEBUG] SELECT `desc`,`updated_time`,`created_time`,`name`,`id` FROM `role` WHERE `id` IN (%s,%s): [2, 1]
[2025-09-18 11:23:25,599] [INFO] 127.0.0.1:27635 - "GET /api/user/get_menu HTTP/1.1" 200
[2025-09-18 11:23:25,600] [INFO] 127.0.0.1:8779 - "GET /api/user/info?page=1&size=10&username= HTTP/1.1" 200
[2025-09-18 11:24:16,352] [INFO] 127.0.0.1:14504 - "POST /api/logout HTTP/1.1" 200
[2025-09-18 11:29:57,767] [INFO] 127.0.0.1:32880 - "OPTIONS /api/user/info?page=1&size=10&username= HTTP/1.1" 200
[2025-09-18 11:29:57,768] [INFO] 127.0.0.1:47736 - "GET /api/user/get_menu HTTP/1.1" 401
[2025-09-18 11:29:57,771] [INFO] 127.0.0.1:47736 - "GET /api/user/info?page=1&size=10&username= HTTP/1.1" 401
[2025-09-18 11:30:06,203] [DEBUG] Calling on_field_start with no data
[2025-09-18 11:30:06,204] [DEBUG] Calling on_field_name with data[0:8]
[2025-09-18 11:30:06,204] [DEBUG] Calling on_field_data with data[9:18]
[2025-09-18 11:30:06,204] [DEBUG] Calling on_field_end with no data
[2025-09-18 11:30:06,204] [DEBUG] Calling on_field_start with no data
[2025-09-18 11:30:06,204] [DEBUG] Calling on_field_name with data[19:27]
[2025-09-18 11:30:06,204] [DEBUG] Calling on_field_data with data[28:36]
[2025-09-18 11:30:06,204] [DEBUG] Calling on_field_end with no data
[2025-09-18 11:30:06,204] [DEBUG] Calling on_end with no data
[2025-09-18 11:30:06,205] [DEBUG] SELECT `updated_time`,`last_login_time`,`_password`,`created_time`,`role_id`,`username`,`is_active`,`is_delete`,`id` FROM `user` WHERE `username`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 11:30:06,391] [DEBUG] UPDATE `user` SET `created_time`=%s,`updated_time`=%s,`username`=%s,`_password`=%s,`is_active`=%s,`is_delete`=%s,`last_login_time`=%s,`role_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 10, 17, 56, 46, 523247, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 11, 30, 6, 391262, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), 'superuser', '$2b$12$eFMO7BX7aMPlXwdeaZs/H.BLqpzyX26wQaM42fLMrG/GWgt3LJcRC', False, False, datetime.datetime(2025, 9, 18, 11, 30, 6, 391262), 1, 1]
[2025-09-18 11:30:06,396] [INFO] 127.0.0.1:2217 - "POST /api/login HTTP/1.1" 200
[2025-09-18 11:30:06,421] [INFO] 127.0.0.1:2217 - "OPTIONS /api/user/get_menu HTTP/1.1" 200
[2025-09-18 11:30:06,425] [DEBUG] SELECT `user`.`updated_time`,`user`.`last_login_time`,`user`.`_password`,`user`.`created_time`,`user`.`role_id`,`user`.`username`,`user`.`is_active`,`user`.`is_delete`,`user`.`id`,`user__role`.`desc` `user__role.desc`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`id` `user__role.id` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [1, 2]
[2025-09-18 11:30:06,426] [DEBUG] SELECT `desc`,`updated_time`,`created_time`,`name`,`id` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 11:30:06,427] [DEBUG] SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`menu`.`updated_time` `updated_time`,`menu`.`created_time` `created_time`,`menu`.`parent_id` `parent_id`,`menu`.`path` `path`,`menu`.`label` `label`,`menu`.`icon` `icon`,`menu`.`id` `id` FROM `menu` JOIN (SELECT `role_id` `_backward_relation_key`,`menu_id` `_forward_relation_key` FROM `role_menu` WHERE `role_id` IN (%s)) `sq0` ON `sq0`.`_forward_relation_key`=`menu`.`id`: [1]
[2025-09-18 11:30:06,429] [DEBUG] SELECT `menu`.`id` `id`,`menu`.`label` `label`,`menu`.`path` `path`,`menu`.`icon` `icon`,`menu`.`parent_id` `parent_id` FROM `menu` LEFT OUTER JOIN `role_menu` ON `menu`.`id`=`role_menu`.`menu_id` WHERE `role_menu`.`role_id`=%s: [1]
[2025-09-18 11:30:06,430] [INFO] 127.0.0.1:2217 - "GET /api/user/get_menu HTTP/1.1" 200
[2025-09-18 11:30:08,625] [INFO] 127.0.0.1:2217 - "OPTIONS /api/user/info?page=1&size=10&username= HTTP/1.1" 200
[2025-09-18 11:30:08,629] [DEBUG] SELECT `user`.`updated_time`,`user`.`last_login_time`,`user`.`_password`,`user`.`created_time`,`user`.`role_id`,`user`.`username`,`user`.`is_active`,`user`.`is_delete`,`user`.`id`,`user__role`.`desc` `user__role.desc`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`id` `user__role.id` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [1, 2]
[2025-09-18 11:30:08,631] [DEBUG] SELECT COUNT(*) FROM `user` WHERE `is_delete`=%s: [False]
[2025-09-18 11:30:08,632] [DEBUG] SELECT `updated_time`,`last_login_time`,`_password`,`created_time`,`role_id`,`username`,`is_active`,`is_delete`,`id` FROM `user` WHERE `is_delete`=%s ORDER BY `id` DESC LIMIT %s OFFSET %s: [False, 10, 0]
[2025-09-18 11:30:08,634] [DEBUG] SELECT `desc`,`updated_time`,`created_time`,`name`,`id` FROM `role` WHERE `id` IN (%s,%s): [2, 1]
[2025-09-18 11:30:08,636] [INFO] 127.0.0.1:2217 - "GET /api/user/info?page=1&size=10&username= HTTP/1.1" 200
[2025-09-18 11:30:10,938] [INFO] 127.0.0.1:2217 - "OPTIONS /api/logout HTTP/1.1" 200
[2025-09-18 11:30:10,940] [INFO] 127.0.0.1:2217 - "POST /api/logout HTTP/1.1" 200
[2025-09-18 11:31:58,828] [INFO] 127.0.0.1:54707 - "GET /api/user/get_menu HTTP/1.1" 401
[2025-09-18 11:31:58,830] [INFO] 127.0.0.1:54707 - "GET /api/user/get_menu HTTP/1.1" 401
[2025-09-18 11:31:58,946] [INFO] 127.0.0.1:54707 - "GET /api/user/get_menu HTTP/1.1" 401
[2025-09-18 11:33:28,290] [DEBUG] Calling on_field_start with no data
[2025-09-18 11:33:28,290] [DEBUG] Calling on_field_name with data[0:8]
[2025-09-18 11:33:28,290] [DEBUG] Calling on_field_data with data[9:18]
[2025-09-18 11:33:28,290] [DEBUG] Calling on_field_end with no data
[2025-09-18 11:33:28,290] [DEBUG] Calling on_field_start with no data
[2025-09-18 11:33:28,290] [DEBUG] Calling on_field_name with data[19:27]
[2025-09-18 11:33:28,290] [DEBUG] Calling on_field_data with data[28:36]
[2025-09-18 11:33:28,290] [DEBUG] Calling on_field_end with no data
[2025-09-18 11:33:28,290] [DEBUG] Calling on_end with no data
[2025-09-18 11:33:28,291] [DEBUG] SELECT `updated_time`,`last_login_time`,`_password`,`created_time`,`role_id`,`username`,`is_active`,`is_delete`,`id` FROM `user` WHERE `username`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 11:33:28,478] [DEBUG] UPDATE `user` SET `created_time`=%s,`updated_time`=%s,`username`=%s,`_password`=%s,`is_active`=%s,`is_delete`=%s,`last_login_time`=%s,`role_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 10, 17, 56, 46, 523247, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 11, 33, 28, 478096, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), 'superuser', '$2b$12$eFMO7BX7aMPlXwdeaZs/H.BLqpzyX26wQaM42fLMrG/GWgt3LJcRC', False, False, datetime.datetime(2025, 9, 18, 11, 33, 28, 478096), 1, 1]
[2025-09-18 11:33:28,483] [INFO] 127.0.0.1:30033 - "POST /api/login HTTP/1.1" 200
[2025-09-18 11:33:28,504] [DEBUG] SELECT `user`.`updated_time`,`user`.`last_login_time`,`user`.`_password`,`user`.`created_time`,`user`.`role_id`,`user`.`username`,`user`.`is_active`,`user`.`is_delete`,`user`.`id`,`user__role`.`desc` `user__role.desc`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`id` `user__role.id` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [1, 2]
[2025-09-18 11:33:28,506] [DEBUG] SELECT `desc`,`updated_time`,`created_time`,`name`,`id` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 11:33:28,508] [DEBUG] SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`menu`.`updated_time` `updated_time`,`menu`.`created_time` `created_time`,`menu`.`parent_id` `parent_id`,`menu`.`path` `path`,`menu`.`label` `label`,`menu`.`icon` `icon`,`menu`.`id` `id` FROM `menu` JOIN (SELECT `role_id` `_backward_relation_key`,`menu_id` `_forward_relation_key` FROM `role_menu` WHERE `role_id` IN (%s)) `sq0` ON `sq0`.`_forward_relation_key`=`menu`.`id`: [1]
[2025-09-18 11:33:28,510] [DEBUG] SELECT `menu`.`id` `id`,`menu`.`label` `label`,`menu`.`path` `path`,`menu`.`icon` `icon`,`menu`.`parent_id` `parent_id` FROM `menu` LEFT OUTER JOIN `role_menu` ON `menu`.`id`=`role_menu`.`menu_id` WHERE `role_menu`.`role_id`=%s: [1]
[2025-09-18 11:33:28,512] [INFO] 127.0.0.1:30033 - "GET /api/user/get_menu HTTP/1.1" 200
[2025-09-18 11:33:32,998] [DEBUG] SELECT `user`.`updated_time`,`user`.`last_login_time`,`user`.`_password`,`user`.`created_time`,`user`.`role_id`,`user`.`username`,`user`.`is_active`,`user`.`is_delete`,`user`.`id`,`user__role`.`desc` `user__role.desc`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`id` `user__role.id` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [1, 2]
[2025-09-18 11:33:33,000] [DEBUG] SELECT `desc`,`updated_time`,`created_time`,`name`,`id` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 11:33:33,002] [DEBUG] SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`menu`.`updated_time` `updated_time`,`menu`.`created_time` `created_time`,`menu`.`parent_id` `parent_id`,`menu`.`path` `path`,`menu`.`label` `label`,`menu`.`icon` `icon`,`menu`.`id` `id` FROM `menu` JOIN (SELECT `role_id` `_backward_relation_key`,`menu_id` `_forward_relation_key` FROM `role_menu` WHERE `role_id` IN (%s)) `sq0` ON `sq0`.`_forward_relation_key`=`menu`.`id`: [1]
[2025-09-18 11:33:33,004] [DEBUG] SELECT `menu`.`id` `id`,`menu`.`label` `label`,`menu`.`path` `path`,`menu`.`icon` `icon`,`menu`.`parent_id` `parent_id` FROM `menu` LEFT OUTER JOIN `role_menu` ON `menu`.`id`=`role_menu`.`menu_id` WHERE `role_menu`.`role_id`=%s: [1]
[2025-09-18 11:33:33,005] [INFO] 127.0.0.1:30033 - "GET /api/user/get_menu HTTP/1.1" 200
[2025-09-18 11:33:35,086] [DEBUG] SELECT `user`.`updated_time`,`user`.`last_login_time`,`user`.`_password`,`user`.`created_time`,`user`.`role_id`,`user`.`username`,`user`.`is_active`,`user`.`is_delete`,`user`.`id`,`user__role`.`desc` `user__role.desc`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`id` `user__role.id` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [1, 2]
[2025-09-18 11:33:35,088] [DEBUG] SELECT COUNT(*) FROM `user` WHERE `is_delete`=%s: [False]
[2025-09-18 11:33:35,088] [DEBUG] SELECT `updated_time`,`last_login_time`,`_password`,`created_time`,`role_id`,`username`,`is_active`,`is_delete`,`id` FROM `user` WHERE `is_delete`=%s ORDER BY `id` DESC LIMIT %s OFFSET %s: [False, 10, 0]
[2025-09-18 11:33:35,091] [DEBUG] SELECT `desc`,`updated_time`,`created_time`,`name`,`id` FROM `role` WHERE `id` IN (%s,%s): [2, 1]
[2025-09-18 11:33:35,092] [INFO] 127.0.0.1:30033 - "GET /api/user/info?page=1&size=10&username= HTTP/1.1" 200
[2025-09-18 11:33:38,879] [INFO] 127.0.0.1:30033 - "POST /api/logout HTTP/1.1" 200
[2025-09-18 11:34:03,022] [INFO] 127.0.0.1:18715 - "POST /api/logout HTTP/1.1" 200
[2025-09-18 11:34:09,345] [DEBUG] Calling on_field_start with no data
[2025-09-18 11:34:09,346] [DEBUG] Calling on_field_name with data[0:8]
[2025-09-18 11:34:09,346] [DEBUG] Calling on_field_data with data[9:15]
[2025-09-18 11:34:09,346] [DEBUG] Calling on_field_end with no data
[2025-09-18 11:34:09,346] [DEBUG] Calling on_field_start with no data
[2025-09-18 11:34:09,346] [DEBUG] Calling on_field_name with data[16:24]
[2025-09-18 11:34:09,346] [DEBUG] Calling on_field_data with data[25:33]
[2025-09-18 11:34:09,346] [DEBUG] Calling on_field_end with no data
[2025-09-18 11:34:09,346] [DEBUG] Calling on_end with no data
[2025-09-18 11:34:09,347] [DEBUG] SELECT `updated_time`,`last_login_time`,`_password`,`created_time`,`role_id`,`username`,`is_active`,`is_delete`,`id` FROM `user` WHERE `username`=%s LIMIT %s: ['common', 2]
[2025-09-18 11:34:09,575] [DEBUG] UPDATE `user` SET `created_time`=%s,`updated_time`=%s,`username`=%s,`_password`=%s,`is_active`=%s,`is_delete`=%s,`last_login_time`=%s,`role_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 11, 15, 29, 0, 287124, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 11, 34, 9, 575230, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), 'common', '$2b$12$2iiv51Qm6jlaI3/jRpfRwO1o9pB.4c0rl0l1u2X30E9LsiHc2k14O', False, False, datetime.datetime(2025, 9, 18, 11, 34, 9, 575230), 2, 2]
[2025-09-18 11:34:09,579] [INFO] 127.0.0.1:1297 - "POST /api/login HTTP/1.1" 200
[2025-09-18 11:34:09,606] [DEBUG] SELECT `user`.`updated_time`,`user`.`last_login_time`,`user`.`_password`,`user`.`created_time`,`user`.`role_id`,`user`.`username`,`user`.`is_active`,`user`.`is_delete`,`user`.`id`,`user__role`.`desc` `user__role.desc`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`id` `user__role.id` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [2, 2]
[2025-09-18 11:34:09,609] [DEBUG] SELECT `desc`,`updated_time`,`created_time`,`name`,`id` FROM `role` WHERE `name`=%s LIMIT %s: ['common', 2]
[2025-09-18 11:34:09,610] [DEBUG] SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`menu`.`updated_time` `updated_time`,`menu`.`created_time` `created_time`,`menu`.`parent_id` `parent_id`,`menu`.`path` `path`,`menu`.`label` `label`,`menu`.`icon` `icon`,`menu`.`id` `id` FROM `menu` JOIN (SELECT `role_id` `_backward_relation_key`,`menu_id` `_forward_relation_key` FROM `role_menu` WHERE `role_id` IN (%s)) `sq0` ON `sq0`.`_forward_relation_key`=`menu`.`id`: [2]
[2025-09-18 11:34:09,612] [DEBUG] SELECT `menu`.`id` `id`,`menu`.`label` `label`,`menu`.`path` `path`,`menu`.`icon` `icon`,`menu`.`parent_id` `parent_id` FROM `menu` LEFT OUTER JOIN `role_menu` ON `menu`.`id`=`role_menu`.`menu_id` WHERE `role_menu`.`role_id`=%s: [2]
[2025-09-18 11:34:09,615] [INFO] 127.0.0.1:1297 - "GET /api/user/get_menu HTTP/1.1" 200
[2025-09-18 11:34:11,693] [INFO] 127.0.0.1:1297 - "OPTIONS /api/env/getEnvData HTTP/1.1" 200
[2025-09-18 11:34:11,697] [DEBUG] SELECT `user`.`updated_time`,`user`.`last_login_time`,`user`.`_password`,`user`.`created_time`,`user`.`role_id`,`user`.`username`,`user`.`is_active`,`user`.`is_delete`,`user`.`id`,`user__role`.`desc` `user__role.desc`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`id` `user__role.id` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [2, 2]
[2025-09-18 11:34:11,700] [INFO] 127.0.0.1:1297 - "GET /api/env/getEnvData HTTP/1.1" 404
[2025-09-18 11:34:14,618] [INFO] 127.0.0.1:27691 - "POST /api/logout HTTP/1.1" 200
[2025-09-18 11:34:20,977] [DEBUG] Calling on_field_start with no data
[2025-09-18 11:34:20,977] [DEBUG] Calling on_field_name with data[0:8]
[2025-09-18 11:34:20,977] [DEBUG] Calling on_field_data with data[9:18]
[2025-09-18 11:34:20,977] [DEBUG] Calling on_field_end with no data
[2025-09-18 11:34:20,977] [DEBUG] Calling on_field_start with no data
[2025-09-18 11:34:20,977] [DEBUG] Calling on_field_name with data[19:27]
[2025-09-18 11:34:20,977] [DEBUG] Calling on_field_data with data[28:36]
[2025-09-18 11:34:20,977] [DEBUG] Calling on_field_end with no data
[2025-09-18 11:34:20,977] [DEBUG] Calling on_end with no data
[2025-09-18 11:34:20,978] [DEBUG] SELECT `updated_time`,`last_login_time`,`_password`,`created_time`,`role_id`,`username`,`is_active`,`is_delete`,`id` FROM `user` WHERE `username`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 11:34:21,170] [DEBUG] UPDATE `user` SET `created_time`=%s,`updated_time`=%s,`username`=%s,`_password`=%s,`is_active`=%s,`is_delete`=%s,`last_login_time`=%s,`role_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 10, 17, 56, 46, 523247, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 11, 34, 21, 170878, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), 'superuser', '$2b$12$eFMO7BX7aMPlXwdeaZs/H.BLqpzyX26wQaM42fLMrG/GWgt3LJcRC', False, False, datetime.datetime(2025, 9, 18, 11, 34, 21, 170878), 1, 1]
[2025-09-18 11:34:21,176] [INFO] 127.0.0.1:14941 - "POST /api/login HTTP/1.1" 200
[2025-09-18 11:34:21,195] [DEBUG] SELECT `user`.`updated_time`,`user`.`last_login_time`,`user`.`_password`,`user`.`created_time`,`user`.`role_id`,`user`.`username`,`user`.`is_active`,`user`.`is_delete`,`user`.`id`,`user__role`.`desc` `user__role.desc`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`id` `user__role.id` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [1, 2]
[2025-09-18 11:34:21,197] [DEBUG] SELECT `desc`,`updated_time`,`created_time`,`name`,`id` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 11:34:21,199] [DEBUG] SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`menu`.`updated_time` `updated_time`,`menu`.`created_time` `created_time`,`menu`.`parent_id` `parent_id`,`menu`.`path` `path`,`menu`.`label` `label`,`menu`.`icon` `icon`,`menu`.`id` `id` FROM `menu` JOIN (SELECT `role_id` `_backward_relation_key`,`menu_id` `_forward_relation_key` FROM `role_menu` WHERE `role_id` IN (%s)) `sq0` ON `sq0`.`_forward_relation_key`=`menu`.`id`: [1]
[2025-09-18 11:34:21,201] [DEBUG] SELECT `menu`.`id` `id`,`menu`.`label` `label`,`menu`.`path` `path`,`menu`.`icon` `icon`,`menu`.`parent_id` `parent_id` FROM `menu` LEFT OUTER JOIN `role_menu` ON `menu`.`id`=`role_menu`.`menu_id` WHERE `role_menu`.`role_id`=%s: [1]
[2025-09-18 11:34:21,202] [INFO] 127.0.0.1:14941 - "GET /api/user/get_menu HTTP/1.1" 200
[2025-09-18 11:34:22,827] [DEBUG] SELECT `user`.`updated_time`,`user`.`last_login_time`,`user`.`_password`,`user`.`created_time`,`user`.`role_id`,`user`.`username`,`user`.`is_active`,`user`.`is_delete`,`user`.`id`,`user__role`.`desc` `user__role.desc`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`id` `user__role.id` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [1, 2]
[2025-09-18 11:34:22,829] [DEBUG] SELECT COUNT(*) FROM `user` WHERE `is_delete`=%s: [False]
[2025-09-18 11:34:22,829] [DEBUG] SELECT `updated_time`,`last_login_time`,`_password`,`created_time`,`role_id`,`username`,`is_active`,`is_delete`,`id` FROM `user` WHERE `is_delete`=%s ORDER BY `id` DESC LIMIT %s OFFSET %s: [False, 10, 0]
[2025-09-18 11:34:22,831] [DEBUG] SELECT `desc`,`updated_time`,`created_time`,`name`,`id` FROM `role` WHERE `id` IN (%s,%s): [2, 1]
[2025-09-18 11:34:22,833] [INFO] 127.0.0.1:5974 - "GET /api/user/info?page=1&size=10&username= HTTP/1.1" 200
[2025-09-18 11:34:25,906] [INFO] 127.0.0.1:5974 - "POST /api/logout HTTP/1.1" 200
[2025-09-18 11:34:32,938] [DEBUG] Calling on_field_start with no data
[2025-09-18 11:34:32,938] [DEBUG] Calling on_field_name with data[0:8]
[2025-09-18 11:34:32,938] [DEBUG] Calling on_field_data with data[9:15]
[2025-09-18 11:34:32,938] [DEBUG] Calling on_field_end with no data
[2025-09-18 11:34:32,938] [DEBUG] Calling on_field_start with no data
[2025-09-18 11:34:32,938] [DEBUG] Calling on_field_name with data[16:24]
[2025-09-18 11:34:32,938] [DEBUG] Calling on_field_data with data[25:33]
[2025-09-18 11:34:32,938] [DEBUG] Calling on_field_end with no data
[2025-09-18 11:34:32,938] [DEBUG] Calling on_end with no data
[2025-09-18 11:34:32,938] [DEBUG] SELECT `updated_time`,`last_login_time`,`_password`,`created_time`,`role_id`,`username`,`is_active`,`is_delete`,`id` FROM `user` WHERE `username`=%s LIMIT %s: ['common', 2]
[2025-09-18 11:34:33,125] [DEBUG] UPDATE `user` SET `created_time`=%s,`updated_time`=%s,`username`=%s,`_password`=%s,`is_active`=%s,`is_delete`=%s,`last_login_time`=%s,`role_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 11, 15, 29, 0, 287124, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 11, 34, 33, 125976, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), 'common', '$2b$12$2iiv51Qm6jlaI3/jRpfRwO1o9pB.4c0rl0l1u2X30E9LsiHc2k14O', False, False, datetime.datetime(2025, 9, 18, 11, 34, 33, 125976), 2, 2]
[2025-09-18 11:34:33,130] [INFO] 127.0.0.1:3793 - "POST /api/login HTTP/1.1" 200
[2025-09-18 11:34:33,147] [DEBUG] SELECT `user`.`updated_time`,`user`.`last_login_time`,`user`.`_password`,`user`.`created_time`,`user`.`role_id`,`user`.`username`,`user`.`is_active`,`user`.`is_delete`,`user`.`id`,`user__role`.`desc` `user__role.desc`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`id` `user__role.id` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [2, 2]
[2025-09-18 11:34:33,150] [DEBUG] SELECT `desc`,`updated_time`,`created_time`,`name`,`id` FROM `role` WHERE `name`=%s LIMIT %s: ['common', 2]
[2025-09-18 11:34:33,151] [DEBUG] SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`menu`.`updated_time` `updated_time`,`menu`.`created_time` `created_time`,`menu`.`parent_id` `parent_id`,`menu`.`path` `path`,`menu`.`label` `label`,`menu`.`icon` `icon`,`menu`.`id` `id` FROM `menu` JOIN (SELECT `role_id` `_backward_relation_key`,`menu_id` `_forward_relation_key` FROM `role_menu` WHERE `role_id` IN (%s)) `sq0` ON `sq0`.`_forward_relation_key`=`menu`.`id`: [2]
[2025-09-18 11:34:33,153] [DEBUG] SELECT `menu`.`id` `id`,`menu`.`label` `label`,`menu`.`path` `path`,`menu`.`icon` `icon`,`menu`.`parent_id` `parent_id` FROM `menu` LEFT OUTER JOIN `role_menu` ON `menu`.`id`=`role_menu`.`menu_id` WHERE `role_menu`.`role_id`=%s: [2]
[2025-09-18 11:34:33,155] [INFO] 127.0.0.1:3793 - "GET /api/user/get_menu HTTP/1.1" 200
[2025-09-18 15:26:12,170] [INFO] Started server process [29224]
[2025-09-18 15:26:12,170] [INFO] Waiting for application startup.
[2025-09-18 15:26:12,171] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:26:12,235] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:26:15,244] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001FE24E76480> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:26:15,244] [DEBUG] SELECT `version`,`id`,`app`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:26:15,265] [DEBUG] select version() as version: None
[2025-09-18 15:26:15,269] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:26:15,271] [DEBUG] SELECT `icon`,`path`,`created_time`,`updated_time`,`id`,`label`,`parent_id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/home', 2]
[2025-09-18 15:26:15,274] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 10, 17, 56, 46, 309331, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 15, 26, 15, 273072, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '首页', '/home', 'house', None, 1]
[2025-09-18 15:26:15,286] [DEBUG] SELECT `icon`,`path`,`created_time`,`updated_time`,`id`,`label`,`parent_id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/', 2]
[2025-09-18 15:26:15,287] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 10, 17, 56, 46, 311314, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 15, 26, 15, 287074, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '环境', '/', 'location', None, 2]
[2025-09-18 15:26:15,290] [DEBUG] SELECT `icon`,`path`,`created_time`,`updated_time`,`id`,`label`,`parent_id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/env/info', 2]
[2025-09-18 15:26:15,291] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 10, 17, 56, 46, 313314, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 15, 26, 15, 291074, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '环境信息', '/env/info', 'setting', 2, 3]
[2025-09-18 15:26:15,293] [DEBUG] SELECT `icon`,`path`,`created_time`,`updated_time`,`id`,`label`,`parent_id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/env/version', 2]
[2025-09-18 15:26:15,294] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 10, 17, 56, 46, 315313, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 15, 26, 15, 294579, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '组件版本', '/env/version', 'setting', 2, 4]
[2025-09-18 15:26:15,296] [DEBUG] SELECT `icon`,`path`,`created_time`,`updated_time`,`id`,`label`,`parent_id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/env/compare', 2]
[2025-09-18 15:26:15,296] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 10, 17, 56, 46, 317314, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 15, 26, 15, 296579, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '版本比较', '/env/compare', 'setting', 2, 5]
[2025-09-18 15:26:15,298] [DEBUG] SELECT `icon`,`path`,`created_time`,`updated_time`,`id`,`label`,`parent_id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/user', 2]
[2025-09-18 15:26:15,299] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 10, 17, 56, 46, 319315, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 15, 26, 15, 299350, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '用户管理', '/user', 'user', None, 6]
[2025-09-18 15:26:15,300] [DEBUG] SELECT `icon`,`path`,`created_time`,`updated_time`,`id`,`label`,`parent_id` FROM `menu`: []
[2025-09-18 15:26:15,301] [DEBUG] SELECT `icon`,`path`,`created_time`,`updated_time`,`id`,`label`,`parent_id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/user', 2]
[2025-09-18 15:26:15,302] [DEBUG] SELECT `created_time`,`updated_time`,`desc`,`name`,`id` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 15:26:15,303] [DEBUG] DELETE FROM `role_menu` WHERE `role_id`=%s: [1]
[2025-09-18 15:26:15,306] [DEBUG] SELECT `menu_id` FROM `role_menu` WHERE `role_id`=%s AND `menu_id` IN (%s,%s,%s,%s,%s,%s): [1, 1, 2, 3, 4, 5, 6]
[2025-09-18 15:26:15,306] [DEBUG] INSERT INTO `role_menu` (`menu_id`,`role_id`) VALUES (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s): [1, 1, 2, 1, 3, 1, 4, 1, 5, 1, 6, 1]
[2025-09-18 15:26:15,309] [DEBUG] SELECT `created_time`,`updated_time`,`desc`,`name`,`id` FROM `role` WHERE `name`=%s LIMIT %s: ['common', 2]
[2025-09-18 15:26:15,310] [DEBUG] DELETE FROM `role_menu` WHERE `role_id`=%s: [2]
[2025-09-18 15:26:15,312] [DEBUG] SELECT `menu_id` FROM `role_menu` WHERE `role_id`=%s AND `menu_id` IN (%s,%s,%s,%s,%s): [2, 1, 2, 3, 4, 5]
[2025-09-18 15:26:15,313] [DEBUG] INSERT INTO `role_menu` (`menu_id`,`role_id`) VALUES (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s): [1, 2, 2, 2, 3, 2, 4, 2, 5, 2]
[2025-09-18 15:26:15,314] [DEBUG] SELECT `created_time`,`updated_time`,`desc`,`name`,`id` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 15:26:15,315] [DEBUG] SELECT `created_time`,`is_delete`,`_password`,`updated_time`,`is_active`,`last_login_time`,`id`,`username`,`role_id` FROM `user` WHERE `username`=%s LIMIT %s: ['admin', 2]
[2025-09-18 15:26:15,317] [INFO] 超级管理员已存在
[2025-09-18 15:26:15,317] [INFO] Application startup complete.
[2025-09-18 15:26:31,577] [INFO] Shutting down
[2025-09-18 15:26:31,683] [INFO] Waiting for application shutdown.
[2025-09-18 15:26:31,683] [DEBUG] Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:26:31,683] [INFO] Tortoise-ORM shutdown
[2025-09-18 15:26:31,683] [INFO] Application shutdown complete.
[2025-09-18 15:26:31,683] [INFO] Finished server process [29224]
[2025-09-18 15:26:33,345] [INFO] Started server process [31956]
[2025-09-18 15:26:33,345] [INFO] Waiting for application startup.
[2025-09-18 15:26:33,345] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:26:33,470] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 22, in init_db
    await command.init()
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 40, in init
    await Migrate.init(self.tortoise_config, self.app, self.location)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 101, in init
    await Tortoise.init(config=config)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\__init__.py", line 522, in init
    cls._init_apps(apps_config)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\__init__.py", line 355, in _init_apps
    cls._init_relations()
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\__init__.py", line 259, in _init_relations
    raise ConfigurationError(
tortoise.exceptions.ConfigurationError: backward relation "components" duplicates in model Env

[2025-09-18 15:26:33,470] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:27:33,050] [INFO] Started server process [33604]
[2025-09-18 15:27:33,050] [INFO] Waiting for application startup.
[2025-09-18 15:27:33,051] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:27:33,068] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 22, in init_db
    await command.init()
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 40, in init
    await Migrate.init(self.tortoise_config, self.app, self.location)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 101, in init
    await Tortoise.init(config=config)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\__init__.py", line 522, in init
    cls._init_apps(apps_config)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\__init__.py", line 355, in _init_apps
    cls._init_relations()
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\__init__.py", line 259, in _init_relations
    raise ConfigurationError(
tortoise.exceptions.ConfigurationError: backward relation "envs" duplicates in model Component

[2025-09-18 15:27:33,068] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:29:07,240] [INFO] Started server process [37576]
[2025-09-18 15:29:07,240] [INFO] Waiting for application startup.
[2025-09-18 15:29:07,240] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:29:07,258] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 22, in init_db
    await command.init()
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 40, in init
    await Migrate.init(self.tortoise_config, self.app, self.location)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 101, in init
    await Tortoise.init(config=config)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\__init__.py", line 522, in init
    cls._init_apps(apps_config)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\__init__.py", line 355, in _init_apps
    cls._init_relations()
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\__init__.py", line 259, in _init_relations
    raise ConfigurationError(
tortoise.exceptions.ConfigurationError: backward relation "envs" duplicates in model Component

[2025-09-18 15:29:07,258] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:29:22,474] [INFO] Started server process [43976]
[2025-09-18 15:29:22,474] [INFO] Waiting for application startup.
[2025-09-18 15:29:22,475] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:29:22,493] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 22, in init_db
    await command.init()
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 40, in init
    await Migrate.init(self.tortoise_config, self.app, self.location)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 101, in init
    await Tortoise.init(config=config)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\__init__.py", line 522, in init
    cls._init_apps(apps_config)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\__init__.py", line 355, in _init_apps
    cls._init_relations()
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\__init__.py", line 259, in _init_relations
    raise ConfigurationError(
tortoise.exceptions.ConfigurationError: backward relation "envs" duplicates in model Component

[2025-09-18 15:29:22,493] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:29:48,521] [INFO] Started server process [19476]
[2025-09-18 15:29:48,521] [INFO] Waiting for application startup.
[2025-09-18 15:29:48,521] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:29:48,544] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 22, in init_db
    await command.init()
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 40, in init
    await Migrate.init(self.tortoise_config, self.app, self.location)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 101, in init
    await Tortoise.init(config=config)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\__init__.py", line 522, in init
    cls._init_apps(apps_config)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\__init__.py", line 355, in _init_apps
    cls._init_relations()
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\__init__.py", line 259, in _init_relations
    raise ConfigurationError(
tortoise.exceptions.ConfigurationError: backward relation "envs" duplicates in model Component

[2025-09-18 15:29:48,544] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:19,760] [INFO] Started server process [14168]
[2025-09-18 15:30:19,761] [INFO] Waiting for application startup.
[2025-09-18 15:30:19,761] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:19,793] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:19,823] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x00000243D7304140> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:19,823] [DEBUG] SELECT `content`,`version`,`id`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:19,827] [DEBUG] select version() as version: None
[2025-09-18 15:30:19,832] [DEBUG] SELECT `content`,`version`,`id`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:19,834] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:19,835] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153019_update.py', 'models', 1]
[2025-09-18 15:30:19,850] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:19,925] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:19,925] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:20,788] [INFO] Started server process [31480]
[2025-09-18 15:30:20,789] [INFO] Waiting for application startup.
[2025-09-18 15:30:20,789] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:20,813] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:20,839] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x00000251ED6B4170> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:20,839] [DEBUG] SELECT `version`,`content`,`app`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:20,847] [DEBUG] select version() as version: None
[2025-09-18 15:30:20,850] [DEBUG] SELECT `version`,`content`,`app`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:20,852] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:20,854] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153020_update.py', 'models', 1]
[2025-09-18 15:30:20,864] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:20,873] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:20,874] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:21,668] [INFO] Started server process [10932]
[2025-09-18 15:30:21,668] [INFO] Waiting for application startup.
[2025-09-18 15:30:21,668] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:21,691] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:21,716] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001A613EFED20> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:21,716] [DEBUG] SELECT `id`,`app`,`content`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:21,719] [DEBUG] select version() as version: None
[2025-09-18 15:30:21,723] [DEBUG] SELECT `id`,`app`,`content`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:21,725] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:21,726] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153021_update.py', 'models', 1]
[2025-09-18 15:30:21,736] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:21,739] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:21,742] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:22,537] [INFO] Started server process [19752]
[2025-09-18 15:30:22,537] [INFO] Waiting for application startup.
[2025-09-18 15:30:22,538] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:22,570] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:22,599] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001DA55541460> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:22,599] [DEBUG] SELECT `version`,`app`,`id`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:22,603] [DEBUG] select version() as version: None
[2025-09-18 15:30:22,608] [DEBUG] SELECT `version`,`app`,`id`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:22,611] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:22,612] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153022_update.py', 'models', 1]
[2025-09-18 15:30:22,615] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:22,620] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:22,620] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:23,384] [INFO] Started server process [43788]
[2025-09-18 15:30:23,384] [INFO] Waiting for application startup.
[2025-09-18 15:30:23,385] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:23,412] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:23,438] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001A4CB981460> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:23,439] [DEBUG] SELECT `version`,`app`,`id`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:23,442] [DEBUG] select version() as version: None
[2025-09-18 15:30:23,446] [DEBUG] SELECT `version`,`app`,`id`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:23,448] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:23,449] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153023_update.py', 'models', 1]
[2025-09-18 15:30:23,461] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:23,465] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:23,465] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:24,245] [INFO] Started server process [40088]
[2025-09-18 15:30:24,245] [INFO] Waiting for application startup.
[2025-09-18 15:30:24,245] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:24,268] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:24,292] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001C8856D1460> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:24,292] [DEBUG] SELECT `id`,`app`,`content`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:24,296] [DEBUG] select version() as version: None
[2025-09-18 15:30:24,301] [DEBUG] SELECT `id`,`app`,`content`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:24,302] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:24,303] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153024_update.py', 'models', 1]
[2025-09-18 15:30:24,314] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:24,321] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:24,322] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:25,071] [INFO] Started server process [28612]
[2025-09-18 15:30:25,071] [INFO] Waiting for application startup.
[2025-09-18 15:30:25,072] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:25,102] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:25,128] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000026C24EF5280> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:25,128] [DEBUG] SELECT `version`,`app`,`id`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:25,131] [DEBUG] select version() as version: None
[2025-09-18 15:30:25,136] [DEBUG] SELECT `version`,`app`,`id`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:25,138] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:25,139] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153025_update.py', 'models', 1]
[2025-09-18 15:30:25,152] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:25,158] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:25,158] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:25,942] [INFO] Started server process [38680]
[2025-09-18 15:30:25,942] [INFO] Waiting for application startup.
[2025-09-18 15:30:25,943] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:25,971] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:25,999] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x00000269187A58B0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:25,999] [DEBUG] SELECT `content`,`version`,`id`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:26,003] [DEBUG] select version() as version: None
[2025-09-18 15:30:26,008] [DEBUG] SELECT `content`,`version`,`id`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:26,010] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:26,011] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153026_update.py', 'models', 1]
[2025-09-18 15:30:26,022] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:26,027] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:26,027] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:26,859] [INFO] Started server process [24688]
[2025-09-18 15:30:26,860] [INFO] Waiting for application startup.
[2025-09-18 15:30:26,860] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:26,888] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:26,915] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000021B3E1B4170> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:26,915] [DEBUG] SELECT `id`,`version`,`content`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:26,919] [DEBUG] select version() as version: None
[2025-09-18 15:30:26,924] [DEBUG] SELECT `id`,`version`,`content`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:26,926] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:26,928] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153026_update.py', 'models', 1]
[2025-09-18 15:30:26,929] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:26,937] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:26,938] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:27,733] [INFO] Started server process [35628]
[2025-09-18 15:30:27,733] [INFO] Waiting for application startup.
[2025-09-18 15:30:27,734] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:27,761] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:27,789] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000024A12BE4170> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:27,789] [DEBUG] SELECT `content`,`id`,`app`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:27,792] [DEBUG] select version() as version: None
[2025-09-18 15:30:27,796] [DEBUG] SELECT `content`,`id`,`app`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:27,798] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:27,799] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153027_update.py', 'models', 1]
[2025-09-18 15:30:27,813] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:27,817] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:27,817] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:28,632] [INFO] Started server process [42464]
[2025-09-18 15:30:28,632] [INFO] Waiting for application startup.
[2025-09-18 15:30:28,632] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:28,662] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:28,689] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x00000154555CDEB0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:28,689] [DEBUG] SELECT `content`,`version`,`id`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:28,694] [DEBUG] select version() as version: None
[2025-09-18 15:30:28,699] [DEBUG] SELECT `content`,`version`,`id`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:28,702] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:28,703] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153028_update.py', 'models', 1]
[2025-09-18 15:30:28,706] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:28,712] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:28,712] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:29,560] [INFO] Started server process [10656]
[2025-09-18 15:30:29,560] [INFO] Waiting for application startup.
[2025-09-18 15:30:29,560] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:29,587] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:29,612] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000019AE9364170> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:29,612] [DEBUG] SELECT `id`,`content`,`app`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:29,617] [DEBUG] select version() as version: None
[2025-09-18 15:30:29,622] [DEBUG] SELECT `id`,`content`,`app`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:29,624] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:29,625] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153029_update.py', 'models', 1]
[2025-09-18 15:30:29,639] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:29,644] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:29,644] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:30,397] [INFO] Started server process [42692]
[2025-09-18 15:30:30,397] [INFO] Waiting for application startup.
[2025-09-18 15:30:30,398] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:30,426] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:30,453] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000002A52EC69100> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:30,453] [DEBUG] SELECT `id`,`app`,`version`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:30,455] [DEBUG] select version() as version: None
[2025-09-18 15:30:30,461] [DEBUG] SELECT `id`,`app`,`version`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:30,462] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:30,462] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153030_update.py', 'models', 1]
[2025-09-18 15:30:30,477] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:30,481] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:30,481] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:31,287] [INFO] Started server process [16408]
[2025-09-18 15:30:31,288] [INFO] Waiting for application startup.
[2025-09-18 15:30:31,288] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:31,314] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:31,338] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001F1A07F9250> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:31,338] [DEBUG] SELECT `id`,`version`,`content`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:31,340] [DEBUG] select version() as version: None
[2025-09-18 15:30:31,344] [DEBUG] SELECT `id`,`version`,`content`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:31,346] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:31,347] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153031_update.py', 'models', 1]
[2025-09-18 15:30:31,350] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:31,354] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:31,355] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:32,120] [INFO] Started server process [1260]
[2025-09-18 15:30:32,120] [INFO] Waiting for application startup.
[2025-09-18 15:30:32,120] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:32,156] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:32,183] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001E8FD399190> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:32,183] [DEBUG] SELECT `id`,`version`,`app`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:32,185] [DEBUG] select version() as version: None
[2025-09-18 15:30:32,190] [DEBUG] SELECT `id`,`version`,`app`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:32,192] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:32,193] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153032_update.py', 'models', 1]
[2025-09-18 15:30:32,207] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:32,212] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:32,212] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:32,933] [INFO] Started server process [44972]
[2025-09-18 15:30:32,934] [INFO] Waiting for application startup.
[2025-09-18 15:30:32,934] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:32,960] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:32,984] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x00000195F99B1460> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:32,984] [DEBUG] SELECT `version`,`app`,`id`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:32,986] [DEBUG] select version() as version: None
[2025-09-18 15:30:32,990] [DEBUG] SELECT `version`,`app`,`id`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:32,992] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:32,992] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153032_update.py', 'models', 1]
[2025-09-18 15:30:32,993] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:32,997] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:32,997] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:33,728] [INFO] Started server process [43732]
[2025-09-18 15:30:33,728] [INFO] Waiting for application startup.
[2025-09-18 15:30:33,728] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:33,752] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:33,777] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001A0BA8E1400> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:33,777] [DEBUG] SELECT `version`,`content`,`app`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:33,778] [DEBUG] select version() as version: None
[2025-09-18 15:30:33,783] [DEBUG] SELECT `version`,`content`,`app`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:33,785] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:33,785] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153033_update.py', 'models', 1]
[2025-09-18 15:30:33,796] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:33,799] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:33,799] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:34,544] [INFO] Started server process [36104]
[2025-09-18 15:30:34,546] [INFO] Waiting for application startup.
[2025-09-18 15:30:34,546] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:34,573] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:34,603] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000022C35A04140> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:34,603] [DEBUG] SELECT `id`,`content`,`version`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:34,604] [DEBUG] select version() as version: None
[2025-09-18 15:30:34,610] [DEBUG] SELECT `id`,`content`,`version`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:34,612] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:34,613] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153034_update.py', 'models', 1]
[2025-09-18 15:30:34,627] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:34,631] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:34,632] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:35,379] [INFO] Started server process [34640]
[2025-09-18 15:30:35,380] [INFO] Waiting for application startup.
[2025-09-18 15:30:35,380] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:35,410] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:35,436] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001DBB44013A0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:35,436] [DEBUG] SELECT `app`,`id`,`version`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:35,438] [DEBUG] select version() as version: None
[2025-09-18 15:30:35,442] [DEBUG] SELECT `app`,`id`,`version`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:35,443] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:35,444] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153035_update.py', 'models', 1]
[2025-09-18 15:30:35,455] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:35,458] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:35,458] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:36,187] [INFO] Started server process [42172]
[2025-09-18 15:30:36,189] [INFO] Waiting for application startup.
[2025-09-18 15:30:36,189] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:36,216] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:36,240] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000011F98F34170> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:36,240] [DEBUG] SELECT `content`,`id`,`app`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:36,242] [DEBUG] select version() as version: None
[2025-09-18 15:30:36,245] [DEBUG] SELECT `content`,`id`,`app`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:36,248] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:36,249] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153036_update.py', 'models', 1]
[2025-09-18 15:30:36,253] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:36,256] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:36,257] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:36,998] [INFO] Started server process [43276]
[2025-09-18 15:30:36,998] [INFO] Waiting for application startup.
[2025-09-18 15:30:36,998] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:37,047] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:37,072] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000021C99271280> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:37,072] [DEBUG] SELECT `app`,`content`,`version`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:37,074] [DEBUG] select version() as version: None
[2025-09-18 15:30:37,078] [DEBUG] SELECT `app`,`content`,`version`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:37,080] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:37,081] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153037_update.py', 'models', 1]
[2025-09-18 15:30:37,084] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:37,088] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:37,089] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:37,856] [INFO] Started server process [36084]
[2025-09-18 15:30:37,856] [INFO] Waiting for application startup.
[2025-09-18 15:30:37,857] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:37,882] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:37,907] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001BD195DD3D0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:37,907] [DEBUG] SELECT `content`,`id`,`version`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:37,909] [DEBUG] select version() as version: None
[2025-09-18 15:30:37,913] [DEBUG] SELECT `content`,`id`,`version`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:37,915] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:37,915] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153037_update.py', 'models', 1]
[2025-09-18 15:30:37,916] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:37,920] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:37,920] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:38,659] [INFO] Started server process [39816]
[2025-09-18 15:30:38,659] [INFO] Waiting for application startup.
[2025-09-18 15:30:38,659] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:38,684] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:38,707] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x00000167AF4AED20> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:38,708] [DEBUG] SELECT `content`,`app`,`id`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:38,709] [DEBUG] select version() as version: None
[2025-09-18 15:30:38,714] [DEBUG] SELECT `content`,`app`,`id`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:38,716] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:38,716] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153038_update.py', 'models', 1]
[2025-09-18 15:30:38,728] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:38,730] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:38,731] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:39,418] [INFO] Started server process [45256]
[2025-09-18 15:30:39,418] [INFO] Waiting for application startup.
[2025-09-18 15:30:39,418] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:39,441] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:39,465] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x00000134162ED3D0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:39,465] [DEBUG] SELECT `id`,`version`,`app`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:39,467] [DEBUG] select version() as version: None
[2025-09-18 15:30:39,471] [DEBUG] SELECT `id`,`version`,`app`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:39,473] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:39,473] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153039_update.py', 'models', 1]
[2025-09-18 15:30:39,478] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:39,481] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:39,483] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:40,224] [INFO] Started server process [15260]
[2025-09-18 15:30:40,224] [INFO] Waiting for application startup.
[2025-09-18 15:30:40,224] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:40,250] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:40,274] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000024233499190> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:40,274] [DEBUG] SELECT `id`,`version`,`content`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:40,277] [DEBUG] select version() as version: None
[2025-09-18 15:30:40,281] [DEBUG] SELECT `id`,`version`,`content`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:40,283] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:40,284] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153040_update.py', 'models', 1]
[2025-09-18 15:30:40,293] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:40,297] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:40,297] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:41,043] [INFO] Started server process [42076]
[2025-09-18 15:30:41,043] [INFO] Waiting for application startup.
[2025-09-18 15:30:41,044] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:41,069] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:41,095] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000021B0EDF1460> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:41,095] [DEBUG] SELECT `version`,`content`,`id`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:41,098] [DEBUG] select version() as version: None
[2025-09-18 15:30:41,102] [DEBUG] SELECT `version`,`content`,`id`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:41,104] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:41,105] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153041_update.py', 'models', 1]
[2025-09-18 15:30:41,116] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:41,119] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:41,120] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:41,858] [INFO] Started server process [45476]
[2025-09-18 15:30:41,858] [INFO] Waiting for application startup.
[2025-09-18 15:30:41,860] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:41,889] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:41,916] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001F852424170> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:41,916] [DEBUG] SELECT `content`,`id`,`version`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:41,918] [DEBUG] select version() as version: None
[2025-09-18 15:30:41,924] [DEBUG] SELECT `content`,`id`,`version`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:41,926] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:41,927] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153041_update.py', 'models', 1]
[2025-09-18 15:30:41,928] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:41,930] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:41,930] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:42,666] [INFO] Started server process [25208]
[2025-09-18 15:30:42,666] [INFO] Waiting for application startup.
[2025-09-18 15:30:42,667] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:42,692] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:42,718] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000002B556A3DEB0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:42,718] [DEBUG] SELECT `version`,`content`,`id`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:42,720] [DEBUG] select version() as version: None
[2025-09-18 15:30:42,725] [DEBUG] SELECT `version`,`content`,`id`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:42,727] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:42,728] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153042_update.py', 'models', 1]
[2025-09-18 15:30:42,731] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:42,734] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:42,735] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:43,463] [INFO] Started server process [38876]
[2025-09-18 15:30:43,463] [INFO] Waiting for application startup.
[2025-09-18 15:30:43,464] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:43,488] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:43,512] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000029E36D41400> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:43,512] [DEBUG] SELECT `content`,`version`,`app`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:43,514] [DEBUG] select version() as version: None
[2025-09-18 15:30:43,518] [DEBUG] SELECT `content`,`version`,`app`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:43,520] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:43,521] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153043_update.py', 'models', 1]
[2025-09-18 15:30:43,532] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:43,536] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:43,536] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:44,230] [INFO] Started server process [19664]
[2025-09-18 15:30:44,230] [INFO] Waiting for application startup.
[2025-09-18 15:30:44,230] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:44,255] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:44,279] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001BEA9AE1280> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:44,279] [DEBUG] SELECT `version`,`id`,`app`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:44,280] [DEBUG] select version() as version: None
[2025-09-18 15:30:44,285] [DEBUG] SELECT `version`,`id`,`app`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:44,286] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:44,287] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153044_update.py', 'models', 1]
[2025-09-18 15:30:44,298] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:44,302] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:44,302] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:45,045] [INFO] Started server process [11708]
[2025-09-18 15:30:45,045] [INFO] Waiting for application startup.
[2025-09-18 15:30:45,045] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:45,082] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:45,110] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000020C1928EF60> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:45,110] [DEBUG] SELECT `app`,`version`,`id`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:45,112] [DEBUG] select version() as version: None
[2025-09-18 15:30:45,116] [DEBUG] SELECT `app`,`version`,`id`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:45,118] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:45,119] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153045_update.py', 'models', 1]
[2025-09-18 15:30:45,122] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:45,125] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:45,126] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:45,852] [INFO] Started server process [5464]
[2025-09-18 15:30:45,852] [INFO] Waiting for application startup.
[2025-09-18 15:30:45,853] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:45,878] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:45,901] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000020220234170> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:45,902] [DEBUG] SELECT `app`,`id`,`version`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:45,903] [DEBUG] select version() as version: None
[2025-09-18 15:30:45,908] [DEBUG] SELECT `app`,`id`,`version`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:45,909] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:45,910] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153045_update.py', 'models', 1]
[2025-09-18 15:30:45,910] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:45,912] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:45,912] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:46,686] [INFO] Started server process [21628]
[2025-09-18 15:30:46,686] [INFO] Waiting for application startup.
[2025-09-18 15:30:46,687] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:46,710] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:46,734] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000002E314C64170> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:46,734] [DEBUG] SELECT `content`,`version`,`app`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:46,736] [DEBUG] select version() as version: None
[2025-09-18 15:30:46,740] [DEBUG] SELECT `content`,`version`,`app`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:46,742] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:46,742] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153046_update.py', 'models', 1]
[2025-09-18 15:30:46,745] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:46,747] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:46,748] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:47,467] [INFO] Started server process [39672]
[2025-09-18 15:30:47,467] [INFO] Waiting for application startup.
[2025-09-18 15:30:47,467] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:47,492] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:47,517] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001A5B7B89190> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:47,517] [DEBUG] SELECT `app`,`content`,`id`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:47,519] [DEBUG] select version() as version: None
[2025-09-18 15:30:47,524] [DEBUG] SELECT `app`,`content`,`id`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:47,525] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:47,526] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153047_update.py', 'models', 1]
[2025-09-18 15:30:47,538] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:47,541] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:47,541] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:48,263] [INFO] Started server process [27904]
[2025-09-18 15:30:48,263] [INFO] Waiting for application startup.
[2025-09-18 15:30:48,264] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:48,288] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:48,314] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001AFD9C713A0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:48,314] [DEBUG] SELECT `app`,`id`,`content`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:48,317] [DEBUG] select version() as version: None
[2025-09-18 15:30:48,321] [DEBUG] SELECT `app`,`id`,`content`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:48,323] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:48,324] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153048_update.py', 'models', 1]
[2025-09-18 15:30:48,327] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:48,329] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:48,330] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:49,039] [INFO] Started server process [32252]
[2025-09-18 15:30:49,039] [INFO] Waiting for application startup.
[2025-09-18 15:30:49,040] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:49,064] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:49,090] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000002017EB79190> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:49,090] [DEBUG] SELECT `version`,`app`,`content`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:49,092] [DEBUG] select version() as version: None
[2025-09-18 15:30:49,096] [DEBUG] SELECT `version`,`app`,`content`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:49,098] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:49,098] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153049_update.py', 'models', 1]
[2025-09-18 15:30:49,109] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:49,112] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:49,112] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:49,846] [INFO] Started server process [29152]
[2025-09-18 15:30:49,846] [INFO] Waiting for application startup.
[2025-09-18 15:30:49,847] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:49,872] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:49,900] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000002B1F3FF5A00> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:49,900] [DEBUG] SELECT `app`,`version`,`id`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:49,902] [DEBUG] select version() as version: None
[2025-09-18 15:30:49,906] [DEBUG] SELECT `app`,`version`,`id`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:49,907] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:49,908] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153049_update.py', 'models', 1]
[2025-09-18 15:30:49,908] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:49,911] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:49,911] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:50,754] [INFO] Started server process [32308]
[2025-09-18 15:30:50,754] [INFO] Waiting for application startup.
[2025-09-18 15:30:50,755] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:50,781] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:50,808] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001A621981460> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:50,808] [DEBUG] SELECT `version`,`content`,`app`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:50,810] [DEBUG] select version() as version: None
[2025-09-18 15:30:50,815] [DEBUG] SELECT `version`,`content`,`app`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:50,817] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:50,817] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153050_update.py', 'models', 1]
[2025-09-18 15:30:50,821] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:50,824] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:50,826] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:51,668] [INFO] Started server process [5636]
[2025-09-18 15:30:51,668] [INFO] Waiting for application startup.
[2025-09-18 15:30:51,668] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:51,700] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:51,732] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000013F9CAD5A00> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:51,732] [DEBUG] SELECT `id`,`content`,`app`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:51,734] [DEBUG] select version() as version: None
[2025-09-18 15:30:51,739] [DEBUG] SELECT `id`,`content`,`app`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:51,741] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:51,743] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153051_update.py', 'models', 1]
[2025-09-18 15:30:51,746] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:51,750] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:51,750] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:52,645] [INFO] Started server process [41500]
[2025-09-18 15:30:52,646] [INFO] Waiting for application startup.
[2025-09-18 15:30:52,646] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:52,681] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:52,713] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001DCE2DAED20> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:52,713] [DEBUG] SELECT `version`,`app`,`content`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:52,715] [DEBUG] select version() as version: None
[2025-09-18 15:30:52,721] [DEBUG] SELECT `version`,`app`,`content`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:52,723] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:52,724] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153052_update.py', 'models', 1]
[2025-09-18 15:30:52,728] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:52,732] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:52,733] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:53,568] [INFO] Started server process [39460]
[2025-09-18 15:30:53,569] [INFO] Waiting for application startup.
[2025-09-18 15:30:53,569] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:53,600] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:53,630] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001E638644170> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:53,630] [DEBUG] SELECT `app`,`content`,`version`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:53,632] [DEBUG] select version() as version: None
[2025-09-18 15:30:53,637] [DEBUG] SELECT `app`,`content`,`version`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:53,639] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:53,641] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153053_update.py', 'models', 1]
[2025-09-18 15:30:53,643] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:53,647] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:53,649] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:54,476] [INFO] Started server process [16000]
[2025-09-18 15:30:54,476] [INFO] Waiting for application startup.
[2025-09-18 15:30:54,477] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:54,507] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:54,536] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000019C666F1460> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:54,536] [DEBUG] SELECT `version`,`content`,`app`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:54,538] [DEBUG] select version() as version: None
[2025-09-18 15:30:54,542] [DEBUG] SELECT `version`,`content`,`app`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:54,543] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:54,545] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153054_update.py', 'models', 1]
[2025-09-18 15:30:54,548] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:54,551] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:54,553] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:55,303] [INFO] Started server process [34244]
[2025-09-18 15:30:55,303] [INFO] Waiting for application startup.
[2025-09-18 15:30:55,304] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:55,330] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:55,358] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000028EFFB7EEA0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:55,358] [DEBUG] SELECT `app`,`version`,`id`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:55,360] [DEBUG] select version() as version: None
[2025-09-18 15:30:55,365] [DEBUG] SELECT `app`,`version`,`id`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:55,367] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:55,368] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153055_update.py', 'models', 1]
[2025-09-18 15:30:55,371] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:55,375] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:55,375] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:56,157] [INFO] Started server process [36496]
[2025-09-18 15:30:56,157] [INFO] Waiting for application startup.
[2025-09-18 15:30:56,157] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:56,191] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:56,220] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000002848BD21460> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:56,220] [DEBUG] SELECT `app`,`version`,`content`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:56,222] [DEBUG] select version() as version: None
[2025-09-18 15:30:56,227] [DEBUG] SELECT `app`,`version`,`content`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:56,229] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:56,230] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153056_update.py', 'models', 1]
[2025-09-18 15:30:56,234] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:56,237] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:56,237] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:57,043] [INFO] Started server process [35012]
[2025-09-18 15:30:57,044] [INFO] Waiting for application startup.
[2025-09-18 15:30:57,044] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:57,074] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:57,102] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x00000236E079ED20> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:57,102] [DEBUG] SELECT `version`,`id`,`content`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:57,105] [DEBUG] select version() as version: None
[2025-09-18 15:30:57,110] [DEBUG] SELECT `version`,`id`,`content`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:57,112] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:57,113] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153057_update.py', 'models', 1]
[2025-09-18 15:30:57,115] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:57,119] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:57,119] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:58,044] [INFO] Started server process [44656]
[2025-09-18 15:30:58,044] [INFO] Waiting for application startup.
[2025-09-18 15:30:58,045] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:58,082] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:58,115] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000002ABFCA9EF60> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:58,115] [DEBUG] SELECT `app`,`content`,`version`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:58,117] [DEBUG] select version() as version: None
[2025-09-18 15:30:58,123] [DEBUG] SELECT `app`,`content`,`version`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:58,126] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:58,128] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153058_update.py', 'models', 1]
[2025-09-18 15:30:58,132] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:58,136] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:58,136] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:30:59,035] [INFO] Started server process [38944]
[2025-09-18 15:30:59,035] [INFO] Waiting for application startup.
[2025-09-18 15:30:59,036] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:30:59,067] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:30:59,097] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000028D528813D0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:30:59,097] [DEBUG] SELECT `id`,`version`,`content`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:59,099] [DEBUG] select version() as version: None
[2025-09-18 15:30:59,105] [DEBUG] SELECT `id`,`version`,`content`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:30:59,107] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:30:59,108] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153059_update.py', 'models', 1]
[2025-09-18 15:30:59,112] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:30:59,116] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:30:59,117] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:00,106] [INFO] Started server process [45456]
[2025-09-18 15:31:00,106] [INFO] Waiting for application startup.
[2025-09-18 15:31:00,107] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:00,146] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:00,184] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000019E88F69190> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:00,184] [DEBUG] SELECT `version`,`id`,`content`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:00,187] [DEBUG] select version() as version: None
[2025-09-18 15:31:00,193] [DEBUG] SELECT `version`,`id`,`content`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:00,195] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:00,196] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153100_update.py', 'models', 1]
[2025-09-18 15:31:00,202] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:00,206] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:00,206] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:01,076] [INFO] Started server process [42424]
[2025-09-18 15:31:01,076] [INFO] Waiting for application startup.
[2025-09-18 15:31:01,077] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:01,102] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:01,130] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x00000166670CD3D0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:01,130] [DEBUG] SELECT `content`,`app`,`id`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:01,133] [DEBUG] select version() as version: None
[2025-09-18 15:31:01,137] [DEBUG] SELECT `content`,`app`,`id`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:01,140] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:01,140] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153101_update.py', 'models', 1]
[2025-09-18 15:31:01,152] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:01,155] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:01,155] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:01,958] [INFO] Started server process [42100]
[2025-09-18 15:31:01,958] [INFO] Waiting for application startup.
[2025-09-18 15:31:01,959] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:01,984] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:02,012] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000002B7CB4F1340> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:02,012] [DEBUG] SELECT `content`,`id`,`version`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:02,014] [DEBUG] select version() as version: None
[2025-09-18 15:31:02,019] [DEBUG] SELECT `content`,`id`,`version`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:02,021] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:02,022] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153102_update.py', 'models', 1]
[2025-09-18 15:31:02,025] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:02,029] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:02,031] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:02,811] [INFO] Started server process [46020]
[2025-09-18 15:31:02,811] [INFO] Waiting for application startup.
[2025-09-18 15:31:02,812] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:02,845] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:02,873] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000020F97E61460> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:02,873] [DEBUG] SELECT `content`,`id`,`version`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:02,875] [DEBUG] select version() as version: None
[2025-09-18 15:31:02,880] [DEBUG] SELECT `content`,`id`,`version`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:02,882] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:02,883] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153102_update.py', 'models', 1]
[2025-09-18 15:31:02,884] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:02,887] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:02,888] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:03,757] [INFO] Started server process [33404]
[2025-09-18 15:31:03,757] [INFO] Waiting for application startup.
[2025-09-18 15:31:03,758] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:03,788] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:03,818] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000002B716209220> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:03,818] [DEBUG] SELECT `app`,`id`,`content`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:03,820] [DEBUG] select version() as version: None
[2025-09-18 15:31:03,826] [DEBUG] SELECT `app`,`id`,`content`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:03,829] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:03,829] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153103_update.py', 'models', 1]
[2025-09-18 15:31:03,833] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:03,838] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:03,839] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:04,718] [INFO] Started server process [13460]
[2025-09-18 15:31:04,718] [INFO] Waiting for application startup.
[2025-09-18 15:31:04,719] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:04,743] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:04,768] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001B9EA4C5A00> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:04,769] [DEBUG] SELECT `version`,`app`,`content`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:04,770] [DEBUG] select version() as version: None
[2025-09-18 15:31:04,775] [DEBUG] SELECT `version`,`app`,`content`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:04,776] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:04,777] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153104_update.py', 'models', 1]
[2025-09-18 15:31:04,780] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:04,783] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:04,786] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:05,566] [INFO] Started server process [19772]
[2025-09-18 15:31:05,566] [INFO] Waiting for application startup.
[2025-09-18 15:31:05,566] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:05,591] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:05,617] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001F9E8A310A0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:05,617] [DEBUG] SELECT `app`,`id`,`version`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:05,620] [DEBUG] select version() as version: None
[2025-09-18 15:31:05,624] [DEBUG] SELECT `app`,`id`,`version`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:05,627] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:05,627] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153105_update.py', 'models', 1]
[2025-09-18 15:31:05,630] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:05,634] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:05,634] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:06,324] [INFO] Started server process [10764]
[2025-09-18 15:31:06,324] [INFO] Waiting for application startup.
[2025-09-18 15:31:06,325] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:06,350] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:06,376] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000020D50B21400> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:06,376] [DEBUG] SELECT `version`,`content`,`app`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:06,378] [DEBUG] select version() as version: None
[2025-09-18 15:31:06,382] [DEBUG] SELECT `version`,`content`,`app`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:06,384] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:06,384] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153106_update.py', 'models', 1]
[2025-09-18 15:31:06,388] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:06,393] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:06,393] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:07,199] [INFO] Started server process [11616]
[2025-09-18 15:31:07,199] [INFO] Waiting for application startup.
[2025-09-18 15:31:07,199] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:07,226] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:07,252] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001BA55CA1280> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:07,253] [DEBUG] SELECT `content`,`version`,`app`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:07,254] [DEBUG] select version() as version: None
[2025-09-18 15:31:07,260] [DEBUG] SELECT `content`,`version`,`app`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:07,262] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:07,262] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153107_update.py', 'models', 1]
[2025-09-18 15:31:07,267] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:07,269] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:07,270] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:08,058] [INFO] Started server process [27504]
[2025-09-18 15:31:08,058] [INFO] Waiting for application startup.
[2025-09-18 15:31:08,058] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:08,090] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:08,119] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x00000200417D1130> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:08,119] [DEBUG] SELECT `content`,`app`,`version`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:08,121] [DEBUG] select version() as version: None
[2025-09-18 15:31:08,127] [DEBUG] SELECT `content`,`app`,`version`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:08,129] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:08,130] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153108_update.py', 'models', 1]
[2025-09-18 15:31:08,135] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:08,139] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:08,139] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:08,884] [INFO] Started server process [39036]
[2025-09-18 15:31:08,884] [INFO] Waiting for application startup.
[2025-09-18 15:31:08,885] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:08,910] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:08,936] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001FFF284D3D0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:08,936] [DEBUG] SELECT `content`,`app`,`version`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:08,938] [DEBUG] select version() as version: None
[2025-09-18 15:31:08,943] [DEBUG] SELECT `content`,`app`,`version`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:08,944] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:08,945] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153108_update.py', 'models', 1]
[2025-09-18 15:31:08,946] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:08,949] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:08,949] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:09,738] [INFO] Started server process [12648]
[2025-09-18 15:31:09,739] [INFO] Waiting for application startup.
[2025-09-18 15:31:09,739] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:09,768] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:09,797] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x00000206295F1400> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:09,797] [DEBUG] SELECT `content`,`app`,`version`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:09,799] [DEBUG] select version() as version: None
[2025-09-18 15:31:09,804] [DEBUG] SELECT `content`,`app`,`version`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:09,807] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:09,807] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153109_update.py', 'models', 1]
[2025-09-18 15:31:09,811] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:09,815] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:09,816] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:10,606] [INFO] Started server process [6384]
[2025-09-18 15:31:10,606] [INFO] Waiting for application startup.
[2025-09-18 15:31:10,606] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:10,636] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:10,665] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000020EBBEB10A0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:10,666] [DEBUG] SELECT `id`,`content`,`app`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:10,668] [DEBUG] select version() as version: None
[2025-09-18 15:31:10,673] [DEBUG] SELECT `id`,`content`,`app`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:10,676] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:10,677] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153110_update.py', 'models', 1]
[2025-09-18 15:31:10,681] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:10,686] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:10,686] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:11,452] [INFO] Started server process [38008]
[2025-09-18 15:31:11,452] [INFO] Waiting for application startup.
[2025-09-18 15:31:11,452] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:11,487] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:11,519] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001D18D4F6DE0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:11,519] [DEBUG] SELECT `version`,`content`,`app`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:11,521] [DEBUG] select version() as version: None
[2025-09-18 15:31:11,527] [DEBUG] SELECT `version`,`content`,`app`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:11,530] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:11,531] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153111_update.py', 'models', 1]
[2025-09-18 15:31:11,534] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:11,539] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:11,539] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:12,335] [INFO] Started server process [22752]
[2025-09-18 15:31:12,335] [INFO] Waiting for application startup.
[2025-09-18 15:31:12,335] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:12,362] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:12,390] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001CE5E379190> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:12,390] [DEBUG] SELECT `content`,`id`,`version`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:12,392] [DEBUG] select version() as version: None
[2025-09-18 15:31:12,397] [DEBUG] SELECT `content`,`id`,`version`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:12,399] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:12,400] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153112_update.py', 'models', 1]
[2025-09-18 15:31:12,404] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:12,408] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:12,408] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:13,251] [INFO] Started server process [43068]
[2025-09-18 15:31:13,251] [INFO] Waiting for application startup.
[2025-09-18 15:31:13,252] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:13,283] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:13,314] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000021537D04170> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:13,314] [DEBUG] SELECT `content`,`id`,`app`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:13,316] [DEBUG] select version() as version: None
[2025-09-18 15:31:13,321] [DEBUG] SELECT `content`,`id`,`app`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:13,323] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:13,324] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153113_update.py', 'models', 1]
[2025-09-18 15:31:13,338] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:13,342] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:13,343] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:16,061] [INFO] Started server process [32948]
[2025-09-18 15:31:16,061] [INFO] Waiting for application startup.
[2025-09-18 15:31:16,061] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:16,093] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:16,123] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000002CDCA5213A0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:16,123] [DEBUG] SELECT `id`,`version`,`content`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:16,125] [DEBUG] select version() as version: None
[2025-09-18 15:31:16,131] [DEBUG] SELECT `id`,`version`,`content`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:16,133] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:16,134] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153116_update.py', 'models', 1]
[2025-09-18 15:31:16,137] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:16,141] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:16,142] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:17,003] [INFO] Started server process [37076]
[2025-09-18 15:31:17,003] [INFO] Waiting for application startup.
[2025-09-18 15:31:17,004] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:17,037] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:17,066] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x00000179DDA49250> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:17,066] [DEBUG] SELECT `id`,`content`,`version`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:17,068] [DEBUG] select version() as version: None
[2025-09-18 15:31:17,073] [DEBUG] SELECT `id`,`content`,`version`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:17,075] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:17,076] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153117_update.py', 'models', 1]
[2025-09-18 15:31:17,080] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:17,085] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:17,085] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:17,880] [INFO] Started server process [22584]
[2025-09-18 15:31:17,880] [INFO] Waiting for application startup.
[2025-09-18 15:31:17,880] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:17,905] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:17,931] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000002264C474170> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:17,931] [DEBUG] SELECT `content`,`version`,`id`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:17,933] [DEBUG] select version() as version: None
[2025-09-18 15:31:17,937] [DEBUG] SELECT `content`,`version`,`id`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:17,939] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:17,939] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153117_update.py', 'models', 1]
[2025-09-18 15:31:17,940] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:17,943] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:17,943] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:18,743] [INFO] Started server process [43412]
[2025-09-18 15:31:18,743] [INFO] Waiting for application startup.
[2025-09-18 15:31:18,744] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:18,777] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:18,806] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x00000248E5E89190> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:18,806] [DEBUG] SELECT `id`,`content`,`app`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:18,808] [DEBUG] select version() as version: None
[2025-09-18 15:31:18,813] [DEBUG] SELECT `id`,`content`,`app`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:18,816] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:18,817] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153118_update.py', 'models', 1]
[2025-09-18 15:31:18,820] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:18,824] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:18,824] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:19,585] [INFO] Started server process [41496]
[2025-09-18 15:31:19,585] [INFO] Waiting for application startup.
[2025-09-18 15:31:19,587] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:19,611] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:19,636] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000002C54AAC91C0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:19,636] [DEBUG] SELECT `id`,`app`,`content`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:19,638] [DEBUG] select version() as version: None
[2025-09-18 15:31:19,642] [DEBUG] SELECT `id`,`app`,`content`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:19,643] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:19,644] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153119_update.py', 'models', 1]
[2025-09-18 15:31:19,647] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:19,650] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:19,652] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:20,412] [INFO] Started server process [23828]
[2025-09-18 15:31:20,412] [INFO] Waiting for application startup.
[2025-09-18 15:31:20,413] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:20,440] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:20,468] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000017802EB5A00> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:20,468] [DEBUG] SELECT `content`,`app`,`version`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:20,470] [DEBUG] select version() as version: None
[2025-09-18 15:31:20,475] [DEBUG] SELECT `content`,`app`,`version`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:20,477] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:20,478] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153120_update.py', 'models', 1]
[2025-09-18 15:31:20,482] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:20,485] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:20,486] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:21,308] [INFO] Started server process [6096]
[2025-09-18 15:31:21,308] [INFO] Waiting for application startup.
[2025-09-18 15:31:21,309] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:21,333] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:21,359] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000023D45BC4170> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:21,359] [DEBUG] SELECT `id`,`content`,`app`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:21,360] [DEBUG] select version() as version: None
[2025-09-18 15:31:21,365] [DEBUG] SELECT `id`,`content`,`app`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:21,368] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:21,369] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153121_update.py', 'models', 1]
[2025-09-18 15:31:21,372] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:21,376] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:21,378] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:22,153] [INFO] Started server process [39152]
[2025-09-18 15:31:22,154] [INFO] Waiting for application startup.
[2025-09-18 15:31:22,154] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:22,178] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:22,204] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000028D70CC10A0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:22,204] [DEBUG] SELECT `app`,`id`,`content`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:22,206] [DEBUG] select version() as version: None
[2025-09-18 15:31:22,211] [DEBUG] SELECT `app`,`id`,`content`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:22,213] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:22,214] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153122_update.py', 'models', 1]
[2025-09-18 15:31:22,219] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:22,222] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:22,223] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:23,004] [INFO] Started server process [24544]
[2025-09-18 15:31:23,004] [INFO] Waiting for application startup.
[2025-09-18 15:31:23,004] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:23,029] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:23,054] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000016A016D1220> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:23,054] [DEBUG] SELECT `app`,`id`,`version`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:23,056] [DEBUG] select version() as version: None
[2025-09-18 15:31:23,060] [DEBUG] SELECT `app`,`id`,`version`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:23,062] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:23,062] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153123_update.py', 'models', 1]
[2025-09-18 15:31:23,066] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:23,069] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:23,069] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:23,809] [INFO] Started server process [2192]
[2025-09-18 15:31:23,810] [INFO] Waiting for application startup.
[2025-09-18 15:31:23,810] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:23,840] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:23,868] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x00000266185D6D20> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:23,868] [DEBUG] SELECT `app`,`id`,`version`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:23,870] [DEBUG] select version() as version: None
[2025-09-18 15:31:23,874] [DEBUG] SELECT `app`,`id`,`version`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:23,876] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:23,877] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153123_update.py', 'models', 1]
[2025-09-18 15:31:23,877] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:23,880] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:23,880] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:24,648] [INFO] Started server process [4928]
[2025-09-18 15:31:24,648] [INFO] Waiting for application startup.
[2025-09-18 15:31:24,649] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:24,673] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:24,698] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000015F3778DEB0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:24,698] [DEBUG] SELECT `content`,`version`,`app`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:24,699] [DEBUG] select version() as version: None
[2025-09-18 15:31:24,704] [DEBUG] SELECT `content`,`version`,`app`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:24,705] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:24,706] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153124_update.py', 'models', 1]
[2025-09-18 15:31:24,709] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:24,712] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:24,712] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:25,457] [INFO] Started server process [29240]
[2025-09-18 15:31:25,457] [INFO] Waiting for application startup.
[2025-09-18 15:31:25,458] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:25,482] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:25,508] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000022675A44170> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:25,508] [DEBUG] SELECT `id`,`app`,`content`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:25,511] [DEBUG] select version() as version: None
[2025-09-18 15:31:25,516] [DEBUG] SELECT `id`,`app`,`content`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:25,517] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:25,518] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153125_update.py', 'models', 1]
[2025-09-18 15:31:25,521] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:25,524] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:25,526] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:26,269] [INFO] Started server process [32712]
[2025-09-18 15:31:26,269] [INFO] Waiting for application startup.
[2025-09-18 15:31:26,269] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:26,295] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:26,322] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x00000189B1BF4170> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:26,322] [DEBUG] SELECT `content`,`version`,`id`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:26,324] [DEBUG] select version() as version: None
[2025-09-18 15:31:26,328] [DEBUG] SELECT `content`,`version`,`id`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:26,329] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:26,331] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153126_update.py', 'models', 1]
[2025-09-18 15:31:26,335] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:26,339] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:26,340] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:27,117] [INFO] Started server process [24368]
[2025-09-18 15:31:27,117] [INFO] Waiting for application startup.
[2025-09-18 15:31:27,118] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:27,141] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:27,168] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000002062B7A5A00> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:27,168] [DEBUG] SELECT `content`,`id`,`version`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:27,171] [DEBUG] select version() as version: None
[2025-09-18 15:31:27,175] [DEBUG] SELECT `content`,`id`,`version`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:27,177] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:27,178] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153127_update.py', 'models', 1]
[2025-09-18 15:31:27,180] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:27,183] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:27,184] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:27,931] [INFO] Started server process [34072]
[2025-09-18 15:31:27,931] [INFO] Waiting for application startup.
[2025-09-18 15:31:27,931] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:27,959] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:27,984] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000002392F8D1460> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:27,984] [DEBUG] SELECT `id`,`content`,`version`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:27,986] [DEBUG] select version() as version: None
[2025-09-18 15:31:27,991] [DEBUG] SELECT `id`,`content`,`version`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:27,992] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:27,992] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153127_update.py', 'models', 1]
[2025-09-18 15:31:27,994] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:27,997] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:27,997] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:28,800] [INFO] Started server process [37068]
[2025-09-18 15:31:28,800] [INFO] Waiting for application startup.
[2025-09-18 15:31:28,800] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:28,826] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:28,851] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000013372649190> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:28,851] [DEBUG] SELECT `app`,`id`,`content`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:28,853] [DEBUG] select version() as version: None
[2025-09-18 15:31:28,857] [DEBUG] SELECT `app`,`id`,`content`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:28,859] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:28,860] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153128_update.py', 'models', 1]
[2025-09-18 15:31:28,864] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:28,867] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:28,868] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:29,615] [INFO] Started server process [38280]
[2025-09-18 15:31:29,615] [INFO] Waiting for application startup.
[2025-09-18 15:31:29,616] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:29,641] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:29,668] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000025983C513A0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:29,668] [DEBUG] SELECT `content`,`version`,`id`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:29,670] [DEBUG] select version() as version: None
[2025-09-18 15:31:29,676] [DEBUG] SELECT `content`,`version`,`id`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:29,677] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:29,678] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153129_update.py', 'models', 1]
[2025-09-18 15:31:29,681] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:29,684] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:29,684] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:30,516] [INFO] Started server process [41764]
[2025-09-18 15:31:30,516] [INFO] Waiting for application startup.
[2025-09-18 15:31:30,516] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:30,542] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:30,568] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x00000211684EC890> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:30,568] [DEBUG] SELECT `content`,`app`,`version`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:30,570] [DEBUG] select version() as version: None
[2025-09-18 15:31:30,575] [DEBUG] SELECT `content`,`app`,`version`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:30,576] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:30,576] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153130_update.py', 'models', 1]
[2025-09-18 15:31:30,581] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:30,585] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:30,586] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:31,405] [INFO] Started server process [39180]
[2025-09-18 15:31:31,405] [INFO] Waiting for application startup.
[2025-09-18 15:31:31,405] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:31,429] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:31,456] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000002EA96AC5A00> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:31,456] [DEBUG] SELECT `content`,`app`,`id`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:31,457] [DEBUG] select version() as version: None
[2025-09-18 15:31:31,462] [DEBUG] SELECT `content`,`app`,`id`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:31,464] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:31,465] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153131_update.py', 'models', 1]
[2025-09-18 15:31:31,468] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:31,472] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:31,472] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:32,192] [INFO] Started server process [30104]
[2025-09-18 15:31:32,192] [INFO] Waiting for application startup.
[2025-09-18 15:31:32,193] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:32,217] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:32,243] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000023C18325A00> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:32,243] [DEBUG] SELECT `id`,`content`,`version`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:32,245] [DEBUG] select version() as version: None
[2025-09-18 15:31:32,250] [DEBUG] SELECT `id`,`content`,`version`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:32,251] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:32,251] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153132_update.py', 'models', 1]
[2025-09-18 15:31:32,256] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:32,259] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:32,260] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:33,060] [INFO] Started server process [42260]
[2025-09-18 15:31:33,060] [INFO] Waiting for application startup.
[2025-09-18 15:31:33,060] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:33,089] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:33,114] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000019EF8BC5A00> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:33,114] [DEBUG] SELECT `app`,`id`,`version`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:33,116] [DEBUG] select version() as version: None
[2025-09-18 15:31:33,120] [DEBUG] SELECT `app`,`id`,`version`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:33,122] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:33,122] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153133_update.py', 'models', 1]
[2025-09-18 15:31:33,126] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:33,129] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:33,129] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:33,974] [INFO] Started server process [29876]
[2025-09-18 15:31:33,975] [INFO] Waiting for application startup.
[2025-09-18 15:31:33,975] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:34,004] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:34,033] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000002BBEB5ED3D0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:34,034] [DEBUG] SELECT `version`,`content`,`id`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:34,035] [DEBUG] select version() as version: None
[2025-09-18 15:31:34,041] [DEBUG] SELECT `version`,`content`,`id`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:34,043] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:34,043] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153134_update.py', 'models', 1]
[2025-09-18 15:31:34,047] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:34,051] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:34,051] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:34,940] [INFO] Started server process [38208]
[2025-09-18 15:31:34,940] [INFO] Waiting for application startup.
[2025-09-18 15:31:34,943] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:34,972] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:35,002] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001B6FB3D9190> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:35,002] [DEBUG] SELECT `id`,`content`,`version`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:35,004] [DEBUG] select version() as version: None
[2025-09-18 15:31:35,009] [DEBUG] SELECT `id`,`content`,`version`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:35,010] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:35,011] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153135_update.py', 'models', 1]
[2025-09-18 15:31:35,015] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:35,019] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:35,020] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:35,840] [INFO] Started server process [41300]
[2025-09-18 15:31:35,840] [INFO] Waiting for application startup.
[2025-09-18 15:31:35,840] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:35,867] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:35,894] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000002450B101040> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:35,895] [DEBUG] SELECT `content`,`app`,`version`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:35,896] [DEBUG] select version() as version: None
[2025-09-18 15:31:35,900] [DEBUG] SELECT `content`,`app`,`version`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:35,902] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:35,903] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153135_update.py', 'models', 1]
[2025-09-18 15:31:35,905] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:35,908] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:35,908] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:36,745] [INFO] Started server process [41228]
[2025-09-18 15:31:36,745] [INFO] Waiting for application startup.
[2025-09-18 15:31:36,746] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:36,774] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:36,801] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001D2A7C310A0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:36,801] [DEBUG] SELECT `id`,`content`,`app`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:36,803] [DEBUG] select version() as version: None
[2025-09-18 15:31:36,808] [DEBUG] SELECT `id`,`content`,`app`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:36,810] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:36,811] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153136_update.py', 'models', 1]
[2025-09-18 15:31:36,816] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:36,820] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:36,820] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:37,623] [INFO] Started server process [28412]
[2025-09-18 15:31:37,623] [INFO] Waiting for application startup.
[2025-09-18 15:31:37,623] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:37,650] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:37,679] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001C01C9F5A00> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:37,679] [DEBUG] SELECT `content`,`id`,`version`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:37,681] [DEBUG] select version() as version: None
[2025-09-18 15:31:37,686] [DEBUG] SELECT `content`,`id`,`version`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:37,687] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:37,689] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153137_update.py', 'models', 1]
[2025-09-18 15:31:37,692] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:37,696] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:37,698] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:38,522] [INFO] Started server process [43976]
[2025-09-18 15:31:38,522] [INFO] Waiting for application startup.
[2025-09-18 15:31:38,522] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:38,551] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:38,579] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000014876F64170> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:38,579] [DEBUG] SELECT `version`,`app`,`content`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:38,581] [DEBUG] select version() as version: None
[2025-09-18 15:31:38,587] [DEBUG] SELECT `version`,`app`,`content`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:31:38,589] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250910175646_init.py', 'models', 1]
[2025-09-18 15:31:38,590] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918153138_update.py', 'models', 1]
[2025-09-18 15:31:38,593] [DEBUG] 
        CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
        CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
        CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
        CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
        CREATE TABLE `env_component` (
    `component_id` INT NOT NULL REFERENCES `component` (`id`) ON DELETE CASCADE,
    `env_id` INT NOT NULL REFERENCES `env` (`id`) ON DELETE CASCADE
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:38,596] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 227, in execute_script
    await cursor.execute(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1824, "Failed to open the referenced table 'project'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 30, in init_db
    await command.upgrade(run_in_transaction=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 64, in upgrade
    await self._upgrade(conn, version_file)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 46, in _upgrade
    await conn.execute_script(await upgrade(conn))
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1824, "Failed to open the referenced table 'project'")

[2025-09-18 15:31:38,598] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:31:50,216] [INFO] Started server process [43988]
[2025-09-18 15:31:50,216] [INFO] Waiting for application startup.
[2025-09-18 15:31:50,216] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:31:50,238] [DEBUG] Creating schema: CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:50,246] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:31:50,270] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001FB1E7CE0C0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:31:50,270] [DEBUG] CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:31:50,368] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 226, in execute_script
    async with connection.cursor() as cursor:
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\utils.py", line 78, in __aexit__
    await self._obj.close()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 158, in close
    while (await self.nextset()):
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 191, in nextset
    await conn.next_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 473, in next_result
    await self._read_query_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 18, in init_db
    await command.init_db(safe=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 145, in init_db
    await generate_schema_for_client(connection, safe)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\utils.py", line 43, in generate_schema_for_client
    await generator.generate_from_string(schema)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\base\schema_generator.py", line 487, in generate_from_string
    await self.client.execute_script(creation_string)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

[2025-09-18 15:31:50,369] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:32:03,735] [INFO] Started server process [40048]
[2025-09-18 15:32:03,735] [INFO] Waiting for application startup.
[2025-09-18 15:32:03,736] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:32:03,761] [DEBUG] Creating schema: CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:32:03,774] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:32:03,809] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000021DD05F4140> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:32:03,809] [DEBUG] CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:32:03,827] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 226, in execute_script
    async with connection.cursor() as cursor:
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\utils.py", line 78, in __aexit__
    await self._obj.close()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 158, in close
    while (await self.nextset()):
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 191, in nextset
    await conn.next_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 473, in next_result
    await self._read_query_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 18, in init_db
    await command.init_db(safe=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 145, in init_db
    await generate_schema_for_client(connection, safe)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\utils.py", line 43, in generate_schema_for_client
    await generator.generate_from_string(schema)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\base\schema_generator.py", line 487, in generate_from_string
    await self.client.execute_script(creation_string)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

[2025-09-18 15:32:03,827] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:35:48,684] [INFO] Started server process [17824]
[2025-09-18 15:35:48,684] [INFO] Waiting for application startup.
[2025-09-18 15:35:48,685] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:35:48,704] [DEBUG] Creating schema: CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:35:48,713] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:35:48,736] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x00000134128D3E30> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:35:48,736] [DEBUG] CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_1e24aa8e` FOREIGN KEY (`user_id_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_8c764798` FOREIGN KEY (`env_id_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:35:49,048] [DEBUG] SELECT `app`,`content`,`id`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:35:49,051] [DEBUG] INSERT INTO `aerich` (`version`,`app`,`content`) VALUES (%s,%s,%s): ['0_20250918153549_init.py', 'models', '{"models.Component": {"name": "models.Component", "app": "models", "table": "component", "abstract": false, "description": "\\u7ec4\\u4ef6\\u8868", "docstring": "\\u7ec4\\u4ef6\\u8868", "unique_together": [], "indexes": [], "pk_field": {"name": "id", "field_type": "IntField", "db_column": "id", "python_type": "int", "generated": true, "nullable": false, "unique": true, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}, "data_fields": [{"name": "created_time", "field_type": "DatetimeField", "db_column": "created_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": false}, {"name": "updated_time", "field_type": "DatetimeField", "db_column": "updated_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": true}, {"name": "name", "field_type": "CharField", "db_column": "name", "python_type": "str", "generated": false, "nullable": false, "unique": true, "indexed": true, "default": null, "description": "\\u7ec4\\u4ef6\\u540d\\u79f0", "docstring": null, "constraints": {"max_length": 50}, "db_field_types": {"": "VARCHAR(50)"}}, {"name": "path", "field_type": "CharField", "db_column": "path", "python_type": "str", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u7ec4\\u4ef6\\u8def\\u5f84", "docstring": null, "constraints": {"max_length": 255}, "db_field_types": {"": "VARCHAR(255)"}}, {"name": "project_id", "field_type": "IntField", "db_column": "project_id", "python_type": "int", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u9879\\u76ee\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}], "fk_fields": [{"name": "project", "field_type": "ForeignKeyFieldInstance", "python_type": "models.Project", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u9879\\u76ee\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {}, "db_constraint": true, "raw_field": "project_id", "on_delete": "CASCADE"}], "backward_fk_fields": [{"name": "versions", "field_type": "BackwardFKRelation", "python_type": "models.ComponentVersion", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u7ec4\\u4ef6\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {}, "db_constraint": true}], "o2o_fields": [], "backward_o2o_fields": [], "m2m_fields": [{"name": "envs", "field_type": "ManyToManyFieldInstance", "python_type": "models.Env", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": null, "docstring": null, "constraints": {}, "db_constraint": true, "model_name": "models.Env", "related_name": "components_set", "forward_key": "env_id", "backward_key": "component_id", "through": "env_component", "on_delete": "CASCADE", "_generated": false}, {"name": "related_envs", "field_type": "ManyToManyFieldInstance", "python_type": "models.Env", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": null, "docstring": null, "constraints": {}, "db_constraint": true, "model_name": "models.Env", "related_name": "components", "forward_key": "env_id", "backward_key": "component_id", "through": "env_component", "on_delete": "CASCADE", "_generated": true}]}, "models.ComponentVersion": {"name": "models.ComponentVersion", "app": "models", "table": "component_version", "abstract": false, "description": "\\u7ec4\\u4ef6\\u7248\\u672c\\u8868", "docstring": "\\u7ec4\\u4ef6\\u7248\\u672c\\u8868", "unique_together": [], "indexes": [], "pk_field": {"name": "id", "field_type": "IntField", "db_column": "id", "python_type": "int", "generated": true, "nullable": false, "unique": true, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}, "data_fields": [{"name": "created_time", "field_type": "DatetimeField", "db_column": "created_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": false}, {"name": "updated_time", "field_type": "DatetimeField", "db_column": "updated_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": true}, {"name": "version", "field_type": "CharField", "db_column": "version", "python_type": "str", "generated": false, "nullable": false, "unique": true, "indexed": true, "default": null, "description": "\\u7248\\u672c\\u53f7", "docstring": null, "constraints": {"max_length": 50}, "db_field_types": {"": "VARCHAR(50)"}}, {"name": "component_id_id", "field_type": "IntField", "db_column": "component_id_id", "python_type": "int", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u7ec4\\u4ef6\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}, {"name": "env_id_id", "field_type": "IntField", "db_column": "env_id_id", "python_type": "int", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u73af\\u5883\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}], "fk_fields": [{"name": "component_id", "field_type": "ForeignKeyFieldInstance", "python_type": "models.Component", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u7ec4\\u4ef6\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {}, "db_constraint": true, "raw_field": "component_id_id", "on_delete": "CASCADE"}, {"name": "env_id", "field_type": "ForeignKeyFieldInstance", "python_type": "models.Env", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u73af\\u5883\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {}, "db_constraint": true, "raw_field": "env_id_id", "on_delete": "CASCADE"}], "backward_fk_fields": [], "o2o_fields": [], "backward_o2o_fields": [], "m2m_fields": []}, "models.Env": {"name": "models.Env", "app": "models", "table": "env", "abstract": false, "description": "\\u73af\\u5883\\u8868", "docstring": "\\u73af\\u5883\\u8868", "unique_together": [], "indexes": [], "pk_field": {"name": "id", "field_type": "IntField", "db_column": "id", "python_type": "int", "generated": true, "nullable": false, "unique": true, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}, "data_fields": [{"name": "created_time", "field_type": "DatetimeField", "db_column": "created_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": false}, {"name": "updated_time", "field_type": "DatetimeField", "db_column": "updated_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": true}, {"name": "name", "field_type": "CharField", "db_column": "name", "python_type": "str", "generated": false, "nullable": false, "unique": true, "indexed": true, "default": null, "description": "\\u73af\\u5883\\u540d\\u79f0", "docstring": null, "constraints": {"max_length": 50}, "db_field_types": {"": "VARCHAR(50)"}}, {"name": "domain", "field_type": "CharField", "db_column": "domain", "python_type": "str", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u73af\\u5883\\u57df\\u540d", "docstring": null, "constraints": {"max_length": 255}, "db_field_types": {"": "VARCHAR(255)"}}, {"name": "need_version", "field_type": "BooleanField", "db_column": "need_version", "python_type": "bool", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": false, "description": "\\u662f\\u5426\\u9700\\u8981\\u83b7\\u53d6\\u7248\\u672c\\u53f7", "docstring": null, "constraints": {}, "db_field_types": {"": "BOOL", "mssql": "BIT", "oracle": "NUMBER(1)", "sqlite": "INT"}}, {"name": "desc", "field_type": "CharField", "db_column": "desc", "python_type": "str", "generated": false, "nullable": true, "unique": false, "indexed": false, "default": null, "description": "\\u73af\\u5883\\u63cf\\u8ff0", "docstring": null, "constraints": {"max_length": 255}, "db_field_types": {"": "VARCHAR(255)"}}, {"name": "project_id", "field_type": "IntField", "db_column": "project_id", "python_type": "int", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u9879\\u76ee\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}, {"name": "user_id_id", "field_type": "IntField", "db_column": "user_id_id", "python_type": "int", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u7528\\u6237\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}], "fk_fields": [{"name": "user_id", "field_type": "ForeignKeyFieldInstance", "python_type": "models.User", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u7528\\u6237\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {}, "db_constraint": true, "raw_field": "user_id_id", "on_delete": "CASCADE"}, {"name": "project", "field_type": "ForeignKeyFieldInstance", "python_type": "models.Project", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u9879\\u76ee\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {}, "db_constraint": true, "raw_field": "project_id", "on_delete": "CASCADE"}], "backward_fk_fields": [{"name": "versions", "field_type": "BackwardFKRelation", "python_type": "models.ComponentVersion", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u73af\\u5883\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {}, "db_constraint": true}], "o2o_fields": [], "backward_o2o_fields": [], "m2m_fields": [{"name": "components", "field_type": "ManyToManyFieldInstance", "python_type": "models.Component", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": null, "docstring": null, "constraints": {}, "db_constraint": true, "model_name": "models.Component", "related_name": "related_envs", "forward_key": "component_id", "backward_key": "env_id", "through": "env_component", "on_delete": "CASCADE", "_generated": false}, {"name": "components_set", "field_type": "ManyToManyFieldInstance", "python_type": "models.Component", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": null, "docstring": null, "constraints": {}, "db_constraint": true, "model_name": "models.Component", "related_name": "envs", "forward_key": "component_id", "backward_key": "env_id", "through": "env_component", "on_delete": "CASCADE", "_generated": true}]}, "models.Menu": {"name": "models.Menu", "app": "models", "table": "menu", "abstract": false, "description": "\\u83dc\\u5355\\u6a21\\u578b\\uff08\\u652f\\u6301\\u6811\\u5f62\\u7ed3\\u6784 + \\u89d2\\u8272\\u6743\\u9650\\u63a7\\u5236\\uff09", "docstring": "\\u83dc\\u5355\\u6a21\\u578b\\uff08\\u652f\\u6301\\u6811\\u5f62\\u7ed3\\u6784 + \\u89d2\\u8272\\u6743\\u9650\\u63a7\\u5236\\uff09", "unique_together": [], "indexes": [], "pk_field": {"name": "id", "field_type": "IntField", "db_column": "id", "python_type": "int", "generated": true, "nullable": false, "unique": true, "indexed": true, "default": null, "description": "\\u83dc\\u5355\\u552f\\u4e00\\u6807\\u8bc6", "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}, "data_fields": [{"name": "created_time", "field_type": "DatetimeField", "db_column": "created_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": false}, {"name": "updated_time", "field_type": "DatetimeField", "db_column": "updated_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": true}, {"name": "label", "field_type": "CharField", "db_column": "label", "python_type": "str", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": "\\u83dc\\u5355\\u540d\\u79f0\\uff08\\u5e26\\u7d22\\u5f15\\uff0c\\u5feb\\u901f\\u67e5\\u8be2\\uff09", "docstring": null, "constraints": {"max_length": 50}, "db_field_types": {"": "VARCHAR(50)"}}, {"name": "path", "field_type": "CharField", "db_column": "path", "python_type": "str", "generated": false, "nullable": true, "unique": false, "indexed": false, "default": null, "description": "\\u83dc\\u5355\\u8def\\u7531\\u5730\\u5740\\uff08\\u53ef\\u4e3a\\u7a7a\\uff0c\\u5982\\u6309\\u94ae\\u65e0\\u8def\\u7531\\uff09", "docstring": null, "constraints": {"max_length": 255}, "db_field_types": {"": "VARCHAR(255)"}}, {"name": "icon", "field_type": "CharField", "db_column": "icon", "python_type": "str", "generated": false, "nullable": true, "unique": false, "indexed": false, "default": null, "description": "\\u83dc\\u5355\\u56fe\\u6807\\uff08\\u652f\\u6301l\\u56fe\\u6807\\u5e93\\u7c7b\\u540d\\u6216SVG\\u8def\\u5f84\\uff09", "docstring": null, "constraints": {"max_length": 100}, "db_field_types": {"": "VARCHAR(100)"}}, {"name": "parent_id", "field_type": "IntField", "db_column": "parent_id", "python_type": "int", "generated": false, "nullable": true, "unique": false, "indexed": false, "default": null, "description": "\\u7236\\u83dc\\u5355\\uff08\\u5173\\u8054\\u81ea\\u8eab\\uff0c\\u652f\\u6301\\u9012\\u5f52\\u67e5\\u8be2\\uff09", "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}], "fk_fields": [{"name": "parent", "field_type": "ForeignKeyFieldInstance", "python_type": "models.Menu", "generated": false, "nullable": true, "unique": false, "indexed": false, "default": null, "description": "\\u7236\\u83dc\\u5355\\uff08\\u5173\\u8054\\u81ea\\u8eab\\uff0c\\u652f\\u6301\\u9012\\u5f52\\u67e5\\u8be2\\uff09", "docstring": null, "constraints": {}, "db_constraint": true, "raw_field": "parent_id", "on_delete": "SET NULL"}], "backward_fk_fields": [{"name": "children", "field_type": "BackwardFKRelation", "python_type": "models.Menu", "generated": false, "nullable": true, "unique": false, "indexed": false, "default": null, "description": "\\u7236\\u83dc\\u5355\\uff08\\u5173\\u8054\\u81ea\\u8eab\\uff0c\\u652f\\u6301\\u9012\\u5f52\\u67e5\\u8be2\\uff09", "docstring": null, "constraints": {}, "db_constraint": true}], "o2o_fields": [], "backward_o2o_fields": [], "m2m_fields": [{"name": "role_menus", "field_type": "ManyToManyFieldInstance", "python_type": "models.Role", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": null, "docstring": null, "constraints": {}, "db_constraint": true, "model_name": "models.Role", "related_name": "menus", "forward_key": "role_id", "backward_key": "menu_id", "through": "role_menu", "on_delete": "CASCADE", "_generated": true}]}, "models.Project": {"name": "models.Project", "app": "models", "table": "project", "abstract": false, "description": "\\u9879\\u76ee\\u8868", "docstring": "\\u9879\\u76ee\\u8868", "unique_together": [], "indexes": [], "pk_field": {"name": "id", "field_type": "IntField", "db_column": "id", "python_type": "int", "generated": true, "nullable": false, "unique": true, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}, "data_fields": [{"name": "created_time", "field_type": "DatetimeField", "db_column": "created_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": false}, {"name": "updated_time", "field_type": "DatetimeField", "db_column": "updated_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": true}, {"name": "name", "field_type": "CharField", "db_column": "name", "python_type": "str", "generated": false, "nullable": false, "unique": true, "indexed": true, "default": null, "description": "\\u9879\\u76ee\\u540d\\u79f0", "docstring": null, "constraints": {"max_length": 50}, "db_field_types": {"": "VARCHAR(50)"}}, {"name": "desc", "field_type": "CharField", "db_column": "desc", "python_type": "str", "generated": false, "nullable": true, "unique": false, "indexed": false, "default": null, "description": "\\u9879\\u76ee\\u63cf\\u8ff0", "docstring": null, "constraints": {"max_length": 255}, "db_field_types": {"": "VARCHAR(255)"}}], "fk_fields": [], "backward_fk_fields": [{"name": "components", "field_type": "BackwardFKRelation", "python_type": "models.Component", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u9879\\u76ee\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {}, "db_constraint": true}, {"name": "envs", "field_type": "BackwardFKRelation", "python_type": "models.Env", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u9879\\u76ee\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {}, "db_constraint": true}], "o2o_fields": [], "backward_o2o_fields": [], "m2m_fields": []}, "models.Role": {"name": "models.Role", "app": "models", "table": "role", "abstract": false, "description": "\\u89d2\\u8272\\u6a21\\u578b", "docstring": "\\u89d2\\u8272\\u6a21\\u578b\\n\\u7528\\u4e8e\\u5b9a\\u4e49\\u7528\\u6237\\u6743\\u9650\\u96c6\\u5408", "unique_together": [], "indexes": [], "pk_field": {"name": "id", "field_type": "IntField", "db_column": "id", "python_type": "int", "generated": true, "nullable": false, "unique": true, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}, "data_fields": [{"name": "created_time", "field_type": "DatetimeField", "db_column": "created_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": false}, {"name": "updated_time", "field_type": "DatetimeField", "db_column": "updated_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": true}, {"name": "name", "field_type": "CharField", "db_column": "name", "python_type": "str", "generated": false, "nullable": false, "unique": true, "indexed": true, "default": null, "description": "\\u89d2\\u8272\\u540d\\u79f0", "docstring": null, "constraints": {"max_length": 50}, "db_field_types": {"": "VARCHAR(50)"}}, {"name": "desc", "field_type": "CharField", "db_column": "desc", "python_type": "str", "generated": false, "nullable": false, "unique": true, "indexed": true, "default": null, "description": "\\u89d2\\u8272\\u63cf\\u8ff0", "docstring": null, "constraints": {"max_length": 50}, "db_field_types": {"": "VARCHAR(50)"}}], "fk_fields": [], "backward_fk_fields": [{"name": "users", "field_type": "BackwardFKRelation", "python_type": "models.User", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u89d2\\u8272", "docstring": null, "constraints": {}, "db_constraint": true}], "o2o_fields": [], "backward_o2o_fields": [], "m2m_fields": [{"name": "menus", "field_type": "ManyToManyFieldInstance", "python_type": "models.Menu", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": null, "docstring": null, "constraints": {}, "db_constraint": true, "model_name": "models.Menu", "related_name": "role_menus", "forward_key": "menu_id", "backward_key": "role_id", "through": "role_menu", "on_delete": "CASCADE", "_generated": false}]}, "models.User": {"name": "models.User", "app": "models", "table": "user", "abstract": false, "description": "\\u7528\\u6237\\u6a21\\u578b", "docstring": "\\u7528\\u6237\\u6a21\\u578b\\n\\u5305\\u542b\\u57fa\\u672c\\u7528\\u6237\\u4fe1\\u606f\\u548c\\u8ba4\\u8bc1\\u76f8\\u5173\\u5b57\\u6bb5", "unique_together": [], "indexes": [{"type": "index", "val": "gASVigAAAAAAAACMEHRvcnRvaXNlLmluZGV4ZXOUjAVJbmRleJSTlCmBlH2UKIwGZmllbGRzlF2UKIwJaXNfYWN0aXZllIwPbGFzdF9sb2dpbl90aW1llGWMBG5hbWWUjBVpZHhfYWN0aXZlX3VzZXJfbG9naW6UjAtleHByZXNzaW9uc5QpjAVleHRyYZSMAJR1Yi4="}, {"type": "index", "val": "gASVbQAAAAAAAACMEHRvcnRvaXNlLmluZGV4ZXOUjAVJbmRleJSTlCmBlH2UKIwGZmllbGRzlF2UjAh1c2VybmFtZZRhjARuYW1llIwMaWR4X3VzZXJuYW1llIwLZXhwcmVzc2lvbnOUKYwFZXh0cmGUjACUdWIu"}], "pk_field": {"name": "id", "field_type": "IntField", "db_column": "id", "python_type": "int", "generated": true, "nullable": false, "unique": true, "indexed": true, "default": null, "description": "\\u7528\\u6237\\u552f\\u4e00\\u6807\\u8bc6", "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}, "data_fields": [{"name": "created_time", "field_type": "DatetimeField", "db_column": "created_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": false}, {"name": "updated_time", "field_type": "DatetimeField", "db_column": "updated_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": true}, {"name": "username", "field_type": "CharField", "db_column": "username", "python_type": "str", "generated": false, "nullable": false, "unique": true, "indexed": true, "default": null, "description": "\\u7528\\u6237\\u540d", "docstring": null, "constraints": {"max_length": 50}, "db_field_types": {"": "VARCHAR(50)"}}, {"name": "_password", "field_type": "CharField", "db_column": "_password", "python_type": "str", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5bc6\\u7801\\u54c8\\u5e0c\\u503c", "docstring": null, "constraints": {"max_length": 255}, "db_field_types": {"": "VARCHAR(255)"}}, {"name": "is_active", "field_type": "BooleanField", "db_column": "is_active", "python_type": "bool", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": true, "description": "\\u8d26\\u53f7\\u6fc0\\u6d3b\\u72b6\\u6001", "docstring": null, "constraints": {}, "db_field_types": {"": "BOOL", "mssql": "BIT", "oracle": "NUMBER(1)", "sqlite": "INT"}}, {"name": "is_delete", "field_type": "BooleanField", "db_column": "is_delete", "python_type": "bool", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": false, "description": "\\u8d26\\u53f7\\u662f\\u5426\\u5220\\u9664", "docstring": null, "constraints": {}, "db_field_types": {"": "BOOL", "mssql": "BIT", "oracle": "NUMBER(1)", "sqlite": "INT"}}, {"name": "last_login_time", "field_type": "DatetimeField", "db_column": "last_login_time", "python_type": "datetime.datetime", "generated": false, "nullable": true, "unique": false, "indexed": true, "default": null, "description": "\\u6700\\u540e\\u767b\\u5f55\\u65f6\\u95f4", "docstring": null, "constraints": {}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": false, "auto_now": false}, {"name": "role_id", "field_type": "IntField", "db_column": "role_id", "python_type": "int", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u89d2\\u8272", "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}], "fk_fields": [{"name": "role", "field_type": "ForeignKeyFieldInstance", "python_type": "models.Role", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u89d2\\u8272", "docstring": null, "constraints": {}, "db_constraint": true, "raw_field": "role_id", "on_delete": "CASCADE"}], "backward_fk_fields": [{"name": "envs", "field_type": "BackwardFKRelation", "python_type": "models.Env", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u7528\\u6237\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {}, "db_constraint": true}], "o2o_fields": [], "backward_o2o_fields": [], "m2m_fields": []}, "models.Aerich": {"name": "models.Aerich", "app": "models", "table": "aerich", "abstract": false, "description": null, "docstring": null, "unique_together": [], "indexes": [], "pk_field": {"name": "id", "field_type": "IntField", "db_column": "id", "python_type": "int", "generated": true, "nullable": false, "unique": true, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}, "data_fields": [{"name": "version", "field_type": "CharField", "db_column": "version", "python_type": "str", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": null, "docstring": null, "constraints": {"max_length": 255}, "db_field_types": {"": "VARCHAR(255)"}}, {"name": "app", "field_type": "CharField", "db_column": "app", "python_type": "str", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": null, "docstring": null, "constraints": {"max_length": 100}, "db_field_types": {"": "VARCHAR(100)"}}, {"name": "content", "field_type": "JSONField", "db_column": "content", "python_type": "Union[dict, list]", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": null, "docstring": null, "constraints": {}, "db_field_types": {"": "JSON", "mssql": "NVARCHAR(MAX)", "oracle": "NCLOB", "postgres": "JSONB"}}], "fk_fields": [], "backward_fk_fields": [], "o2o_fields": [], "backward_o2o_fields": [], "m2m_fields": []}}']
[2025-09-18 15:35:49,064] [DEBUG] Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:35:49,064] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:35:49,067] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:35:49,067] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000013412EF0CB0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:35:49,067] [DEBUG] SELECT `app`,`content`,`id`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:35:49,069] [DEBUG] select version() as version: None
[2025-09-18 15:35:49,073] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 24, in init_db
    await command.migrate()
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 130, in migrate
    return await Migrate.migrate(name, empty)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 157, in migrate
    cls.diff_models(last_version, new_version_content)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 413, in diff_models
    cls._handle_m2m_fields(
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 249, in _handle_m2m_fields
    if (option and option[-1] == "nullable") or change[0][0] == "db_constraint":
                                                ~~~~~~~~~^^^
TypeError: 'bool' object is not subscriptable

[2025-09-18 15:35:49,073] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:35:49,876] [INFO] Started server process [39724]
[2025-09-18 15:35:49,876] [INFO] Waiting for application startup.
[2025-09-18 15:35:49,877] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:35:49,902] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:35:49,928] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x00000169125B4170> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:35:49,928] [DEBUG] SELECT `content`,`app`,`version`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:35:49,930] [DEBUG] select version() as version: None
[2025-09-18 15:35:49,933] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 24, in init_db
    await command.migrate()
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 130, in migrate
    return await Migrate.migrate(name, empty)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 157, in migrate
    cls.diff_models(last_version, new_version_content)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 413, in diff_models
    cls._handle_m2m_fields(
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 249, in _handle_m2m_fields
    if (option and option[-1] == "nullable") or change[0][0] == "db_constraint":
                                                ~~~~~~~~~^^^
TypeError: 'bool' object is not subscriptable

[2025-09-18 15:35:49,933] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:37:18,010] [INFO] Started server process [30228]
[2025-09-18 15:37:18,011] [INFO] Waiting for application startup.
[2025-09-18 15:37:18,011] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:37:18,039] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:37:18,065] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000018AFFCA4170> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:37:18,065] [DEBUG] SELECT `id`,`content`,`app`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:37:18,068] [DEBUG] select version() as version: None
[2025-09-18 15:37:18,071] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 24, in init_db
    await command.migrate()
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 130, in migrate
    return await Migrate.migrate(name, empty)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 157, in migrate
    cls.diff_models(last_version, new_version_content)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 413, in diff_models
    cls._handle_m2m_fields(
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 249, in _handle_m2m_fields
    if (option and option[-1] == "nullable") or change[0][0] == "db_constraint":
                                                ~~~~~~~~~^^^
TypeError: 'bool' object is not subscriptable

[2025-09-18 15:37:18,071] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:37:56,351] [INFO] Started server process [40244]
[2025-09-18 15:37:56,351] [INFO] Waiting for application startup.
[2025-09-18 15:37:56,352] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:37:56,379] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:37:56,408] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x00000258F9B892E0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:37:56,408] [DEBUG] SELECT `app`,`version`,`id`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:37:56,410] [DEBUG] select version() as version: None
[2025-09-18 15:37:56,414] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 24, in init_db
    await command.migrate()
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 130, in migrate
    return await Migrate.migrate(name, empty)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 157, in migrate
    cls.diff_models(last_version, new_version_content)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 413, in diff_models
    cls._handle_m2m_fields(
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 249, in _handle_m2m_fields
    if (option and option[-1] == "nullable") or change[0][0] == "db_constraint":
                                                ~~~~~~~~~^^^
TypeError: 'bool' object is not subscriptable

[2025-09-18 15:37:56,414] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:41:20,722] [INFO] Started server process [43660]
[2025-09-18 15:41:20,722] [INFO] Waiting for application startup.
[2025-09-18 15:41:20,722] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:41:20,750] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:41:20,777] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x00000236FEF71430> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:41:20,777] [DEBUG] SELECT `version`,`id`,`app`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:41:20,779] [DEBUG] select version() as version: None
[2025-09-18 15:41:20,783] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 24, in init_db
    await command.migrate()
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 130, in migrate
    return await Migrate.migrate(name, empty)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 157, in migrate
    cls.diff_models(last_version, new_version_content)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 413, in diff_models
    cls._handle_m2m_fields(
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 249, in _handle_m2m_fields
    if (option and option[-1] == "nullable") or change[0][0] == "db_constraint":
                                                ~~~~~~~~~^^^
TypeError: 'bool' object is not subscriptable

[2025-09-18 15:41:20,783] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:42:56,724] [INFO] Started server process [43912]
[2025-09-18 15:42:56,724] [INFO] Waiting for application startup.
[2025-09-18 15:42:56,724] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:42:56,748] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:42:56,772] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x00000191713E1400> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:42:56,772] [DEBUG] SELECT `version`,`id`,`content`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:42:56,774] [DEBUG] select version() as version: None
[2025-09-18 15:42:56,777] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 24, in init_db
    await command.migrate()
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 130, in migrate
    return await Migrate.migrate(name, empty)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 157, in migrate
    cls.diff_models(last_version, new_version_content)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 413, in diff_models
    cls._handle_m2m_fields(
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 249, in _handle_m2m_fields
    if (option and option[-1] == "nullable") or change[0][0] == "db_constraint":
                                                ~~~~~~~~~^^^
TypeError: 'bool' object is not subscriptable

[2025-09-18 15:42:56,777] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:43:17,142] [DEBUG] Using proactor: IocpProactor
[2025-09-18 15:43:17,143] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:43:17,171] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:43:17,198] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001D879DBE9F0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:43:17,198] [DEBUG] SELECT `version`,`id`,`content`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:43:17,201] [DEBUG] select version() as version: None
[2025-09-18 15:43:47,619] [INFO] Started server process [33560]
[2025-09-18 15:43:47,620] [INFO] Waiting for application startup.
[2025-09-18 15:43:47,621] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:43:47,654] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:43:47,681] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001FB42B21730> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:43:47,681] [DEBUG] SELECT `id`,`content`,`version`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:43:47,683] [DEBUG] select version() as version: None
[2025-09-18 15:43:47,687] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 24, in init_db
    await command.migrate()
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 130, in migrate
    return await Migrate.migrate(name, empty)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 157, in migrate
    cls.diff_models(last_version, new_version_content)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 413, in diff_models
    cls._handle_m2m_fields(
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 249, in _handle_m2m_fields
    if (option and option[-1] == "nullable") or change[0][0] == "db_constraint":
                                                ~~~~~~~~~^^^
TypeError: 'bool' object is not subscriptable

[2025-09-18 15:43:47,687] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:44:20,841] [INFO] Started server process [44224]
[2025-09-18 15:44:20,841] [INFO] Waiting for application startup.
[2025-09-18 15:44:20,841] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:44:20,867] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:44:20,893] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001560D291520> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:44:20,893] [DEBUG] SELECT `app`,`version`,`id`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:44:20,895] [DEBUG] select version() as version: None
[2025-09-18 15:44:20,899] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 24, in init_db
    await command.migrate()
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 130, in migrate
    return await Migrate.migrate(name, empty)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 157, in migrate
    cls.diff_models(last_version, new_version_content)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 413, in diff_models
    cls._handle_m2m_fields(
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 249, in _handle_m2m_fields
    if (option and option[-1] == "nullable") or change[0][0] == "db_constraint":
                                                ~~~~~~~~~^^^
TypeError: 'bool' object is not subscriptable

[2025-09-18 15:44:20,899] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:46:10,062] [INFO] Started server process [23092]
[2025-09-18 15:46:10,063] [INFO] Waiting for application startup.
[2025-09-18 15:46:10,063] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:46:10,089] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:46:10,113] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000026374B892E0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:46:10,113] [DEBUG] SELECT `content`,`app`,`version`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:46:10,114] [DEBUG] select version() as version: None
[2025-09-18 15:46:10,118] [ERROR] Traceback (most recent call last):
  File "E:\web_platform\background\app\core\init_app.py", line 24, in init_db
    await command.migrate()
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 130, in migrate
    return await Migrate.migrate(name, empty)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 157, in migrate
    cls.diff_models(last_version, new_version_content)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 363, in diff_models
    old_models.pop(_aerich, None)
    ^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'pop'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 26, in init_db
    logger.warning("unable to retrieve model history from database, model history will be created from scratch")
    ^^^^^^^^^^^^^^
AttributeError: 'Log' object has no attribute 'warning'

[2025-09-18 15:46:10,118] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:46:31,271] [INFO] Started server process [27308]
[2025-09-18 15:46:31,272] [INFO] Waiting for application startup.
[2025-09-18 15:46:31,272] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:46:31,298] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:46:31,322] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000002D192CF5370> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:46:31,323] [DEBUG] SELECT `version`,`app`,`id`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:46:31,324] [DEBUG] select version() as version: None
[2025-09-18 15:46:31,326] [WARNING] unable to retrieve model history from database, model history will be created from scratch
[2025-09-18 15:46:31,327] [DEBUG] Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:46:31,327] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:46:31,329] [DEBUG] Creating schema: CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:46:31,359] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:46:31,360] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000002D1928FD070> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:46:31,360] [DEBUG] CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:46:31,653] [DEBUG] SELECT `version`,`app`,`id`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:46:31,655] [DEBUG] INSERT INTO `aerich` (`version`,`app`,`content`) VALUES (%s,%s,%s): ['0_20250918154631_init.py', 'models', '{"models.Component": {"name": "models.Component", "app": "models", "table": "component", "abstract": false, "description": "\\u7ec4\\u4ef6\\u8868", "docstring": "\\u7ec4\\u4ef6\\u8868", "unique_together": [], "indexes": [], "pk_field": {"name": "id", "field_type": "IntField", "db_column": "id", "python_type": "int", "generated": true, "nullable": false, "unique": true, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}, "data_fields": [{"name": "created_time", "field_type": "DatetimeField", "db_column": "created_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": false}, {"name": "updated_time", "field_type": "DatetimeField", "db_column": "updated_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": true}, {"name": "name", "field_type": "CharField", "db_column": "name", "python_type": "str", "generated": false, "nullable": false, "unique": true, "indexed": true, "default": null, "description": "\\u7ec4\\u4ef6\\u540d\\u79f0", "docstring": null, "constraints": {"max_length": 50}, "db_field_types": {"": "VARCHAR(50)"}}, {"name": "path", "field_type": "CharField", "db_column": "path", "python_type": "str", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u7ec4\\u4ef6\\u8def\\u5f84", "docstring": null, "constraints": {"max_length": 255}, "db_field_types": {"": "VARCHAR(255)"}}, {"name": "project_id", "field_type": "IntField", "db_column": "project_id", "python_type": "int", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u9879\\u76ee\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}], "fk_fields": [{"name": "project", "field_type": "ForeignKeyFieldInstance", "python_type": "models.Project", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u9879\\u76ee\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {}, "db_constraint": true, "raw_field": "project_id", "on_delete": "CASCADE"}], "backward_fk_fields": [{"name": "versions", "field_type": "BackwardFKRelation", "python_type": "models.ComponentVersion", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u7ec4\\u4ef6\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {}, "db_constraint": true}], "o2o_fields": [], "backward_o2o_fields": [], "m2m_fields": [{"name": "envs", "field_type": "ManyToManyFieldInstance", "python_type": "models.Env", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": null, "docstring": null, "constraints": {}, "db_constraint": true, "model_name": "models.Env", "related_name": "components_set", "forward_key": "env_id", "backward_key": "component_id", "through": "env_component", "on_delete": "CASCADE", "_generated": false}, {"name": "related_envs", "field_type": "ManyToManyFieldInstance", "python_type": "models.Env", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": null, "docstring": null, "constraints": {}, "db_constraint": true, "model_name": "models.Env", "related_name": "components", "forward_key": "env_id", "backward_key": "component_id", "through": "env_component", "on_delete": "CASCADE", "_generated": true}]}, "models.ComponentVersion": {"name": "models.ComponentVersion", "app": "models", "table": "component_version", "abstract": false, "description": "\\u7ec4\\u4ef6\\u7248\\u672c\\u8868", "docstring": "\\u7ec4\\u4ef6\\u7248\\u672c\\u8868", "unique_together": [], "indexes": [], "pk_field": {"name": "id", "field_type": "IntField", "db_column": "id", "python_type": "int", "generated": true, "nullable": false, "unique": true, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}, "data_fields": [{"name": "created_time", "field_type": "DatetimeField", "db_column": "created_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": false}, {"name": "updated_time", "field_type": "DatetimeField", "db_column": "updated_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": true}, {"name": "version", "field_type": "CharField", "db_column": "version", "python_type": "str", "generated": false, "nullable": false, "unique": true, "indexed": true, "default": null, "description": "\\u7248\\u672c\\u53f7", "docstring": null, "constraints": {"max_length": 50}, "db_field_types": {"": "VARCHAR(50)"}}, {"name": "component_id_id", "field_type": "IntField", "db_column": "component_id_id", "python_type": "int", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u7ec4\\u4ef6\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}, {"name": "env_id", "field_type": "IntField", "db_column": "env_id", "python_type": "int", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u73af\\u5883\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}], "fk_fields": [{"name": "component_id", "field_type": "ForeignKeyFieldInstance", "python_type": "models.Component", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u7ec4\\u4ef6\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {}, "db_constraint": true, "raw_field": "component_id_id", "on_delete": "CASCADE"}, {"name": "env", "field_type": "ForeignKeyFieldInstance", "python_type": "models.Env", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u73af\\u5883\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {}, "db_constraint": true, "raw_field": "env_id", "on_delete": "CASCADE"}], "backward_fk_fields": [], "o2o_fields": [], "backward_o2o_fields": [], "m2m_fields": []}, "models.Env": {"name": "models.Env", "app": "models", "table": "env", "abstract": false, "description": "\\u73af\\u5883\\u8868", "docstring": "\\u73af\\u5883\\u8868", "unique_together": [], "indexes": [], "pk_field": {"name": "id", "field_type": "IntField", "db_column": "id", "python_type": "int", "generated": true, "nullable": false, "unique": true, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}, "data_fields": [{"name": "created_time", "field_type": "DatetimeField", "db_column": "created_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": false}, {"name": "updated_time", "field_type": "DatetimeField", "db_column": "updated_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": true}, {"name": "name", "field_type": "CharField", "db_column": "name", "python_type": "str", "generated": false, "nullable": false, "unique": true, "indexed": true, "default": null, "description": "\\u73af\\u5883\\u540d\\u79f0", "docstring": null, "constraints": {"max_length": 50}, "db_field_types": {"": "VARCHAR(50)"}}, {"name": "domain", "field_type": "CharField", "db_column": "domain", "python_type": "str", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u73af\\u5883\\u57df\\u540d", "docstring": null, "constraints": {"max_length": 255}, "db_field_types": {"": "VARCHAR(255)"}}, {"name": "need_version", "field_type": "BooleanField", "db_column": "need_version", "python_type": "bool", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": false, "description": "\\u662f\\u5426\\u9700\\u8981\\u83b7\\u53d6\\u7248\\u672c\\u53f7", "docstring": null, "constraints": {}, "db_field_types": {"": "BOOL", "mssql": "BIT", "oracle": "NUMBER(1)", "sqlite": "INT"}}, {"name": "desc", "field_type": "CharField", "db_column": "desc", "python_type": "str", "generated": false, "nullable": true, "unique": false, "indexed": false, "default": null, "description": "\\u73af\\u5883\\u63cf\\u8ff0", "docstring": null, "constraints": {"max_length": 255}, "db_field_types": {"": "VARCHAR(255)"}}, {"name": "project_id", "field_type": "IntField", "db_column": "project_id", "python_type": "int", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u9879\\u76ee\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}, {"name": "user_id", "field_type": "IntField", "db_column": "user_id", "python_type": "int", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u7528\\u6237\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}], "fk_fields": [{"name": "user", "field_type": "ForeignKeyFieldInstance", "python_type": "models.User", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u7528\\u6237\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {}, "db_constraint": true, "raw_field": "user_id", "on_delete": "CASCADE"}, {"name": "project", "field_type": "ForeignKeyFieldInstance", "python_type": "models.Project", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u9879\\u76ee\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {}, "db_constraint": true, "raw_field": "project_id", "on_delete": "CASCADE"}], "backward_fk_fields": [{"name": "versions", "field_type": "BackwardFKRelation", "python_type": "models.ComponentVersion", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u73af\\u5883\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {}, "db_constraint": true}], "o2o_fields": [], "backward_o2o_fields": [], "m2m_fields": [{"name": "components", "field_type": "ManyToManyFieldInstance", "python_type": "models.Component", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": null, "docstring": null, "constraints": {}, "db_constraint": true, "model_name": "models.Component", "related_name": "related_envs", "forward_key": "component_id", "backward_key": "env_id", "through": "env_component", "on_delete": "CASCADE", "_generated": false}, {"name": "components_set", "field_type": "ManyToManyFieldInstance", "python_type": "models.Component", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": null, "docstring": null, "constraints": {}, "db_constraint": true, "model_name": "models.Component", "related_name": "envs", "forward_key": "component_id", "backward_key": "env_id", "through": "env_component", "on_delete": "CASCADE", "_generated": true}]}, "models.Menu": {"name": "models.Menu", "app": "models", "table": "menu", "abstract": false, "description": "\\u83dc\\u5355\\u6a21\\u578b\\uff08\\u652f\\u6301\\u6811\\u5f62\\u7ed3\\u6784 + \\u89d2\\u8272\\u6743\\u9650\\u63a7\\u5236\\uff09", "docstring": "\\u83dc\\u5355\\u6a21\\u578b\\uff08\\u652f\\u6301\\u6811\\u5f62\\u7ed3\\u6784 + \\u89d2\\u8272\\u6743\\u9650\\u63a7\\u5236\\uff09", "unique_together": [], "indexes": [], "pk_field": {"name": "id", "field_type": "IntField", "db_column": "id", "python_type": "int", "generated": true, "nullable": false, "unique": true, "indexed": true, "default": null, "description": "\\u83dc\\u5355\\u552f\\u4e00\\u6807\\u8bc6", "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}, "data_fields": [{"name": "created_time", "field_type": "DatetimeField", "db_column": "created_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": false}, {"name": "updated_time", "field_type": "DatetimeField", "db_column": "updated_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": true}, {"name": "label", "field_type": "CharField", "db_column": "label", "python_type": "str", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": "\\u83dc\\u5355\\u540d\\u79f0\\uff08\\u5e26\\u7d22\\u5f15\\uff0c\\u5feb\\u901f\\u67e5\\u8be2\\uff09", "docstring": null, "constraints": {"max_length": 50}, "db_field_types": {"": "VARCHAR(50)"}}, {"name": "path", "field_type": "CharField", "db_column": "path", "python_type": "str", "generated": false, "nullable": true, "unique": false, "indexed": false, "default": null, "description": "\\u83dc\\u5355\\u8def\\u7531\\u5730\\u5740\\uff08\\u53ef\\u4e3a\\u7a7a\\uff0c\\u5982\\u6309\\u94ae\\u65e0\\u8def\\u7531\\uff09", "docstring": null, "constraints": {"max_length": 255}, "db_field_types": {"": "VARCHAR(255)"}}, {"name": "icon", "field_type": "CharField", "db_column": "icon", "python_type": "str", "generated": false, "nullable": true, "unique": false, "indexed": false, "default": null, "description": "\\u83dc\\u5355\\u56fe\\u6807\\uff08\\u652f\\u6301l\\u56fe\\u6807\\u5e93\\u7c7b\\u540d\\u6216SVG\\u8def\\u5f84\\uff09", "docstring": null, "constraints": {"max_length": 100}, "db_field_types": {"": "VARCHAR(100)"}}, {"name": "parent_id", "field_type": "IntField", "db_column": "parent_id", "python_type": "int", "generated": false, "nullable": true, "unique": false, "indexed": false, "default": null, "description": "\\u7236\\u83dc\\u5355\\uff08\\u5173\\u8054\\u81ea\\u8eab\\uff0c\\u652f\\u6301\\u9012\\u5f52\\u67e5\\u8be2\\uff09", "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}], "fk_fields": [{"name": "parent", "field_type": "ForeignKeyFieldInstance", "python_type": "models.Menu", "generated": false, "nullable": true, "unique": false, "indexed": false, "default": null, "description": "\\u7236\\u83dc\\u5355\\uff08\\u5173\\u8054\\u81ea\\u8eab\\uff0c\\u652f\\u6301\\u9012\\u5f52\\u67e5\\u8be2\\uff09", "docstring": null, "constraints": {}, "db_constraint": true, "raw_field": "parent_id", "on_delete": "SET NULL"}], "backward_fk_fields": [{"name": "children", "field_type": "BackwardFKRelation", "python_type": "models.Menu", "generated": false, "nullable": true, "unique": false, "indexed": false, "default": null, "description": "\\u7236\\u83dc\\u5355\\uff08\\u5173\\u8054\\u81ea\\u8eab\\uff0c\\u652f\\u6301\\u9012\\u5f52\\u67e5\\u8be2\\uff09", "docstring": null, "constraints": {}, "db_constraint": true}], "o2o_fields": [], "backward_o2o_fields": [], "m2m_fields": [{"name": "role_menus", "field_type": "ManyToManyFieldInstance", "python_type": "models.Role", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": null, "docstring": null, "constraints": {}, "db_constraint": true, "model_name": "models.Role", "related_name": "menus", "forward_key": "role_id", "backward_key": "menu_id", "through": "role_menu", "on_delete": "CASCADE", "_generated": true}]}, "models.Project": {"name": "models.Project", "app": "models", "table": "project", "abstract": false, "description": "\\u9879\\u76ee\\u8868", "docstring": "\\u9879\\u76ee\\u8868", "unique_together": [], "indexes": [], "pk_field": {"name": "id", "field_type": "IntField", "db_column": "id", "python_type": "int", "generated": true, "nullable": false, "unique": true, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}, "data_fields": [{"name": "created_time", "field_type": "DatetimeField", "db_column": "created_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": false}, {"name": "updated_time", "field_type": "DatetimeField", "db_column": "updated_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": true}, {"name": "name", "field_type": "CharField", "db_column": "name", "python_type": "str", "generated": false, "nullable": false, "unique": true, "indexed": true, "default": null, "description": "\\u9879\\u76ee\\u540d\\u79f0", "docstring": null, "constraints": {"max_length": 50}, "db_field_types": {"": "VARCHAR(50)"}}, {"name": "desc", "field_type": "CharField", "db_column": "desc", "python_type": "str", "generated": false, "nullable": true, "unique": false, "indexed": false, "default": null, "description": "\\u9879\\u76ee\\u63cf\\u8ff0", "docstring": null, "constraints": {"max_length": 255}, "db_field_types": {"": "VARCHAR(255)"}}], "fk_fields": [], "backward_fk_fields": [{"name": "components", "field_type": "BackwardFKRelation", "python_type": "models.Component", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u9879\\u76ee\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {}, "db_constraint": true}, {"name": "envs", "field_type": "BackwardFKRelation", "python_type": "models.Env", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u9879\\u76ee\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {}, "db_constraint": true}], "o2o_fields": [], "backward_o2o_fields": [], "m2m_fields": []}, "models.Role": {"name": "models.Role", "app": "models", "table": "role", "abstract": false, "description": "\\u89d2\\u8272\\u6a21\\u578b", "docstring": "\\u89d2\\u8272\\u6a21\\u578b\\n\\u7528\\u4e8e\\u5b9a\\u4e49\\u7528\\u6237\\u6743\\u9650\\u96c6\\u5408", "unique_together": [], "indexes": [], "pk_field": {"name": "id", "field_type": "IntField", "db_column": "id", "python_type": "int", "generated": true, "nullable": false, "unique": true, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}, "data_fields": [{"name": "created_time", "field_type": "DatetimeField", "db_column": "created_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": false}, {"name": "updated_time", "field_type": "DatetimeField", "db_column": "updated_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": true}, {"name": "name", "field_type": "CharField", "db_column": "name", "python_type": "str", "generated": false, "nullable": false, "unique": true, "indexed": true, "default": null, "description": "\\u89d2\\u8272\\u540d\\u79f0", "docstring": null, "constraints": {"max_length": 50}, "db_field_types": {"": "VARCHAR(50)"}}, {"name": "desc", "field_type": "CharField", "db_column": "desc", "python_type": "str", "generated": false, "nullable": false, "unique": true, "indexed": true, "default": null, "description": "\\u89d2\\u8272\\u63cf\\u8ff0", "docstring": null, "constraints": {"max_length": 50}, "db_field_types": {"": "VARCHAR(50)"}}], "fk_fields": [], "backward_fk_fields": [{"name": "users", "field_type": "BackwardFKRelation", "python_type": "models.User", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u89d2\\u8272", "docstring": null, "constraints": {}, "db_constraint": true}], "o2o_fields": [], "backward_o2o_fields": [], "m2m_fields": [{"name": "menus", "field_type": "ManyToManyFieldInstance", "python_type": "models.Menu", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": null, "docstring": null, "constraints": {}, "db_constraint": true, "model_name": "models.Menu", "related_name": "role_menus", "forward_key": "menu_id", "backward_key": "role_id", "through": "role_menu", "on_delete": "CASCADE", "_generated": false}]}, "models.User": {"name": "models.User", "app": "models", "table": "user", "abstract": false, "description": "\\u7528\\u6237\\u6a21\\u578b", "docstring": "\\u7528\\u6237\\u6a21\\u578b\\n\\u5305\\u542b\\u57fa\\u672c\\u7528\\u6237\\u4fe1\\u606f\\u548c\\u8ba4\\u8bc1\\u76f8\\u5173\\u5b57\\u6bb5", "unique_together": [], "indexes": [{"type": "index", "val": "gASVigAAAAAAAACMEHRvcnRvaXNlLmluZGV4ZXOUjAVJbmRleJSTlCmBlH2UKIwGZmllbGRzlF2UKIwJaXNfYWN0aXZllIwPbGFzdF9sb2dpbl90aW1llGWMBG5hbWWUjBVpZHhfYWN0aXZlX3VzZXJfbG9naW6UjAtleHByZXNzaW9uc5QpjAVleHRyYZSMAJR1Yi4="}, {"type": "index", "val": "gASVbQAAAAAAAACMEHRvcnRvaXNlLmluZGV4ZXOUjAVJbmRleJSTlCmBlH2UKIwGZmllbGRzlF2UjAh1c2VybmFtZZRhjARuYW1llIwMaWR4X3VzZXJuYW1llIwLZXhwcmVzc2lvbnOUKYwFZXh0cmGUjACUdWIu"}], "pk_field": {"name": "id", "field_type": "IntField", "db_column": "id", "python_type": "int", "generated": true, "nullable": false, "unique": true, "indexed": true, "default": null, "description": "\\u7528\\u6237\\u552f\\u4e00\\u6807\\u8bc6", "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}, "data_fields": [{"name": "created_time", "field_type": "DatetimeField", "db_column": "created_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": false}, {"name": "updated_time", "field_type": "DatetimeField", "db_column": "updated_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": true}, {"name": "username", "field_type": "CharField", "db_column": "username", "python_type": "str", "generated": false, "nullable": false, "unique": true, "indexed": true, "default": null, "description": "\\u7528\\u6237\\u540d", "docstring": null, "constraints": {"max_length": 50}, "db_field_types": {"": "VARCHAR(50)"}}, {"name": "_password", "field_type": "CharField", "db_column": "_password", "python_type": "str", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5bc6\\u7801\\u54c8\\u5e0c\\u503c", "docstring": null, "constraints": {"max_length": 255}, "db_field_types": {"": "VARCHAR(255)"}}, {"name": "is_active", "field_type": "BooleanField", "db_column": "is_active", "python_type": "bool", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": true, "description": "\\u8d26\\u53f7\\u6fc0\\u6d3b\\u72b6\\u6001", "docstring": null, "constraints": {}, "db_field_types": {"": "BOOL", "mssql": "BIT", "oracle": "NUMBER(1)", "sqlite": "INT"}}, {"name": "is_delete", "field_type": "BooleanField", "db_column": "is_delete", "python_type": "bool", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": false, "description": "\\u8d26\\u53f7\\u662f\\u5426\\u5220\\u9664", "docstring": null, "constraints": {}, "db_field_types": {"": "BOOL", "mssql": "BIT", "oracle": "NUMBER(1)", "sqlite": "INT"}}, {"name": "last_login_time", "field_type": "DatetimeField", "db_column": "last_login_time", "python_type": "datetime.datetime", "generated": false, "nullable": true, "unique": false, "indexed": true, "default": null, "description": "\\u6700\\u540e\\u767b\\u5f55\\u65f6\\u95f4", "docstring": null, "constraints": {}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": false, "auto_now": false}, {"name": "role_id", "field_type": "IntField", "db_column": "role_id", "python_type": "int", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u89d2\\u8272", "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}], "fk_fields": [{"name": "role", "field_type": "ForeignKeyFieldInstance", "python_type": "models.Role", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u89d2\\u8272", "docstring": null, "constraints": {}, "db_constraint": true, "raw_field": "role_id", "on_delete": "CASCADE"}], "backward_fk_fields": [{"name": "envs", "field_type": "BackwardFKRelation", "python_type": "models.Env", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u7528\\u6237\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {}, "db_constraint": true}], "o2o_fields": [], "backward_o2o_fields": [], "m2m_fields": []}, "models.Aerich": {"name": "models.Aerich", "app": "models", "table": "aerich", "abstract": false, "description": null, "docstring": null, "unique_together": [], "indexes": [], "pk_field": {"name": "id", "field_type": "IntField", "db_column": "id", "python_type": "int", "generated": true, "nullable": false, "unique": true, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}, "data_fields": [{"name": "version", "field_type": "CharField", "db_column": "version", "python_type": "str", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": null, "docstring": null, "constraints": {"max_length": 255}, "db_field_types": {"": "VARCHAR(255)"}}, {"name": "app", "field_type": "CharField", "db_column": "app", "python_type": "str", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": null, "docstring": null, "constraints": {"max_length": 100}, "db_field_types": {"": "VARCHAR(100)"}}, {"name": "content", "field_type": "JSONField", "db_column": "content", "python_type": "Union[dict, list]", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": null, "docstring": null, "constraints": {}, "db_field_types": {"": "JSON", "mssql": "NVARCHAR(MAX)", "oracle": "NCLOB", "postgres": "JSONB"}}], "fk_fields": [], "backward_fk_fields": [], "o2o_fields": [], "backward_o2o_fields": [], "m2m_fields": []}}']
[2025-09-18 15:46:31,665] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250918154631_init.py', 'models', 1]
[2025-09-18 15:46:31,665] [DEBUG] SELECT `id`,`updated_time`,`path`,`icon`,`label`,`created_time`,`parent_id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/home', 2]
[2025-09-18 15:46:31,667] [DEBUG] INSERT INTO `menu` (`created_time`,`updated_time`,`label`,`path`,`icon`,`parent_id`) VALUES (%s,%s,%s,%s,%s,%s): [datetime.datetime(2025, 9, 18, 15, 46, 31, 667844, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 15, 46, 31, 667844, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '首页', '/home', 'house', None]
[2025-09-18 15:46:31,668] [DEBUG] SELECT `id`,`updated_time`,`path`,`icon`,`label`,`created_time`,`parent_id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/', 2]
[2025-09-18 15:46:31,668] [DEBUG] INSERT INTO `menu` (`created_time`,`updated_time`,`label`,`path`,`icon`,`parent_id`) VALUES (%s,%s,%s,%s,%s,%s): [datetime.datetime(2025, 9, 18, 15, 46, 31, 668840, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 15, 46, 31, 668840, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '环境', '/', 'location', None]
[2025-09-18 15:46:31,669] [DEBUG] SELECT `id`,`updated_time`,`path`,`icon`,`label`,`created_time`,`parent_id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/env/info', 2]
[2025-09-18 15:46:31,670] [DEBUG] INSERT INTO `menu` (`created_time`,`updated_time`,`label`,`path`,`icon`,`parent_id`) VALUES (%s,%s,%s,%s,%s,%s): [datetime.datetime(2025, 9, 18, 15, 46, 31, 670842, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 15, 46, 31, 670842, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '环境信息', '/env/info', 'setting', 2]
[2025-09-18 15:46:31,672] [DEBUG] SELECT `id`,`updated_time`,`path`,`icon`,`label`,`created_time`,`parent_id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/env/version', 2]
[2025-09-18 15:46:31,672] [DEBUG] INSERT INTO `menu` (`created_time`,`updated_time`,`label`,`path`,`icon`,`parent_id`) VALUES (%s,%s,%s,%s,%s,%s): [datetime.datetime(2025, 9, 18, 15, 46, 31, 672346, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 15, 46, 31, 672346, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '组件版本', '/env/version', 'setting', 2]
[2025-09-18 15:46:31,673] [DEBUG] SELECT `id`,`updated_time`,`path`,`icon`,`label`,`created_time`,`parent_id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/env/compare', 2]
[2025-09-18 15:46:31,673] [DEBUG] INSERT INTO `menu` (`created_time`,`updated_time`,`label`,`path`,`icon`,`parent_id`) VALUES (%s,%s,%s,%s,%s,%s): [datetime.datetime(2025, 9, 18, 15, 46, 31, 673360, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 15, 46, 31, 673360, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '版本比较', '/env/compare', 'setting', 2]
[2025-09-18 15:46:31,675] [DEBUG] SELECT `id`,`updated_time`,`path`,`icon`,`label`,`created_time`,`parent_id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/user', 2]
[2025-09-18 15:46:31,675] [DEBUG] INSERT INTO `menu` (`created_time`,`updated_time`,`label`,`path`,`icon`,`parent_id`) VALUES (%s,%s,%s,%s,%s,%s): [datetime.datetime(2025, 9, 18, 15, 46, 31, 675362, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 15, 46, 31, 675362, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '用户管理', '/user', 'user', None]
[2025-09-18 15:46:31,676] [DEBUG] SELECT `id`,`updated_time`,`path`,`icon`,`label`,`created_time`,`parent_id` FROM `menu`: []
[2025-09-18 15:46:31,677] [DEBUG] SELECT `id`,`updated_time`,`path`,`icon`,`label`,`created_time`,`parent_id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/user', 2]
[2025-09-18 15:46:31,678] [DEBUG] SELECT `name`,`id`,`updated_time`,`desc`,`created_time` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 15:46:31,679] [DEBUG] INSERT INTO `role` (`created_time`,`updated_time`,`name`,`desc`) VALUES (%s,%s,%s,%s): [datetime.datetime(2025, 9, 18, 15, 46, 31, 679405, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 15, 46, 31, 679405, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), 'superuser', '超级管理员']
[2025-09-18 15:46:31,681] [DEBUG] DELETE FROM `role_menu` WHERE `role_id`=%s: [1]
[2025-09-18 15:46:31,682] [DEBUG] SELECT `menu_id` FROM `role_menu` WHERE `role_id`=%s AND `menu_id` IN (%s,%s,%s,%s,%s,%s): [1, 1, 2, 3, 4, 5, 6]
[2025-09-18 15:46:31,682] [DEBUG] INSERT INTO `role_menu` (`menu_id`,`role_id`) VALUES (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s): [1, 1, 2, 1, 3, 1, 4, 1, 5, 1, 6, 1]
[2025-09-18 15:46:31,684] [DEBUG] SELECT `name`,`id`,`updated_time`,`desc`,`created_time` FROM `role` WHERE `name`=%s LIMIT %s: ['common', 2]
[2025-09-18 15:46:31,684] [DEBUG] INSERT INTO `role` (`created_time`,`updated_time`,`name`,`desc`) VALUES (%s,%s,%s,%s): [datetime.datetime(2025, 9, 18, 15, 46, 31, 684380, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 15, 46, 31, 684380, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), 'common', '普通用户']
[2025-09-18 15:46:31,685] [DEBUG] DELETE FROM `role_menu` WHERE `role_id`=%s: [2]
[2025-09-18 15:46:31,686] [DEBUG] SELECT `menu_id` FROM `role_menu` WHERE `role_id`=%s AND `menu_id` IN (%s,%s,%s,%s,%s): [2, 1, 2, 3, 4, 5]
[2025-09-18 15:46:31,686] [DEBUG] INSERT INTO `role_menu` (`menu_id`,`role_id`) VALUES (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s): [1, 2, 2, 2, 3, 2, 4, 2, 5, 2]
[2025-09-18 15:46:31,688] [DEBUG] SELECT `name`,`id`,`updated_time`,`desc`,`created_time` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 15:46:31,689] [DEBUG] SELECT `last_login_time`,`is_active`,`id`,`username`,`updated_time`,`role_id`,`_password`,`is_delete`,`created_time` FROM `user` WHERE `username`=%s LIMIT %s: ['admin', 2]
[2025-09-18 15:46:31,881] [DEBUG] INSERT INTO `user` (`created_time`,`updated_time`,`username`,`_password`,`is_active`,`is_delete`,`last_login_time`,`role_id`) VALUES (%s,%s,%s,%s,%s,%s,%s,%s): [datetime.datetime(2025, 9, 18, 15, 46, 31, 881226, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 15, 46, 31, 881226, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), 'admin', '$2b$12$v525oPpSO2u.ZcmP6UdBxe0Yfr1NXolrJ86D.OScgsLV87BVJcWZ6', False, False, None, 1]
[2025-09-18 15:46:31,884] [INFO] 超级管理员创建成功
[2025-09-18 15:46:31,884] [INFO] Application startup complete.
[2025-09-18 15:46:31,969] [ERROR] Traceback (most recent call last):
  File "D:\python\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\asyncio\base_events.py", line 685, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\python\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "D:\python\Lib\asyncio\runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 741, in lifespan
    await receive()
  File "E:\env\fastapi_platform\Lib\site-packages\uvicorn\lifespan\on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\asyncio\queues.py", line 158, in get
    await getter
asyncio.exceptions.CancelledError

[2025-09-18 15:46:32,707] [INFO] Started server process [45120]
[2025-09-18 15:46:32,708] [INFO] Waiting for application startup.
[2025-09-18 15:46:32,708] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:46:32,733] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:46:32,757] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x00000217BEA91550> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:46:32,757] [DEBUG] SELECT `id`,`content`,`version`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:46:32,759] [DEBUG] select version() as version: None
[2025-09-18 15:46:32,762] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 24, in init_db
    await command.migrate()
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 130, in migrate
    return await Migrate.migrate(name, empty)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 157, in migrate
    cls.diff_models(last_version, new_version_content)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 413, in diff_models
    cls._handle_m2m_fields(
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 249, in _handle_m2m_fields
    if (option and option[-1] == "nullable") or change[0][0] == "db_constraint":
                                                ~~~~~~~~~^^^
TypeError: 'bool' object is not subscriptable

[2025-09-18 15:46:32,762] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:46:41,238] [INFO] Started server process [40840]
[2025-09-18 15:46:41,238] [INFO] Waiting for application startup.
[2025-09-18 15:46:41,239] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:46:41,262] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:46:41,286] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000002895D161310> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:46:41,286] [DEBUG] SELECT `content`,`id`,`app`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:46:41,288] [DEBUG] select version() as version: None
[2025-09-18 15:46:41,291] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 24, in init_db
    await command.migrate()
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 130, in migrate
    return await Migrate.migrate(name, empty)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 157, in migrate
    cls.diff_models(last_version, new_version_content)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 413, in diff_models
    cls._handle_m2m_fields(
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\migrate.py", line 249, in _handle_m2m_fields
    if (option and option[-1] == "nullable") or change[0][0] == "db_constraint":
                                                ~~~~~~~~~^^^
TypeError: 'bool' object is not subscriptable

[2025-09-18 15:46:41,291] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:47:58,420] [INFO] Started server process [41220]
[2025-09-18 15:47:58,420] [INFO] Waiting for application startup.
[2025-09-18 15:47:58,421] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:47:58,449] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:47:58,475] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001FA3F6C51F0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:47:58,476] [DEBUG] SELECT `id`,`app`,`version`,`content` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 15:47:58,477] [DEBUG] select version() as version: None
[2025-09-18 15:47:58,478] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['0_20250918154631_init.py', 'models', 1]
[2025-09-18 15:47:58,479] [DEBUG] SELECT `updated_time`,`path`,`id`,`parent_id`,`created_time`,`label`,`icon` FROM `menu` WHERE `path`=%s LIMIT %s: ['/home', 2]
[2025-09-18 15:47:58,481] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 667844, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 15, 47, 58, 481340, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '首页', '/home', 'house', None, 1]
[2025-09-18 15:47:58,483] [DEBUG] SELECT `updated_time`,`path`,`id`,`parent_id`,`created_time`,`label`,`icon` FROM `menu` WHERE `path`=%s LIMIT %s: ['/', 2]
[2025-09-18 15:47:58,484] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 668840, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 15, 47, 58, 484377, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '环境', '/', 'location', None, 2]
[2025-09-18 15:47:58,486] [DEBUG] SELECT `updated_time`,`path`,`id`,`parent_id`,`created_time`,`label`,`icon` FROM `menu` WHERE `path`=%s LIMIT %s: ['/env/info', 2]
[2025-09-18 15:47:58,487] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 670842, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 15, 47, 58, 487374, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '环境信息', '/env/info', 'setting', 2, 3]
[2025-09-18 15:47:58,489] [DEBUG] SELECT `updated_time`,`path`,`id`,`parent_id`,`created_time`,`label`,`icon` FROM `menu` WHERE `path`=%s LIMIT %s: ['/env/version', 2]
[2025-09-18 15:47:58,490] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 672346, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 15, 47, 58, 490376, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '组件版本', '/env/version', 'setting', 2, 4]
[2025-09-18 15:47:58,492] [DEBUG] SELECT `updated_time`,`path`,`id`,`parent_id`,`created_time`,`label`,`icon` FROM `menu` WHERE `path`=%s LIMIT %s: ['/env/compare', 2]
[2025-09-18 15:47:58,493] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 673360, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 15, 47, 58, 493382, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '版本比较', '/env/compare', 'setting', 2, 5]
[2025-09-18 15:47:58,494] [DEBUG] SELECT `updated_time`,`path`,`id`,`parent_id`,`created_time`,`label`,`icon` FROM `menu` WHERE `path`=%s LIMIT %s: ['/user', 2]
[2025-09-18 15:47:58,495] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 675362, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 15, 47, 58, 495357, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '用户管理', '/user', 'user', None, 6]
[2025-09-18 15:47:58,497] [DEBUG] SELECT `updated_time`,`path`,`id`,`parent_id`,`created_time`,`label`,`icon` FROM `menu`: []
[2025-09-18 15:47:58,498] [DEBUG] SELECT `updated_time`,`path`,`id`,`parent_id`,`created_time`,`label`,`icon` FROM `menu` WHERE `path`=%s LIMIT %s: ['/user', 2]
[2025-09-18 15:47:58,499] [DEBUG] SELECT `updated_time`,`id`,`desc`,`name`,`created_time` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 15:47:58,499] [DEBUG] DELETE FROM `role_menu` WHERE `role_id`=%s: [1]
[2025-09-18 15:47:58,501] [DEBUG] SELECT `menu_id` FROM `role_menu` WHERE `role_id`=%s AND `menu_id` IN (%s,%s,%s,%s,%s,%s): [1, 1, 2, 3, 4, 5, 6]
[2025-09-18 15:47:58,502] [DEBUG] INSERT INTO `role_menu` (`menu_id`,`role_id`) VALUES (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s): [1, 1, 2, 1, 3, 1, 4, 1, 5, 1, 6, 1]
[2025-09-18 15:47:58,503] [DEBUG] SELECT `updated_time`,`id`,`desc`,`name`,`created_time` FROM `role` WHERE `name`=%s LIMIT %s: ['common', 2]
[2025-09-18 15:47:58,504] [DEBUG] DELETE FROM `role_menu` WHERE `role_id`=%s: [2]
[2025-09-18 15:47:58,506] [DEBUG] SELECT `menu_id` FROM `role_menu` WHERE `role_id`=%s AND `menu_id` IN (%s,%s,%s,%s,%s): [2, 1, 2, 3, 4, 5]
[2025-09-18 15:47:58,506] [DEBUG] INSERT INTO `role_menu` (`menu_id`,`role_id`) VALUES (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s): [1, 2, 2, 2, 3, 2, 4, 2, 5, 2]
[2025-09-18 15:47:58,507] [DEBUG] SELECT `updated_time`,`id`,`desc`,`name`,`created_time` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 15:47:58,509] [DEBUG] SELECT `role_id`,`_password`,`username`,`id`,`updated_time`,`last_login_time`,`is_delete`,`created_time`,`is_active` FROM `user` WHERE `username`=%s LIMIT %s: ['admin', 2]
[2025-09-18 15:47:58,509] [INFO] 超级管理员已存在
[2025-09-18 15:47:58,509] [INFO] Application startup complete.
[2025-09-18 15:48:02,492] [INFO] 127.0.0.1:10421 - "OPTIONS /api/user/get_menu HTTP/1.1" 200
[2025-09-18 15:48:02,518] [INFO] 127.0.0.1:10421 - "GET /api/user/get_menu HTTP/1.1" 401
[2025-09-18 15:48:10,125] [DEBUG] Calling on_field_start with no data
[2025-09-18 15:48:10,125] [DEBUG] Calling on_field_name with data[0:8]
[2025-09-18 15:48:10,125] [DEBUG] Calling on_field_data with data[9:14]
[2025-09-18 15:48:10,125] [DEBUG] Calling on_field_end with no data
[2025-09-18 15:48:10,125] [DEBUG] Calling on_field_start with no data
[2025-09-18 15:48:10,125] [DEBUG] Calling on_field_name with data[15:23]
[2025-09-18 15:48:10,125] [DEBUG] Calling on_field_data with data[24:32]
[2025-09-18 15:48:10,125] [DEBUG] Calling on_field_end with no data
[2025-09-18 15:48:10,125] [DEBUG] Calling on_end with no data
[2025-09-18 15:48:10,128] [DEBUG] SELECT `role_id`,`_password`,`username`,`id`,`updated_time`,`last_login_time`,`is_delete`,`created_time`,`is_active` FROM `user` WHERE `username`=%s LIMIT %s: ['admin', 2]
[2025-09-18 15:48:10,487] [DEBUG] UPDATE `user` SET `created_time`=%s,`updated_time`=%s,`username`=%s,`_password`=%s,`is_active`=%s,`is_delete`=%s,`last_login_time`=%s,`role_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 881226, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 15, 48, 10, 486675, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), 'admin', '$2b$12$v525oPpSO2u.ZcmP6UdBxe0Yfr1NXolrJ86D.OScgsLV87BVJcWZ6', False, False, datetime.datetime(2025, 9, 18, 15, 48, 10, 486675), 1, 1]
[2025-09-18 15:48:10,508] [INFO] 127.0.0.1:57744 - "POST /api/login HTTP/1.1" 200
[2025-09-18 15:48:10,581] [DEBUG] SELECT `user`.`role_id`,`user`.`_password`,`user`.`username`,`user`.`id`,`user`.`updated_time`,`user`.`last_login_time`,`user`.`is_delete`,`user`.`created_time`,`user`.`is_active`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`id` `user__role.id`,`user__role`.`desc` `user__role.desc`,`user__role`.`name` `user__role.name`,`user__role`.`created_time` `user__role.created_time` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [1, 2]
[2025-09-18 15:48:10,584] [DEBUG] SELECT `updated_time`,`id`,`desc`,`name`,`created_time` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 15:48:10,585] [DEBUG] SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`menu`.`updated_time` `updated_time`,`menu`.`path` `path`,`menu`.`id` `id`,`menu`.`parent_id` `parent_id`,`menu`.`created_time` `created_time`,`menu`.`label` `label`,`menu`.`icon` `icon` FROM `menu` JOIN (SELECT `role_id` `_backward_relation_key`,`menu_id` `_forward_relation_key` FROM `role_menu` WHERE `role_id` IN (%s)) `sq0` ON `sq0`.`_forward_relation_key`=`menu`.`id`: [1]
[2025-09-18 15:48:10,587] [DEBUG] SELECT `menu`.`id` `id`,`menu`.`label` `label`,`menu`.`path` `path`,`menu`.`icon` `icon`,`menu`.`parent_id` `parent_id` FROM `menu` LEFT OUTER JOIN `role_menu` ON `menu`.`id`=`role_menu`.`menu_id` WHERE `role_menu`.`role_id`=%s: [1]
[2025-09-18 15:48:10,588] [INFO] 127.0.0.1:57744 - "GET /api/user/get_menu HTTP/1.1" 200
[2025-09-18 15:48:12,211] [INFO] 127.0.0.1:57744 - "OPTIONS /api/user/info?page=1&size=10&username= HTTP/1.1" 200
[2025-09-18 15:48:12,217] [DEBUG] SELECT `user`.`role_id`,`user`.`_password`,`user`.`username`,`user`.`id`,`user`.`updated_time`,`user`.`last_login_time`,`user`.`is_delete`,`user`.`created_time`,`user`.`is_active`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`id` `user__role.id`,`user__role`.`desc` `user__role.desc`,`user__role`.`name` `user__role.name`,`user__role`.`created_time` `user__role.created_time` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [1, 2]
[2025-09-18 15:48:12,220] [DEBUG] SELECT COUNT(*) FROM `user` WHERE `is_delete`=%s: [False]
[2025-09-18 15:48:12,222] [DEBUG] SELECT `role_id`,`_password`,`username`,`id`,`updated_time`,`last_login_time`,`is_delete`,`created_time`,`is_active` FROM `user` WHERE `is_delete`=%s ORDER BY `id` DESC LIMIT %s OFFSET %s: [False, 10, 0]
[2025-09-18 15:48:12,224] [DEBUG] SELECT `updated_time`,`id`,`desc`,`name`,`created_time` FROM `role` WHERE `id`=%s: [1]
[2025-09-18 15:48:12,227] [INFO] 127.0.0.1:57744 - "GET /api/user/info?page=1&size=10&username= HTTP/1.1" 200
[2025-09-18 15:52:57,557] [INFO] Shutting down
[2025-09-18 15:52:57,664] [INFO] Waiting for application shutdown.
[2025-09-18 15:52:57,664] [DEBUG] Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:52:57,666] [INFO] Tortoise-ORM shutdown
[2025-09-18 15:52:57,666] [INFO] Application shutdown complete.
[2025-09-18 15:52:57,666] [INFO] Finished server process [41220]
[2025-09-18 15:52:58,453] [INFO] Started server process [42296]
[2025-09-18 15:52:58,453] [INFO] Waiting for application startup.
[2025-09-18 15:52:58,454] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:52:58,480] [DEBUG] Creating schema: CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:52:58,493] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:52:58,521] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x00000264572DD250> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:52:58,521] [DEBUG] CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:52:58,537] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 226, in execute_script
    async with connection.cursor() as cursor:
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\utils.py", line 78, in __aexit__
    await self._obj.close()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 158, in close
    while (await self.nextset()):
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 191, in nextset
    await conn.next_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 473, in next_result
    await self._read_query_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 18, in init_db
    await command.init_db(safe=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 145, in init_db
    await generate_schema_for_client(connection, safe)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\utils.py", line 43, in generate_schema_for_client
    await generator.generate_from_string(schema)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\base\schema_generator.py", line 487, in generate_from_string
    await self.client.execute_script(creation_string)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

[2025-09-18 15:52:58,537] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:52:59,226] [INFO] Started server process [41500]
[2025-09-18 15:52:59,226] [INFO] Waiting for application startup.
[2025-09-18 15:52:59,226] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:52:59,246] [DEBUG] Creating schema: CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:52:59,254] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:52:59,281] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001E5F82AFE90> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:52:59,281] [DEBUG] CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:52:59,293] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 226, in execute_script
    async with connection.cursor() as cursor:
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\utils.py", line 78, in __aexit__
    await self._obj.close()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 158, in close
    while (await self.nextset()):
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 191, in nextset
    await conn.next_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 473, in next_result
    await self._read_query_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 18, in init_db
    await command.init_db(safe=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 145, in init_db
    await generate_schema_for_client(connection, safe)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\utils.py", line 43, in generate_schema_for_client
    await generator.generate_from_string(schema)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\base\schema_generator.py", line 487, in generate_from_string
    await self.client.execute_script(creation_string)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

[2025-09-18 15:52:59,294] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:53:04,998] [INFO] Started server process [40840]
[2025-09-18 15:53:04,998] [INFO] Waiting for application startup.
[2025-09-18 15:53:04,998] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:53:05,020] [DEBUG] Creating schema: CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:53:05,028] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:53:05,053] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000026E21B5FC80> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:53:05,053] [DEBUG] CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:53:05,066] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 226, in execute_script
    async with connection.cursor() as cursor:
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\utils.py", line 78, in __aexit__
    await self._obj.close()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 158, in close
    while (await self.nextset()):
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 191, in nextset
    await conn.next_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 473, in next_result
    await self._read_query_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 18, in init_db
    await command.init_db(safe=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 145, in init_db
    await generate_schema_for_client(connection, safe)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\utils.py", line 43, in generate_schema_for_client
    await generator.generate_from_string(schema)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\base\schema_generator.py", line 487, in generate_from_string
    await self.client.execute_script(creation_string)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

[2025-09-18 15:53:05,067] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:53:41,402] [INFO] Started server process [44060]
[2025-09-18 15:53:41,402] [INFO] Waiting for application startup.
[2025-09-18 15:53:41,404] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:53:41,426] [DEBUG] Creating schema: CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:53:41,437] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:53:41,460] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001EABE586B10> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:53:41,460] [DEBUG] CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:53:41,471] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 226, in execute_script
    async with connection.cursor() as cursor:
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\utils.py", line 78, in __aexit__
    await self._obj.close()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 158, in close
    while (await self.nextset()):
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 191, in nextset
    await conn.next_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 473, in next_result
    await self._read_query_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 18, in init_db
    await command.init_db(safe=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 145, in init_db
    await generate_schema_for_client(connection, safe)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\utils.py", line 43, in generate_schema_for_client
    await generator.generate_from_string(schema)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\base\schema_generator.py", line 487, in generate_from_string
    await self.client.execute_script(creation_string)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

[2025-09-18 15:53:41,471] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:53:45,879] [INFO] Started server process [40152]
[2025-09-18 15:53:45,880] [INFO] Waiting for application startup.
[2025-09-18 15:53:45,880] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:53:45,901] [DEBUG] Creating schema: CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:53:45,911] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:53:45,938] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000024F78133BC0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:53:45,938] [DEBUG] CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:53:45,949] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 226, in execute_script
    async with connection.cursor() as cursor:
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\utils.py", line 78, in __aexit__
    await self._obj.close()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 158, in close
    while (await self.nextset()):
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 191, in nextset
    await conn.next_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 473, in next_result
    await self._read_query_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 18, in init_db
    await command.init_db(safe=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 145, in init_db
    await generate_schema_for_client(connection, safe)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\utils.py", line 43, in generate_schema_for_client
    await generator.generate_from_string(schema)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\base\schema_generator.py", line 487, in generate_from_string
    await self.client.execute_script(creation_string)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

[2025-09-18 15:53:45,950] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:54:03,924] [INFO] Started server process [44320]
[2025-09-18 15:54:03,924] [INFO] Waiting for application startup.
[2025-09-18 15:54:03,924] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:54:03,945] [DEBUG] Creating schema: CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:54:03,960] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:54:03,994] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001B28D775730> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:54:03,994] [DEBUG] CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:54:04,009] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 226, in execute_script
    async with connection.cursor() as cursor:
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\utils.py", line 78, in __aexit__
    await self._obj.close()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 158, in close
    while (await self.nextset()):
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 191, in nextset
    await conn.next_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 473, in next_result
    await self._read_query_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 18, in init_db
    await command.init_db(safe=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 145, in init_db
    await generate_schema_for_client(connection, safe)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\utils.py", line 43, in generate_schema_for_client
    await generator.generate_from_string(schema)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\base\schema_generator.py", line 487, in generate_from_string
    await self.client.execute_script(creation_string)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

[2025-09-18 15:54:04,009] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:55:40,643] [INFO] Started server process [2444]
[2025-09-18 15:55:40,643] [INFO] Waiting for application startup.
[2025-09-18 15:55:40,643] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:55:40,663] [DEBUG] Creating schema: CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:55:40,675] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:55:40,701] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000021CFFC9EA80> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:55:40,701] [DEBUG] CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:55:40,712] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 226, in execute_script
    async with connection.cursor() as cursor:
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\utils.py", line 78, in __aexit__
    await self._obj.close()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 158, in close
    while (await self.nextset()):
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 191, in nextset
    await conn.next_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 473, in next_result
    await self._read_query_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 18, in init_db
    await command.init_db(safe=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 145, in init_db
    await generate_schema_for_client(connection, safe)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\utils.py", line 43, in generate_schema_for_client
    await generator.generate_from_string(schema)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\base\schema_generator.py", line 487, in generate_from_string
    await self.client.execute_script(creation_string)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

[2025-09-18 15:55:40,712] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:55:49,240] [INFO] Started server process [1636]
[2025-09-18 15:55:49,240] [INFO] Waiting for application startup.
[2025-09-18 15:55:49,240] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:55:49,262] [DEBUG] Creating schema: CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:55:49,272] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:55:49,298] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000028D3DED31A0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:55:49,298] [DEBUG] CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:55:49,314] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 226, in execute_script
    async with connection.cursor() as cursor:
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\utils.py", line 78, in __aexit__
    await self._obj.close()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 158, in close
    while (await self.nextset()):
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 191, in nextset
    await conn.next_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 473, in next_result
    await self._read_query_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 18, in init_db
    await command.init_db(safe=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 145, in init_db
    await generate_schema_for_client(connection, safe)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\utils.py", line 43, in generate_schema_for_client
    await generator.generate_from_string(schema)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\base\schema_generator.py", line 487, in generate_from_string
    await self.client.execute_script(creation_string)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

[2025-09-18 15:55:49,314] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:55:55,445] [INFO] Started server process [20212]
[2025-09-18 15:55:55,445] [INFO] Waiting for application startup.
[2025-09-18 15:55:55,446] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:55:55,465] [DEBUG] Creating schema: CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:55:55,474] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:55:55,498] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000020FEAAEB980> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:55:55,498] [DEBUG] CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:55:55,511] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 226, in execute_script
    async with connection.cursor() as cursor:
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\utils.py", line 78, in __aexit__
    await self._obj.close()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 158, in close
    while (await self.nextset()):
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 191, in nextset
    await conn.next_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 473, in next_result
    await self._read_query_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 18, in init_db
    await command.init_db(safe=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 145, in init_db
    await generate_schema_for_client(connection, safe)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\utils.py", line 43, in generate_schema_for_client
    await generator.generate_from_string(schema)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\base\schema_generator.py", line 487, in generate_from_string
    await self.client.execute_script(creation_string)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

[2025-09-18 15:55:55,511] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:56:09,915] [INFO] Started server process [17624]
[2025-09-18 15:56:09,915] [INFO] Waiting for application startup.
[2025-09-18 15:56:09,916] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:56:09,934] [DEBUG] Creating schema: CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:56:09,941] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:56:09,965] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000026435A0FDD0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:56:09,965] [DEBUG] CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:56:09,980] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 226, in execute_script
    async with connection.cursor() as cursor:
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\utils.py", line 78, in __aexit__
    await self._obj.close()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 158, in close
    while (await self.nextset()):
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 191, in nextset
    await conn.next_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 473, in next_result
    await self._read_query_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 18, in init_db
    await command.init_db(safe=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 145, in init_db
    await generate_schema_for_client(connection, safe)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\utils.py", line 43, in generate_schema_for_client
    await generator.generate_from_string(schema)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\base\schema_generator.py", line 487, in generate_from_string
    await self.client.execute_script(creation_string)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

[2025-09-18 15:56:09,980] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:56:18,740] [INFO] Started server process [17548]
[2025-09-18 15:56:18,740] [INFO] Waiting for application startup.
[2025-09-18 15:56:18,742] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:56:18,764] [DEBUG] Creating schema: CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:56:18,772] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:56:18,800] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x00000227EF198140> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:56:18,800] [DEBUG] CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:56:18,813] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 226, in execute_script
    async with connection.cursor() as cursor:
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\utils.py", line 78, in __aexit__
    await self._obj.close()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 158, in close
    while (await self.nextset()):
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 191, in nextset
    await conn.next_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 473, in next_result
    await self._read_query_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 18, in init_db
    await command.init_db(safe=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 145, in init_db
    await generate_schema_for_client(connection, safe)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\utils.py", line 43, in generate_schema_for_client
    await generator.generate_from_string(schema)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\base\schema_generator.py", line 487, in generate_from_string
    await self.client.execute_script(creation_string)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

[2025-09-18 15:56:18,813] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:56:20,629] [INFO] Started server process [40208]
[2025-09-18 15:56:20,629] [INFO] Waiting for application startup.
[2025-09-18 15:56:20,630] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:56:20,651] [DEBUG] Creating schema: CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:56:20,661] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:56:20,690] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001FE57B2FE90> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:56:20,690] [DEBUG] CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:56:20,701] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 226, in execute_script
    async with connection.cursor() as cursor:
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\utils.py", line 78, in __aexit__
    await self._obj.close()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 158, in close
    while (await self.nextset()):
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 191, in nextset
    await conn.next_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 473, in next_result
    await self._read_query_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 18, in init_db
    await command.init_db(safe=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 145, in init_db
    await generate_schema_for_client(connection, safe)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\utils.py", line 43, in generate_schema_for_client
    await generator.generate_from_string(schema)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\base\schema_generator.py", line 487, in generate_from_string
    await self.client.execute_script(creation_string)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

[2025-09-18 15:56:20,701] [ERROR] Application startup failed. Exiting.
[2025-09-18 15:56:28,036] [INFO] Started server process [22820]
[2025-09-18 15:56:28,037] [INFO] Waiting for application startup.
[2025-09-18 15:56:28,037] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 15:56:28,062] [DEBUG] Creating schema: CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:56:28,075] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 15:56:28,101] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000026AF9BC0830> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 15:56:28,102] [DEBUG] CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 15:56:28,118] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 226, in execute_script
    async with connection.cursor() as cursor:
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\utils.py", line 78, in __aexit__
    await self._obj.close()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 158, in close
    while (await self.nextset()):
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 191, in nextset
    await conn.next_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 473, in next_result
    await self._read_query_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 18, in init_db
    await command.init_db(safe=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 145, in init_db
    await generate_schema_for_client(connection, safe)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\utils.py", line 43, in generate_schema_for_client
    await generator.generate_from_string(schema)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\base\schema_generator.py", line 487, in generate_from_string
    await self.client.execute_script(creation_string)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

[2025-09-18 15:56:28,118] [ERROR] Application startup failed. Exiting.
[2025-09-18 16:00:25,957] [INFO] Started server process [37608]
[2025-09-18 16:00:25,957] [INFO] Waiting for application startup.
[2025-09-18 16:00:25,958] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 16:00:25,979] [DEBUG] Creating schema: CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 16:00:25,992] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 16:00:26,016] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001EF1D16ED80> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 16:00:26,017] [DEBUG] CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 16:00:26,027] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 226, in execute_script
    async with connection.cursor() as cursor:
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\utils.py", line 78, in __aexit__
    await self._obj.close()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 158, in close
    while (await self.nextset()):
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 191, in nextset
    await conn.next_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 473, in next_result
    await self._read_query_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 18, in init_db
    await command.init_db(safe=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 145, in init_db
    await generate_schema_for_client(connection, safe)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\utils.py", line 43, in generate_schema_for_client
    await generator.generate_from_string(schema)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\base\schema_generator.py", line 487, in generate_from_string
    await self.client.execute_script(creation_string)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

[2025-09-18 16:00:26,027] [ERROR] Application startup failed. Exiting.
[2025-09-18 16:00:48,244] [INFO] Started server process [10836]
[2025-09-18 16:00:48,244] [INFO] Waiting for application startup.
[2025-09-18 16:00:48,245] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 16:00:48,266] [DEBUG] Creating schema: CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 16:00:48,277] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 16:00:48,301] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x00000278E39EFEF0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 16:00:48,301] [DEBUG] CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 16:00:48,316] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 226, in execute_script
    async with connection.cursor() as cursor:
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\utils.py", line 78, in __aexit__
    await self._obj.close()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 158, in close
    while (await self.nextset()):
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 191, in nextset
    await conn.next_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 473, in next_result
    await self._read_query_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 18, in init_db
    await command.init_db(safe=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 145, in init_db
    await generate_schema_for_client(connection, safe)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\utils.py", line 43, in generate_schema_for_client
    await generator.generate_from_string(schema)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\base\schema_generator.py", line 487, in generate_from_string
    await self.client.execute_script(creation_string)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

[2025-09-18 16:00:48,316] [ERROR] Application startup failed. Exiting.
[2025-09-18 16:00:56,609] [INFO] Started server process [38028]
[2025-09-18 16:00:56,609] [INFO] Waiting for application startup.
[2025-09-18 16:00:56,609] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 16:00:56,630] [DEBUG] Creating schema: CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 16:00:56,642] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 16:00:56,667] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000015B06DFFEF0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 16:00:56,667] [DEBUG] CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 16:00:56,680] [ERROR] Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 57, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 226, in execute_script
    async with connection.cursor() as cursor:
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\utils.py", line 78, in __aexit__
    await self._obj.close()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 158, in close
    while (await self.nextset()):
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\cursors.py", line 191, in nextset
    await conn.next_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 473, in next_result
    await self._read_query_result()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\env\fastapi_platform\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "E:\env\fastapi_platform\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "D:\python\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\web_platform\background\app\__init__.py", line 24, in lifespan
    await init_data()
  File "E:\web_platform\background\app\core\init_app.py", line 164, in init_data
    await init_db()
  File "E:\web_platform\background\app\core\init_app.py", line 18, in init_db
    await command.init_db(safe=True)
  File "E:\env\fastapi_platform\Lib\site-packages\aerich\__init__.py", line 145, in init_db
    await generate_schema_for_client(connection, safe)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\utils.py", line 43, in generate_schema_for_client
    await generator.generate_from_string(schema)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\base\schema_generator.py", line 487, in generate_from_string
    await self.client.execute_script(creation_string)
  File "E:\env\fastapi_platform\Lib\site-packages\tortoise\backends\mysql\client.py", line 65, in translate_exceptions_
    raise OperationalError(exc)
tortoise.exceptions.OperationalError: (1061, "Duplicate key name 'idx_active_user_login'")

[2025-09-18 16:00:56,680] [ERROR] Application startup failed. Exiting.
[2025-09-18 16:01:45,929] [INFO] Started server process [43756]
[2025-09-18 16:01:45,930] [INFO] Waiting for application startup.
[2025-09-18 16:01:45,930] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 16:01:45,951] [DEBUG] Creating schema: CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login_composite` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username_unique` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 16:01:45,960] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 16:01:45,983] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000019163607740> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 16:01:45,984] [DEBUG] CREATE TABLE IF NOT EXISTS `menu` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '菜单唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `label` VARCHAR(50) NOT NULL  COMMENT '菜单名称（带索引，快速查询）',
    `path` VARCHAR(255)   COMMENT '菜单路由地址（可为空，如按钮无路由）',
    `icon` VARCHAR(100)   COMMENT '菜单图标（支持l图标库类名或SVG路径）',
    `parent_id` INT COMMENT '父菜单（关联自身，支持递归查询）',
    CONSTRAINT `fk_menu_menu_a0892170` FOREIGN KEY (`parent_id`) REFERENCES `menu` (`id`) ON DELETE SET NULL,
    KEY `idx_menu_created_88de55` (`created_time`),
    KEY `idx_menu_updated_474266` (`updated_time`),
    KEY `idx_menu_label_d80735` (`label`)
) CHARACTER SET utf8mb4 COMMENT='菜单模型（支持树形结构 + 角色权限控制）';
CREATE TABLE IF NOT EXISTS `project` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '项目名称',
    `desc` VARCHAR(255)   COMMENT '项目描述',
    KEY `idx_project_created_cefad8` (`created_time`),
    KEY `idx_project_updated_11372b` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='项目表';
CREATE TABLE IF NOT EXISTS `component` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '组件名称',
    `path` VARCHAR(255) NOT NULL  COMMENT '组件路径',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    CONSTRAINT `fk_componen_project_41b23582` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    KEY `idx_component_created_a9f7b5` (`created_time`),
    KEY `idx_component_updated_9d04eb` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件表';
CREATE TABLE IF NOT EXISTS `role` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色名称',
    `desc` VARCHAR(50) NOT NULL UNIQUE COMMENT '角色描述',
    KEY `idx_role_created_62e059` (`created_time`),
    KEY `idx_role_updated_05f222` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='角色模型';
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '用户唯一标识',
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `_password` VARCHAR(255) NOT NULL  COMMENT '密码哈希值',
    `is_active` BOOL NOT NULL  COMMENT '账号激活状态' DEFAULT 1,
    `is_delete` BOOL NOT NULL  COMMENT '账号是否删除' DEFAULT 0,
    `last_login_time` DATETIME(6)   COMMENT '最后登录时间',
    `role_id` INT NOT NULL COMMENT '关联角色',
    CONSTRAINT `fk_user_role_68c1d370` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    KEY `idx_user_created_ce7cb5` (`created_time`),
    KEY `idx_user_updated_3ef0f3` (`updated_time`),
    KEY `idx_user_usernam_9987ab` (`username`),
    KEY `idx_user_is_acti_83722a` (`is_active`),
    KEY `idx_user_last_lo_9e225c` (`last_login_time`)
) CHARACTER SET utf8mb4 COMMENT='用户模型';
CREATE  INDEX `idx_active_user_login_composite` ON `user` (`is_active`, `last_login_time`);
CREATE  INDEX `idx_username_unique` ON `user` (`username`);
CREATE TABLE IF NOT EXISTS `env` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `name` VARCHAR(50) NOT NULL UNIQUE COMMENT '环境名称',
    `domain` VARCHAR(255) NOT NULL  COMMENT '环境域名',
    `need_version` BOOL NOT NULL  COMMENT '是否需要获取版本号' DEFAULT 0,
    `desc` VARCHAR(255)   COMMENT '环境描述',
    `project_id` INT NOT NULL COMMENT '关联项目（外键）',
    `user_id` INT NOT NULL COMMENT '关联用户（外键）',
    CONSTRAINT `fk_env_project_9112b9f4` FOREIGN KEY (`project_id`) REFERENCES `project` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_env_user_8630bfa7` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    KEY `idx_env_created_05fa6d` (`created_time`),
    KEY `idx_env_updated_b8f0a4` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='环境表';
CREATE TABLE IF NOT EXISTS `component_version` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `created_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6),
    `updated_time` DATETIME(6) NOT NULL  DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),
    `version` VARCHAR(50) NOT NULL UNIQUE COMMENT '版本号',
    `component_id_id` INT NOT NULL COMMENT '关联组件（外键）',
    `env_id` INT NOT NULL COMMENT '关联环境（外键）',
    CONSTRAINT `fk_componen_componen_28f99cde` FOREIGN KEY (`component_id_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    CONSTRAINT `fk_componen_env_6e2c8891` FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    KEY `idx_component_v_created_41ddcb` (`created_time`),
    KEY `idx_component_v_updated_c29c2c` (`updated_time`)
) CHARACTER SET utf8mb4 COMMENT='组件版本表';
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `component_id` INT NOT NULL,
    `env_id` INT NOT NULL,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_compone_1ed7df` (`component_id`, `env_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `role_menu` (
    `role_id` INT NOT NULL,
    `menu_id` INT NOT NULL,
    FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`menu_id`) REFERENCES `menu` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_role_menu_role_id_90801c` (`role_id`, `menu_id`)
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `env_component` (
    `env_id` INT NOT NULL,
    `component_id` INT NOT NULL,
    FOREIGN KEY (`env_id`) REFERENCES `env` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`component_id`) REFERENCES `component` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_env_compone_env_id_2a2ff4` (`env_id`, `component_id`)
) CHARACTER SET utf8mb4;
[2025-09-18 16:01:46,083] [DEBUG] SELECT `id`,`app`,`content`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 16:01:46,085] [DEBUG] INSERT INTO `aerich` (`version`,`app`,`content`) VALUES (%s,%s,%s): ['1_20250918160146_None.py', 'models', '{"models.Component": {"name": "models.Component", "app": "models", "table": "component", "abstract": false, "description": "\\u7ec4\\u4ef6\\u8868", "docstring": "\\u7ec4\\u4ef6\\u8868", "unique_together": [], "indexes": [], "pk_field": {"name": "id", "field_type": "IntField", "db_column": "id", "python_type": "int", "generated": true, "nullable": false, "unique": true, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}, "data_fields": [{"name": "created_time", "field_type": "DatetimeField", "db_column": "created_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": false}, {"name": "updated_time", "field_type": "DatetimeField", "db_column": "updated_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": true}, {"name": "name", "field_type": "CharField", "db_column": "name", "python_type": "str", "generated": false, "nullable": false, "unique": true, "indexed": true, "default": null, "description": "\\u7ec4\\u4ef6\\u540d\\u79f0", "docstring": null, "constraints": {"max_length": 50}, "db_field_types": {"": "VARCHAR(50)"}}, {"name": "path", "field_type": "CharField", "db_column": "path", "python_type": "str", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u7ec4\\u4ef6\\u8def\\u5f84", "docstring": null, "constraints": {"max_length": 255}, "db_field_types": {"": "VARCHAR(255)"}}, {"name": "project_id", "field_type": "IntField", "db_column": "project_id", "python_type": "int", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u9879\\u76ee\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}], "fk_fields": [{"name": "project", "field_type": "ForeignKeyFieldInstance", "python_type": "models.Project", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u9879\\u76ee\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {}, "db_constraint": true, "raw_field": "project_id", "on_delete": "CASCADE"}], "backward_fk_fields": [{"name": "versions", "field_type": "BackwardFKRelation", "python_type": "models.ComponentVersion", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u7ec4\\u4ef6\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {}, "db_constraint": true}], "o2o_fields": [], "backward_o2o_fields": [], "m2m_fields": [{"name": "envs", "field_type": "ManyToManyFieldInstance", "python_type": "models.Env", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": null, "docstring": null, "constraints": {}, "db_constraint": true, "model_name": "models.Env", "related_name": "components_set", "forward_key": "env_id", "backward_key": "component_id", "through": "env_component", "on_delete": "CASCADE", "_generated": false}, {"name": "related_envs", "field_type": "ManyToManyFieldInstance", "python_type": "models.Env", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": null, "docstring": null, "constraints": {}, "db_constraint": true, "model_name": "models.Env", "related_name": "components", "forward_key": "env_id", "backward_key": "component_id", "through": "env_component", "on_delete": "CASCADE", "_generated": true}]}, "models.ComponentVersion": {"name": "models.ComponentVersion", "app": "models", "table": "component_version", "abstract": false, "description": "\\u7ec4\\u4ef6\\u7248\\u672c\\u8868", "docstring": "\\u7ec4\\u4ef6\\u7248\\u672c\\u8868", "unique_together": [], "indexes": [], "pk_field": {"name": "id", "field_type": "IntField", "db_column": "id", "python_type": "int", "generated": true, "nullable": false, "unique": true, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}, "data_fields": [{"name": "created_time", "field_type": "DatetimeField", "db_column": "created_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": false}, {"name": "updated_time", "field_type": "DatetimeField", "db_column": "updated_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": true}, {"name": "version", "field_type": "CharField", "db_column": "version", "python_type": "str", "generated": false, "nullable": false, "unique": true, "indexed": true, "default": null, "description": "\\u7248\\u672c\\u53f7", "docstring": null, "constraints": {"max_length": 50}, "db_field_types": {"": "VARCHAR(50)"}}, {"name": "component_id_id", "field_type": "IntField", "db_column": "component_id_id", "python_type": "int", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u7ec4\\u4ef6\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}, {"name": "env_id", "field_type": "IntField", "db_column": "env_id", "python_type": "int", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u73af\\u5883\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}], "fk_fields": [{"name": "component_id", "field_type": "ForeignKeyFieldInstance", "python_type": "models.Component", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u7ec4\\u4ef6\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {}, "db_constraint": true, "raw_field": "component_id_id", "on_delete": "CASCADE"}, {"name": "env", "field_type": "ForeignKeyFieldInstance", "python_type": "models.Env", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u73af\\u5883\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {}, "db_constraint": true, "raw_field": "env_id", "on_delete": "CASCADE"}], "backward_fk_fields": [], "o2o_fields": [], "backward_o2o_fields": [], "m2m_fields": []}, "models.Env": {"name": "models.Env", "app": "models", "table": "env", "abstract": false, "description": "\\u73af\\u5883\\u8868", "docstring": "\\u73af\\u5883\\u8868", "unique_together": [], "indexes": [], "pk_field": {"name": "id", "field_type": "IntField", "db_column": "id", "python_type": "int", "generated": true, "nullable": false, "unique": true, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}, "data_fields": [{"name": "created_time", "field_type": "DatetimeField", "db_column": "created_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": false}, {"name": "updated_time", "field_type": "DatetimeField", "db_column": "updated_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": true}, {"name": "name", "field_type": "CharField", "db_column": "name", "python_type": "str", "generated": false, "nullable": false, "unique": true, "indexed": true, "default": null, "description": "\\u73af\\u5883\\u540d\\u79f0", "docstring": null, "constraints": {"max_length": 50}, "db_field_types": {"": "VARCHAR(50)"}}, {"name": "domain", "field_type": "CharField", "db_column": "domain", "python_type": "str", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u73af\\u5883\\u57df\\u540d", "docstring": null, "constraints": {"max_length": 255}, "db_field_types": {"": "VARCHAR(255)"}}, {"name": "need_version", "field_type": "BooleanField", "db_column": "need_version", "python_type": "bool", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": false, "description": "\\u662f\\u5426\\u9700\\u8981\\u83b7\\u53d6\\u7248\\u672c\\u53f7", "docstring": null, "constraints": {}, "db_field_types": {"": "BOOL", "mssql": "BIT", "oracle": "NUMBER(1)", "sqlite": "INT"}}, {"name": "desc", "field_type": "CharField", "db_column": "desc", "python_type": "str", "generated": false, "nullable": true, "unique": false, "indexed": false, "default": null, "description": "\\u73af\\u5883\\u63cf\\u8ff0", "docstring": null, "constraints": {"max_length": 255}, "db_field_types": {"": "VARCHAR(255)"}}, {"name": "project_id", "field_type": "IntField", "db_column": "project_id", "python_type": "int", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u9879\\u76ee\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}, {"name": "user_id", "field_type": "IntField", "db_column": "user_id", "python_type": "int", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u7528\\u6237\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}], "fk_fields": [{"name": "user", "field_type": "ForeignKeyFieldInstance", "python_type": "models.User", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u7528\\u6237\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {}, "db_constraint": true, "raw_field": "user_id", "on_delete": "CASCADE"}, {"name": "project", "field_type": "ForeignKeyFieldInstance", "python_type": "models.Project", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u9879\\u76ee\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {}, "db_constraint": true, "raw_field": "project_id", "on_delete": "CASCADE"}], "backward_fk_fields": [{"name": "versions", "field_type": "BackwardFKRelation", "python_type": "models.ComponentVersion", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u73af\\u5883\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {}, "db_constraint": true}], "o2o_fields": [], "backward_o2o_fields": [], "m2m_fields": [{"name": "components", "field_type": "ManyToManyFieldInstance", "python_type": "models.Component", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": null, "docstring": null, "constraints": {}, "db_constraint": true, "model_name": "models.Component", "related_name": "related_envs", "forward_key": "component_id", "backward_key": "env_id", "through": "env_component", "on_delete": "CASCADE", "_generated": false}, {"name": "components_set", "field_type": "ManyToManyFieldInstance", "python_type": "models.Component", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": null, "docstring": null, "constraints": {}, "db_constraint": true, "model_name": "models.Component", "related_name": "envs", "forward_key": "component_id", "backward_key": "env_id", "through": "env_component", "on_delete": "CASCADE", "_generated": true}]}, "models.Menu": {"name": "models.Menu", "app": "models", "table": "menu", "abstract": false, "description": "\\u83dc\\u5355\\u6a21\\u578b\\uff08\\u652f\\u6301\\u6811\\u5f62\\u7ed3\\u6784 + \\u89d2\\u8272\\u6743\\u9650\\u63a7\\u5236\\uff09", "docstring": "\\u83dc\\u5355\\u6a21\\u578b\\uff08\\u652f\\u6301\\u6811\\u5f62\\u7ed3\\u6784 + \\u89d2\\u8272\\u6743\\u9650\\u63a7\\u5236\\uff09", "unique_together": [], "indexes": [], "pk_field": {"name": "id", "field_type": "IntField", "db_column": "id", "python_type": "int", "generated": true, "nullable": false, "unique": true, "indexed": true, "default": null, "description": "\\u83dc\\u5355\\u552f\\u4e00\\u6807\\u8bc6", "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}, "data_fields": [{"name": "created_time", "field_type": "DatetimeField", "db_column": "created_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": false}, {"name": "updated_time", "field_type": "DatetimeField", "db_column": "updated_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": true}, {"name": "label", "field_type": "CharField", "db_column": "label", "python_type": "str", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": "\\u83dc\\u5355\\u540d\\u79f0\\uff08\\u5e26\\u7d22\\u5f15\\uff0c\\u5feb\\u901f\\u67e5\\u8be2\\uff09", "docstring": null, "constraints": {"max_length": 50}, "db_field_types": {"": "VARCHAR(50)"}}, {"name": "path", "field_type": "CharField", "db_column": "path", "python_type": "str", "generated": false, "nullable": true, "unique": false, "indexed": false, "default": null, "description": "\\u83dc\\u5355\\u8def\\u7531\\u5730\\u5740\\uff08\\u53ef\\u4e3a\\u7a7a\\uff0c\\u5982\\u6309\\u94ae\\u65e0\\u8def\\u7531\\uff09", "docstring": null, "constraints": {"max_length": 255}, "db_field_types": {"": "VARCHAR(255)"}}, {"name": "icon", "field_type": "CharField", "db_column": "icon", "python_type": "str", "generated": false, "nullable": true, "unique": false, "indexed": false, "default": null, "description": "\\u83dc\\u5355\\u56fe\\u6807\\uff08\\u652f\\u6301l\\u56fe\\u6807\\u5e93\\u7c7b\\u540d\\u6216SVG\\u8def\\u5f84\\uff09", "docstring": null, "constraints": {"max_length": 100}, "db_field_types": {"": "VARCHAR(100)"}}, {"name": "parent_id", "field_type": "IntField", "db_column": "parent_id", "python_type": "int", "generated": false, "nullable": true, "unique": false, "indexed": false, "default": null, "description": "\\u7236\\u83dc\\u5355\\uff08\\u5173\\u8054\\u81ea\\u8eab\\uff0c\\u652f\\u6301\\u9012\\u5f52\\u67e5\\u8be2\\uff09", "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}], "fk_fields": [{"name": "parent", "field_type": "ForeignKeyFieldInstance", "python_type": "models.Menu", "generated": false, "nullable": true, "unique": false, "indexed": false, "default": null, "description": "\\u7236\\u83dc\\u5355\\uff08\\u5173\\u8054\\u81ea\\u8eab\\uff0c\\u652f\\u6301\\u9012\\u5f52\\u67e5\\u8be2\\uff09", "docstring": null, "constraints": {}, "db_constraint": true, "raw_field": "parent_id", "on_delete": "SET NULL"}], "backward_fk_fields": [{"name": "children", "field_type": "BackwardFKRelation", "python_type": "models.Menu", "generated": false, "nullable": true, "unique": false, "indexed": false, "default": null, "description": "\\u7236\\u83dc\\u5355\\uff08\\u5173\\u8054\\u81ea\\u8eab\\uff0c\\u652f\\u6301\\u9012\\u5f52\\u67e5\\u8be2\\uff09", "docstring": null, "constraints": {}, "db_constraint": true}], "o2o_fields": [], "backward_o2o_fields": [], "m2m_fields": [{"name": "role_menus", "field_type": "ManyToManyFieldInstance", "python_type": "models.Role", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": null, "docstring": null, "constraints": {}, "db_constraint": true, "model_name": "models.Role", "related_name": "menus", "forward_key": "role_id", "backward_key": "menu_id", "through": "role_menu", "on_delete": "CASCADE", "_generated": true}]}, "models.Project": {"name": "models.Project", "app": "models", "table": "project", "abstract": false, "description": "\\u9879\\u76ee\\u8868", "docstring": "\\u9879\\u76ee\\u8868", "unique_together": [], "indexes": [], "pk_field": {"name": "id", "field_type": "IntField", "db_column": "id", "python_type": "int", "generated": true, "nullable": false, "unique": true, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}, "data_fields": [{"name": "created_time", "field_type": "DatetimeField", "db_column": "created_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": false}, {"name": "updated_time", "field_type": "DatetimeField", "db_column": "updated_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": true}, {"name": "name", "field_type": "CharField", "db_column": "name", "python_type": "str", "generated": false, "nullable": false, "unique": true, "indexed": true, "default": null, "description": "\\u9879\\u76ee\\u540d\\u79f0", "docstring": null, "constraints": {"max_length": 50}, "db_field_types": {"": "VARCHAR(50)"}}, {"name": "desc", "field_type": "CharField", "db_column": "desc", "python_type": "str", "generated": false, "nullable": true, "unique": false, "indexed": false, "default": null, "description": "\\u9879\\u76ee\\u63cf\\u8ff0", "docstring": null, "constraints": {"max_length": 255}, "db_field_types": {"": "VARCHAR(255)"}}], "fk_fields": [], "backward_fk_fields": [{"name": "components", "field_type": "BackwardFKRelation", "python_type": "models.Component", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u9879\\u76ee\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {}, "db_constraint": true}, {"name": "envs", "field_type": "BackwardFKRelation", "python_type": "models.Env", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u9879\\u76ee\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {}, "db_constraint": true}], "o2o_fields": [], "backward_o2o_fields": [], "m2m_fields": []}, "models.Role": {"name": "models.Role", "app": "models", "table": "role", "abstract": false, "description": "\\u89d2\\u8272\\u6a21\\u578b", "docstring": "\\u89d2\\u8272\\u6a21\\u578b\\n\\u7528\\u4e8e\\u5b9a\\u4e49\\u7528\\u6237\\u6743\\u9650\\u96c6\\u5408", "unique_together": [], "indexes": [], "pk_field": {"name": "id", "field_type": "IntField", "db_column": "id", "python_type": "int", "generated": true, "nullable": false, "unique": true, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}, "data_fields": [{"name": "created_time", "field_type": "DatetimeField", "db_column": "created_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": false}, {"name": "updated_time", "field_type": "DatetimeField", "db_column": "updated_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": true}, {"name": "name", "field_type": "CharField", "db_column": "name", "python_type": "str", "generated": false, "nullable": false, "unique": true, "indexed": true, "default": null, "description": "\\u89d2\\u8272\\u540d\\u79f0", "docstring": null, "constraints": {"max_length": 50}, "db_field_types": {"": "VARCHAR(50)"}}, {"name": "desc", "field_type": "CharField", "db_column": "desc", "python_type": "str", "generated": false, "nullable": false, "unique": true, "indexed": true, "default": null, "description": "\\u89d2\\u8272\\u63cf\\u8ff0", "docstring": null, "constraints": {"max_length": 50}, "db_field_types": {"": "VARCHAR(50)"}}], "fk_fields": [], "backward_fk_fields": [{"name": "users", "field_type": "BackwardFKRelation", "python_type": "models.User", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u89d2\\u8272", "docstring": null, "constraints": {}, "db_constraint": true}], "o2o_fields": [], "backward_o2o_fields": [], "m2m_fields": [{"name": "menus", "field_type": "ManyToManyFieldInstance", "python_type": "models.Menu", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": null, "docstring": null, "constraints": {}, "db_constraint": true, "model_name": "models.Menu", "related_name": "role_menus", "forward_key": "menu_id", "backward_key": "role_id", "through": "role_menu", "on_delete": "CASCADE", "_generated": false}]}, "models.User": {"name": "models.User", "app": "models", "table": "user", "abstract": false, "description": "\\u7528\\u6237\\u6a21\\u578b", "docstring": "\\u7528\\u6237\\u6a21\\u578b\\n\\u5305\\u542b\\u57fa\\u672c\\u7528\\u6237\\u4fe1\\u606f\\u548c\\u8ba4\\u8bc1\\u76f8\\u5173\\u5b57\\u6bb5", "unique_together": [], "indexes": [{"type": "index", "val": "gASVlAAAAAAAAACMEHRvcnRvaXNlLmluZGV4ZXOUjAVJbmRleJSTlCmBlH2UKIwGZmllbGRzlF2UKIwJaXNfYWN0aXZllIwPbGFzdF9sb2dpbl90aW1llGWMBG5hbWWUjB9pZHhfYWN0aXZlX3VzZXJfbG9naW5fY29tcG9zaXRllIwLZXhwcmVzc2lvbnOUKYwFZXh0cmGUjACUdWIu"}, {"type": "index", "val": "gASVdAAAAAAAAACMEHRvcnRvaXNlLmluZGV4ZXOUjAVJbmRleJSTlCmBlH2UKIwGZmllbGRzlF2UjAh1c2VybmFtZZRhjARuYW1llIwTaWR4X3VzZXJuYW1lX3VuaXF1ZZSMC2V4cHJlc3Npb25zlCmMBWV4dHJhlIwAlHViLg=="}], "pk_field": {"name": "id", "field_type": "IntField", "db_column": "id", "python_type": "int", "generated": true, "nullable": false, "unique": true, "indexed": true, "default": null, "description": "\\u7528\\u6237\\u552f\\u4e00\\u6807\\u8bc6", "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}, "data_fields": [{"name": "created_time", "field_type": "DatetimeField", "db_column": "created_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": false}, {"name": "updated_time", "field_type": "DatetimeField", "db_column": "updated_time", "python_type": "datetime.datetime", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"readOnly": true}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": true, "auto_now": true}, {"name": "username", "field_type": "CharField", "db_column": "username", "python_type": "str", "generated": false, "nullable": false, "unique": true, "indexed": true, "default": null, "description": "\\u7528\\u6237\\u540d", "docstring": null, "constraints": {"max_length": 50}, "db_field_types": {"": "VARCHAR(50)"}}, {"name": "_password", "field_type": "CharField", "db_column": "_password", "python_type": "str", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5bc6\\u7801\\u54c8\\u5e0c\\u503c", "docstring": null, "constraints": {"max_length": 255}, "db_field_types": {"": "VARCHAR(255)"}}, {"name": "is_active", "field_type": "BooleanField", "db_column": "is_active", "python_type": "bool", "generated": false, "nullable": false, "unique": false, "indexed": true, "default": true, "description": "\\u8d26\\u53f7\\u6fc0\\u6d3b\\u72b6\\u6001", "docstring": null, "constraints": {}, "db_field_types": {"": "BOOL", "mssql": "BIT", "oracle": "NUMBER(1)", "sqlite": "INT"}}, {"name": "is_delete", "field_type": "BooleanField", "db_column": "is_delete", "python_type": "bool", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": false, "description": "\\u8d26\\u53f7\\u662f\\u5426\\u5220\\u9664", "docstring": null, "constraints": {}, "db_field_types": {"": "BOOL", "mssql": "BIT", "oracle": "NUMBER(1)", "sqlite": "INT"}}, {"name": "last_login_time", "field_type": "DatetimeField", "db_column": "last_login_time", "python_type": "datetime.datetime", "generated": false, "nullable": true, "unique": false, "indexed": true, "default": null, "description": "\\u6700\\u540e\\u767b\\u5f55\\u65f6\\u95f4", "docstring": null, "constraints": {}, "db_field_types": {"": "TIMESTAMP", "mssql": "DATETIME2", "mysql": "DATETIME(6)", "oracle": "TIMESTAMP WITH TIME ZONE", "postgres": "TIMESTAMPTZ"}, "auto_now_add": false, "auto_now": false}, {"name": "role_id", "field_type": "IntField", "db_column": "role_id", "python_type": "int", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u89d2\\u8272", "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}], "fk_fields": [{"name": "role", "field_type": "ForeignKeyFieldInstance", "python_type": "models.Role", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u89d2\\u8272", "docstring": null, "constraints": {}, "db_constraint": true, "raw_field": "role_id", "on_delete": "CASCADE"}], "backward_fk_fields": [{"name": "envs", "field_type": "BackwardFKRelation", "python_type": "models.Env", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": "\\u5173\\u8054\\u7528\\u6237\\uff08\\u5916\\u952e\\uff09", "docstring": null, "constraints": {}, "db_constraint": true}], "o2o_fields": [], "backward_o2o_fields": [], "m2m_fields": []}, "models.Aerich": {"name": "models.Aerich", "app": "models", "table": "aerich", "abstract": false, "description": null, "docstring": null, "unique_together": [], "indexes": [], "pk_field": {"name": "id", "field_type": "IntField", "db_column": "id", "python_type": "int", "generated": true, "nullable": false, "unique": true, "indexed": true, "default": null, "description": null, "docstring": null, "constraints": {"ge": -2147483648, "le": 2147483647}, "db_field_types": {"": "INT"}}, "data_fields": [{"name": "version", "field_type": "CharField", "db_column": "version", "python_type": "str", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": null, "docstring": null, "constraints": {"max_length": 255}, "db_field_types": {"": "VARCHAR(255)"}}, {"name": "app", "field_type": "CharField", "db_column": "app", "python_type": "str", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": null, "docstring": null, "constraints": {"max_length": 100}, "db_field_types": {"": "VARCHAR(100)"}}, {"name": "content", "field_type": "JSONField", "db_column": "content", "python_type": "Union[dict, list]", "generated": false, "nullable": false, "unique": false, "indexed": false, "default": null, "description": null, "docstring": null, "constraints": {}, "db_field_types": {"": "JSON", "mssql": "NVARCHAR(MAX)", "oracle": "NCLOB", "postgres": "JSONB"}}], "fk_fields": [], "backward_fk_fields": [], "o2o_fields": [], "backward_o2o_fields": [], "m2m_fields": []}}']
[2025-09-18 16:01:46,090] [DEBUG] Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 16:01:46,091] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 16:01:46,094] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 16:01:46,095] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000019163607470> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 16:01:46,095] [DEBUG] SELECT `id`,`app`,`content`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 16:01:46,097] [DEBUG] select version() as version: None
[2025-09-18 16:01:46,098] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918160146_None.py', 'models', 1]
[2025-09-18 16:01:46,098] [DEBUG] SELECT `id`,`created_time`,`parent_id`,`updated_time`,`label`,`icon`,`path` FROM `menu` WHERE `path`=%s LIMIT %s: ['/home', 2]
[2025-09-18 16:01:46,099] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 667844, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 1, 46, 99322, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '首页', '/home', 'house', None, 1]
[2025-09-18 16:01:46,101] [DEBUG] SELECT `id`,`created_time`,`parent_id`,`updated_time`,`label`,`icon`,`path` FROM `menu` WHERE `path`=%s LIMIT %s: ['/', 2]
[2025-09-18 16:01:46,101] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 668840, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 1, 46, 101319, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '环境', '/', 'location', None, 2]
[2025-09-18 16:01:46,103] [DEBUG] SELECT `id`,`created_time`,`parent_id`,`updated_time`,`label`,`icon`,`path` FROM `menu` WHERE `path`=%s LIMIT %s: ['/env/info', 2]
[2025-09-18 16:01:46,103] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 670842, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 1, 46, 103318, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '环境信息', '/env/info', 'setting', 2, 3]
[2025-09-18 16:01:46,105] [DEBUG] SELECT `id`,`created_time`,`parent_id`,`updated_time`,`label`,`icon`,`path` FROM `menu` WHERE `path`=%s LIMIT %s: ['/env/version', 2]
[2025-09-18 16:01:46,105] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 672346, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 1, 46, 105317, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '组件版本', '/env/version', 'setting', 2, 4]
[2025-09-18 16:01:46,106] [DEBUG] SELECT `id`,`created_time`,`parent_id`,`updated_time`,`label`,`icon`,`path` FROM `menu` WHERE `path`=%s LIMIT %s: ['/env/compare', 2]
[2025-09-18 16:01:46,107] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 673360, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 1, 46, 107318, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '版本比较', '/env/compare', 'setting', 2, 5]
[2025-09-18 16:01:46,109] [DEBUG] SELECT `id`,`created_time`,`parent_id`,`updated_time`,`label`,`icon`,`path` FROM `menu` WHERE `path`=%s LIMIT %s: ['/user', 2]
[2025-09-18 16:01:46,109] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 675362, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 1, 46, 109317, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '用户管理', '/user', 'user', None, 6]
[2025-09-18 16:01:46,111] [DEBUG] SELECT `id`,`created_time`,`parent_id`,`updated_time`,`label`,`icon`,`path` FROM `menu`: []
[2025-09-18 16:01:46,111] [DEBUG] SELECT `id`,`created_time`,`parent_id`,`updated_time`,`label`,`icon`,`path` FROM `menu` WHERE `path`=%s LIMIT %s: ['/user', 2]
[2025-09-18 16:01:46,112] [DEBUG] SELECT `id`,`created_time`,`updated_time`,`desc`,`name` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 16:01:46,113] [DEBUG] DELETE FROM `role_menu` WHERE `role_id`=%s: [1]
[2025-09-18 16:01:46,115] [DEBUG] SELECT `menu_id` FROM `role_menu` WHERE `role_id`=%s AND `menu_id` IN (%s,%s,%s,%s,%s,%s): [1, 1, 2, 3, 4, 5, 6]
[2025-09-18 16:01:46,115] [DEBUG] INSERT INTO `role_menu` (`menu_id`,`role_id`) VALUES (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s): [1, 1, 2, 1, 3, 1, 4, 1, 5, 1, 6, 1]
[2025-09-18 16:01:46,117] [DEBUG] SELECT `id`,`created_time`,`updated_time`,`desc`,`name` FROM `role` WHERE `name`=%s LIMIT %s: ['common', 2]
[2025-09-18 16:01:46,117] [DEBUG] DELETE FROM `role_menu` WHERE `role_id`=%s: [2]
[2025-09-18 16:01:46,118] [DEBUG] SELECT `menu_id` FROM `role_menu` WHERE `role_id`=%s AND `menu_id` IN (%s,%s,%s,%s,%s): [2, 1, 2, 3, 4, 5]
[2025-09-18 16:01:46,119] [DEBUG] INSERT INTO `role_menu` (`menu_id`,`role_id`) VALUES (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s): [1, 2, 2, 2, 3, 2, 4, 2, 5, 2]
[2025-09-18 16:01:46,120] [DEBUG] SELECT `id`,`created_time`,`updated_time`,`desc`,`name` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 16:01:46,121] [DEBUG] SELECT `id`,`username`,`role_id`,`created_time`,`is_active`,`is_delete`,`updated_time`,`_password`,`last_login_time` FROM `user` WHERE `username`=%s LIMIT %s: ['admin', 2]
[2025-09-18 16:01:46,122] [INFO] 超级管理员已存在
[2025-09-18 16:01:46,122] [INFO] Application startup complete.
[2025-09-18 16:02:52,558] [INFO] Shutting down
[2025-09-18 16:02:52,666] [INFO] Waiting for application shutdown.
[2025-09-18 16:02:52,666] [DEBUG] Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 16:02:52,666] [INFO] Tortoise-ORM shutdown
[2025-09-18 16:02:52,666] [INFO] Application shutdown complete.
[2025-09-18 16:02:52,666] [INFO] Finished server process [43756]
[2025-09-18 16:02:55,069] [INFO] Started server process [13016]
[2025-09-18 16:02:55,069] [INFO] Waiting for application startup.
[2025-09-18 16:02:55,069] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 16:02:55,094] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 16:02:55,118] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x0000026963BDD1C0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 16:02:55,119] [DEBUG] SELECT `content`,`app`,`id`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 16:02:55,121] [DEBUG] select version() as version: None
[2025-09-18 16:02:55,121] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918160146_None.py', 'models', 1]
[2025-09-18 16:02:55,122] [DEBUG] SELECT `created_time`,`updated_time`,`path`,`icon`,`parent_id`,`label`,`id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/home', 2]
[2025-09-18 16:02:55,122] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 667844, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 2, 55, 122652, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '首页', '/home', 'house', None, 1]
[2025-09-18 16:02:55,126] [DEBUG] SELECT `created_time`,`updated_time`,`path`,`icon`,`parent_id`,`label`,`id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/', 2]
[2025-09-18 16:02:55,127] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 668840, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 2, 55, 127671, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '环境', '/', 'location', None, 2]
[2025-09-18 16:02:55,128] [DEBUG] SELECT `created_time`,`updated_time`,`path`,`icon`,`parent_id`,`label`,`id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/env/info', 2]
[2025-09-18 16:02:55,129] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 670842, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 2, 55, 129652, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '环境信息', '/env/info', 'setting', 2, 3]
[2025-09-18 16:02:55,130] [DEBUG] SELECT `created_time`,`updated_time`,`path`,`icon`,`parent_id`,`label`,`id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/env/version', 2]
[2025-09-18 16:02:55,130] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 672346, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 2, 55, 130998, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '组件版本', '/env/version', 'setting', 2, 4]
[2025-09-18 16:02:55,132] [DEBUG] SELECT `created_time`,`updated_time`,`path`,`icon`,`parent_id`,`label`,`id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/env/compare', 2]
[2025-09-18 16:02:55,133] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 673360, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 2, 55, 133526, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '版本比较', '/env/compare', 'setting', 2, 5]
[2025-09-18 16:02:55,134] [DEBUG] SELECT `created_time`,`updated_time`,`path`,`icon`,`parent_id`,`label`,`id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/user', 2]
[2025-09-18 16:02:55,135] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 675362, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 2, 55, 135532, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '用户管理', '/user', 'user', None, 6]
[2025-09-18 16:02:55,136] [DEBUG] SELECT `created_time`,`updated_time`,`path`,`icon`,`parent_id`,`label`,`id` FROM `menu`: []
[2025-09-18 16:02:55,137] [DEBUG] SELECT `created_time`,`updated_time`,`path`,`icon`,`parent_id`,`label`,`id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/user', 2]
[2025-09-18 16:02:55,137] [DEBUG] SELECT `created_time`,`name`,`updated_time`,`desc`,`id` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 16:02:55,138] [DEBUG] DELETE FROM `role_menu` WHERE `role_id`=%s: [1]
[2025-09-18 16:02:55,139] [DEBUG] SELECT `menu_id` FROM `role_menu` WHERE `role_id`=%s AND `menu_id` IN (%s,%s,%s,%s,%s,%s): [1, 1, 2, 3, 4, 5, 6]
[2025-09-18 16:02:55,140] [DEBUG] INSERT INTO `role_menu` (`menu_id`,`role_id`) VALUES (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s): [1, 1, 2, 1, 3, 1, 4, 1, 5, 1, 6, 1]
[2025-09-18 16:02:55,141] [DEBUG] SELECT `created_time`,`name`,`updated_time`,`desc`,`id` FROM `role` WHERE `name`=%s LIMIT %s: ['common', 2]
[2025-09-18 16:02:55,141] [DEBUG] DELETE FROM `role_menu` WHERE `role_id`=%s: [2]
[2025-09-18 16:02:55,143] [DEBUG] SELECT `menu_id` FROM `role_menu` WHERE `role_id`=%s AND `menu_id` IN (%s,%s,%s,%s,%s): [2, 1, 2, 3, 4, 5]
[2025-09-18 16:02:55,143] [DEBUG] INSERT INTO `role_menu` (`menu_id`,`role_id`) VALUES (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s): [1, 2, 2, 2, 3, 2, 4, 2, 5, 2]
[2025-09-18 16:02:55,144] [DEBUG] SELECT `created_time`,`name`,`updated_time`,`desc`,`id` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 16:02:55,145] [DEBUG] SELECT `created_time`,`updated_time`,`last_login_time`,`_password`,`role_id`,`id`,`is_delete`,`username`,`is_active` FROM `user` WHERE `username`=%s LIMIT %s: ['admin', 2]
[2025-09-18 16:02:55,145] [INFO] 超级管理员已存在
[2025-09-18 16:02:55,146] [INFO] Application startup complete.
[2025-09-18 16:03:03,626] [INFO] 127.0.0.1:47889 - "OPTIONS /api/user/get_menu HTTP/1.1" 200
[2025-09-18 16:03:03,627] [INFO] 127.0.0.1:43942 - "OPTIONS /api/user/info?page=1&size=10&username= HTTP/1.1" 200
[2025-09-18 16:03:03,651] [INFO] 127.0.0.1:43942 - "GET /api/user/get_menu HTTP/1.1" 401
[2025-09-18 16:03:03,652] [INFO] 127.0.0.1:47889 - "GET /api/user/info?page=1&size=10&username= HTTP/1.1" 401
[2025-09-18 16:03:08,429] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:03:08,429] [DEBUG] Calling on_field_name with data[0:8]
[2025-09-18 16:03:08,430] [DEBUG] Calling on_field_data with data[9:14]
[2025-09-18 16:03:08,430] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:03:08,430] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:03:08,430] [DEBUG] Calling on_field_name with data[15:23]
[2025-09-18 16:03:08,430] [DEBUG] Calling on_field_data with data[24:32]
[2025-09-18 16:03:08,430] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:03:08,430] [DEBUG] Calling on_end with no data
[2025-09-18 16:03:08,432] [DEBUG] SELECT `created_time`,`updated_time`,`last_login_time`,`_password`,`role_id`,`id`,`is_delete`,`username`,`is_active` FROM `user` WHERE `username`=%s LIMIT %s: ['admin', 2]
[2025-09-18 16:03:08,789] [DEBUG] UPDATE `user` SET `created_time`=%s,`updated_time`=%s,`username`=%s,`_password`=%s,`is_active`=%s,`is_delete`=%s,`last_login_time`=%s,`role_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 881226, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 3, 8, 787183, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), 'admin', '$2b$12$v525oPpSO2u.ZcmP6UdBxe0Yfr1NXolrJ86D.OScgsLV87BVJcWZ6', False, False, datetime.datetime(2025, 9, 18, 16, 3, 8, 787183), 1, 1]
[2025-09-18 16:03:08,793] [INFO] 127.0.0.1:47889 - "POST /api/login HTTP/1.1" 200
[2025-09-18 16:03:08,842] [DEBUG] SELECT `user`.`created_time`,`user`.`updated_time`,`user`.`last_login_time`,`user`.`_password`,`user`.`role_id`,`user`.`id`,`user`.`is_delete`,`user`.`username`,`user`.`is_active`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`desc` `user__role.desc`,`user__role`.`id` `user__role.id` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [1, 2]
[2025-09-18 16:03:08,844] [DEBUG] SELECT `created_time`,`name`,`updated_time`,`desc`,`id` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 16:03:08,845] [DEBUG] SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`menu`.`created_time` `created_time`,`menu`.`updated_time` `updated_time`,`menu`.`path` `path`,`menu`.`icon` `icon`,`menu`.`parent_id` `parent_id`,`menu`.`label` `label`,`menu`.`id` `id` FROM `menu` JOIN (SELECT `role_id` `_backward_relation_key`,`menu_id` `_forward_relation_key` FROM `role_menu` WHERE `role_id` IN (%s)) `sq0` ON `sq0`.`_forward_relation_key`=`menu`.`id`: [1]
[2025-09-18 16:03:08,846] [DEBUG] SELECT `menu`.`id` `id`,`menu`.`label` `label`,`menu`.`path` `path`,`menu`.`icon` `icon`,`menu`.`parent_id` `parent_id` FROM `menu` LEFT OUTER JOIN `role_menu` ON `menu`.`id`=`role_menu`.`menu_id` WHERE `role_menu`.`role_id`=%s: [1]
[2025-09-18 16:03:08,848] [INFO] 127.0.0.1:47889 - "GET /api/user/get_menu HTTP/1.1" 200
[2025-09-18 16:03:09,939] [DEBUG] SELECT `user`.`created_time`,`user`.`updated_time`,`user`.`last_login_time`,`user`.`_password`,`user`.`role_id`,`user`.`id`,`user`.`is_delete`,`user`.`username`,`user`.`is_active`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`desc` `user__role.desc`,`user__role`.`id` `user__role.id` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [1, 2]
[2025-09-18 16:03:09,941] [DEBUG] SELECT COUNT(*) FROM `user` WHERE `is_delete`=%s: [False]
[2025-09-18 16:03:09,942] [DEBUG] SELECT `created_time`,`updated_time`,`last_login_time`,`_password`,`role_id`,`id`,`is_delete`,`username`,`is_active` FROM `user` WHERE `is_delete`=%s ORDER BY `id` DESC LIMIT %s OFFSET %s: [False, 10, 0]
[2025-09-18 16:03:09,943] [DEBUG] SELECT `created_time`,`name`,`updated_time`,`desc`,`id` FROM `role` WHERE `id`=%s: [1]
[2025-09-18 16:03:09,944] [INFO] 127.0.0.1:47889 - "GET /api/user/info?page=1&size=10&username= HTTP/1.1" 200
[2025-09-18 16:03:20,238] [INFO] 127.0.0.1:29528 - "OPTIONS /api/user/add_user HTTP/1.1" 200
[2025-09-18 16:03:20,239] [DEBUG] SELECT `user`.`created_time`,`user`.`updated_time`,`user`.`last_login_time`,`user`.`_password`,`user`.`role_id`,`user`.`id`,`user`.`is_delete`,`user`.`username`,`user`.`is_active`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`desc` `user__role.desc`,`user__role`.`id` `user__role.id` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [1, 2]
[2025-09-18 16:03:20,244] [DEBUG] SELECT `created_time`,`name`,`updated_time`,`desc`,`id` FROM `role` WHERE `name`=%s LIMIT %s: ['common', 2]
[2025-09-18 16:03:20,245] [DEBUG] SELECT 1 FROM `user` WHERE `username`=%s LIMIT %s: ['common', 1]
[2025-09-18 16:03:20,571] [DEBUG] INSERT INTO `user` (`created_time`,`updated_time`,`username`,`_password`,`is_active`,`is_delete`,`last_login_time`,`role_id`) VALUES (%s,%s,%s,%s,%s,%s,%s,%s): [datetime.datetime(2025, 9, 18, 16, 3, 20, 571459, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 3, 20, 571459, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), 'common', '$2b$12$PoIRW1YGHs4BKnWoQPiLHe62LbKhMOblF3a5av4BjcB6Wv1xgpPsW', False, False, None, 2]
[2025-09-18 16:03:20,574] [INFO] 127.0.0.1:29528 - "POST /api/user/add_user HTTP/1.1" 200
[2025-09-18 16:03:20,586] [DEBUG] SELECT `user`.`created_time`,`user`.`updated_time`,`user`.`last_login_time`,`user`.`_password`,`user`.`role_id`,`user`.`id`,`user`.`is_delete`,`user`.`username`,`user`.`is_active`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`desc` `user__role.desc`,`user__role`.`id` `user__role.id` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [1, 2]
[2025-09-18 16:03:20,588] [DEBUG] SELECT COUNT(*) FROM `user` WHERE `is_delete`=%s: [False]
[2025-09-18 16:03:20,589] [DEBUG] SELECT `created_time`,`updated_time`,`last_login_time`,`_password`,`role_id`,`id`,`is_delete`,`username`,`is_active` FROM `user` WHERE `is_delete`=%s ORDER BY `id` DESC LIMIT %s OFFSET %s: [False, 10, 0]
[2025-09-18 16:03:20,591] [DEBUG] SELECT `created_time`,`name`,`updated_time`,`desc`,`id` FROM `role` WHERE `id` IN (%s,%s): [2, 1]
[2025-09-18 16:03:20,593] [INFO] 127.0.0.1:29528 - "GET /api/user/info?page=1&size=10&username= HTTP/1.1" 200
[2025-09-18 16:03:33,998] [INFO] 127.0.0.1:40870 - "GET /docs HTTP/1.1" 200
[2025-09-18 16:03:35,221] [INFO] 127.0.0.1:40870 - "GET /openapi.json HTTP/1.1" 200
[2025-09-18 16:03:50,805] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:03:50,807] [DEBUG] Calling on_field_name with data[0:10]
[2025-09-18 16:03:50,807] [DEBUG] Calling on_field_data with data[11:19]
[2025-09-18 16:03:50,807] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:03:50,807] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:03:50,807] [DEBUG] Calling on_field_name with data[20:28]
[2025-09-18 16:03:50,807] [DEBUG] Calling on_field_data with data[29:34]
[2025-09-18 16:03:50,807] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:03:50,807] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:03:50,807] [DEBUG] Calling on_field_name with data[35:43]
[2025-09-18 16:03:50,807] [DEBUG] Calling on_field_data with data[44:52]
[2025-09-18 16:03:50,807] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:03:50,807] [DEBUG] Calling on_end with no data
[2025-09-18 16:03:50,810] [DEBUG] SELECT `created_time`,`updated_time`,`last_login_time`,`_password`,`role_id`,`id`,`is_delete`,`username`,`is_active` FROM `user` WHERE `username`=%s LIMIT %s: ['admin', 2]
[2025-09-18 16:03:51,211] [DEBUG] UPDATE `user` SET `created_time`=%s,`updated_time`=%s,`username`=%s,`_password`=%s,`is_active`=%s,`is_delete`=%s,`last_login_time`=%s,`role_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 881226, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 3, 51, 210630, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), 'admin', '$2b$12$v525oPpSO2u.ZcmP6UdBxe0Yfr1NXolrJ86D.OScgsLV87BVJcWZ6', False, False, datetime.datetime(2025, 9, 18, 16, 3, 51, 210630), 1, 1]
[2025-09-18 16:03:51,215] [INFO] 127.0.0.1:25817 - "POST /api/login HTTP/1.1" 200
[2025-09-18 16:03:56,474] [INFO] 127.0.0.1:9085 - "GET /docs HTTP/1.1" 200
[2025-09-18 16:03:56,532] [INFO] 127.0.0.1:9085 - "GET /openapi.json HTTP/1.1" 200
[2025-09-18 16:04:07,753] [INFO] 127.0.0.1:22488 - "GET /api/user/info?page=1&size=10 HTTP/1.1" 401
[2025-09-18 16:04:17,858] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:04:17,858] [DEBUG] Calling on_field_name with data[0:10]
[2025-09-18 16:04:17,858] [DEBUG] Calling on_field_data with data[11:19]
[2025-09-18 16:04:17,858] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:04:17,858] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:04:17,858] [DEBUG] Calling on_field_name with data[20:28]
[2025-09-18 16:04:17,859] [DEBUG] Calling on_field_data with data[29:34]
[2025-09-18 16:04:17,859] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:04:17,859] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:04:17,859] [DEBUG] Calling on_field_name with data[35:43]
[2025-09-18 16:04:17,859] [DEBUG] Calling on_field_data with data[44:52]
[2025-09-18 16:04:17,859] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:04:17,859] [DEBUG] Calling on_end with no data
[2025-09-18 16:04:17,860] [DEBUG] SELECT `created_time`,`updated_time`,`last_login_time`,`_password`,`role_id`,`id`,`is_delete`,`username`,`is_active` FROM `user` WHERE `username`=%s LIMIT %s: ['admin', 2]
[2025-09-18 16:04:18,268] [DEBUG] UPDATE `user` SET `created_time`=%s,`updated_time`=%s,`username`=%s,`_password`=%s,`is_active`=%s,`is_delete`=%s,`last_login_time`=%s,`role_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 881226, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 4, 18, 268196, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), 'admin', '$2b$12$v525oPpSO2u.ZcmP6UdBxe0Yfr1NXolrJ86D.OScgsLV87BVJcWZ6', False, False, datetime.datetime(2025, 9, 18, 16, 4, 18, 268196), 1, 1]
[2025-09-18 16:04:18,273] [INFO] 127.0.0.1:56306 - "POST /api/login HTTP/1.1" 200
[2025-09-18 16:04:27,009] [INFO] 127.0.0.1:2241 - "GET /api/user/info?page=1&size=10&username=superuser HTTP/1.1" 401
[2025-09-18 16:07:49,394] [INFO] Shutting down
[2025-09-18 16:07:49,499] [INFO] Waiting for application shutdown.
[2025-09-18 16:07:49,499] [DEBUG] Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 16:07:49,500] [INFO] Tortoise-ORM shutdown
[2025-09-18 16:07:49,500] [INFO] Application shutdown complete.
[2025-09-18 16:07:49,500] [INFO] Finished server process [13016]
[2025-09-18 16:07:51,265] [INFO] Started server process [23104]
[2025-09-18 16:07:51,265] [INFO] Waiting for application startup.
[2025-09-18 16:07:51,265] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 16:07:51,291] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 16:07:51,318] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001FBD16B5A00> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 16:07:51,318] [DEBUG] SELECT `version`,`id`,`content`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 16:07:51,321] [DEBUG] select version() as version: None
[2025-09-18 16:07:51,322] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918160146_None.py', 'models', 1]
[2025-09-18 16:07:51,322] [DEBUG] SELECT `id`,`updated_time`,`parent_id`,`label`,`created_time`,`path`,`icon` FROM `menu` WHERE `path`=%s LIMIT %s: ['/home', 2]
[2025-09-18 16:07:51,322] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 667844, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 7, 51, 322173, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '首页', '/home', 'house', None, 1]
[2025-09-18 16:07:51,325] [DEBUG] SELECT `id`,`updated_time`,`parent_id`,`label`,`created_time`,`path`,`icon` FROM `menu` WHERE `path`=%s LIMIT %s: ['/', 2]
[2025-09-18 16:07:51,327] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 668840, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 7, 51, 327200, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '环境', '/', 'location', None, 2]
[2025-09-18 16:07:51,328] [DEBUG] SELECT `id`,`updated_time`,`parent_id`,`label`,`created_time`,`path`,`icon` FROM `menu` WHERE `path`=%s LIMIT %s: ['/env/info', 2]
[2025-09-18 16:07:51,328] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 670842, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 7, 51, 328980, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '环境信息', '/env/info', 'setting', 2, 3]
[2025-09-18 16:07:51,330] [DEBUG] SELECT `id`,`updated_time`,`parent_id`,`label`,`created_time`,`path`,`icon` FROM `menu` WHERE `path`=%s LIMIT %s: ['/env/version', 2]
[2025-09-18 16:07:51,330] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 672346, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 7, 51, 330611, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '组件版本', '/env/version', 'setting', 2, 4]
[2025-09-18 16:07:51,333] [DEBUG] SELECT `id`,`updated_time`,`parent_id`,`label`,`created_time`,`path`,`icon` FROM `menu` WHERE `path`=%s LIMIT %s: ['/env/compare', 2]
[2025-09-18 16:07:51,333] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 673360, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 7, 51, 333907, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '版本比较', '/env/compare', 'setting', 2, 5]
[2025-09-18 16:07:51,335] [DEBUG] SELECT `id`,`updated_time`,`parent_id`,`label`,`created_time`,`path`,`icon` FROM `menu` WHERE `path`=%s LIMIT %s: ['/user', 2]
[2025-09-18 16:07:51,336] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 675362, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 7, 51, 336932, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '用户管理', '/user', 'user', None, 6]
[2025-09-18 16:07:51,338] [DEBUG] SELECT `id`,`updated_time`,`parent_id`,`label`,`created_time`,`path`,`icon` FROM `menu`: []
[2025-09-18 16:07:51,339] [DEBUG] SELECT `id`,`updated_time`,`parent_id`,`label`,`created_time`,`path`,`icon` FROM `menu` WHERE `path`=%s LIMIT %s: ['/user', 2]
[2025-09-18 16:07:51,340] [DEBUG] SELECT `id`,`updated_time`,`desc`,`name`,`created_time` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 16:07:51,341] [DEBUG] DELETE FROM `role_menu` WHERE `role_id`=%s: [1]
[2025-09-18 16:07:51,342] [DEBUG] SELECT `menu_id` FROM `role_menu` WHERE `role_id`=%s AND `menu_id` IN (%s,%s,%s,%s,%s,%s): [1, 1, 2, 3, 4, 5, 6]
[2025-09-18 16:07:51,343] [DEBUG] INSERT INTO `role_menu` (`menu_id`,`role_id`) VALUES (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s): [1, 1, 2, 1, 3, 1, 4, 1, 5, 1, 6, 1]
[2025-09-18 16:07:51,345] [DEBUG] SELECT `id`,`updated_time`,`desc`,`name`,`created_time` FROM `role` WHERE `name`=%s LIMIT %s: ['common', 2]
[2025-09-18 16:07:51,346] [DEBUG] DELETE FROM `role_menu` WHERE `role_id`=%s: [2]
[2025-09-18 16:07:51,348] [DEBUG] SELECT `menu_id` FROM `role_menu` WHERE `role_id`=%s AND `menu_id` IN (%s,%s,%s,%s,%s): [2, 1, 2, 3, 4, 5]
[2025-09-18 16:07:51,349] [DEBUG] INSERT INTO `role_menu` (`menu_id`,`role_id`) VALUES (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s): [1, 2, 2, 2, 3, 2, 4, 2, 5, 2]
[2025-09-18 16:07:51,351] [DEBUG] SELECT `id`,`updated_time`,`desc`,`name`,`created_time` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 16:07:51,352] [DEBUG] SELECT `_password`,`id`,`is_active`,`updated_time`,`username`,`role_id`,`is_delete`,`last_login_time`,`created_time` FROM `user` WHERE `username`=%s LIMIT %s: ['admin', 2]
[2025-09-18 16:07:51,353] [INFO] 超级管理员已存在
[2025-09-18 16:07:51,353] [INFO] Application startup complete.
[2025-09-18 16:08:09,132] [INFO] 127.0.0.1:33072 - "GET /docs HTTP/1.1" 200
[2025-09-18 16:08:09,211] [INFO] 127.0.0.1:33072 - "GET /openapi.json HTTP/1.1" 200
[2025-09-18 16:08:17,133] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:08:17,133] [DEBUG] Calling on_field_name with data[0:10]
[2025-09-18 16:08:17,133] [DEBUG] Calling on_field_data with data[11:19]
[2025-09-18 16:08:17,134] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:08:17,134] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:08:17,134] [DEBUG] Calling on_field_name with data[20:28]
[2025-09-18 16:08:17,134] [DEBUG] Calling on_field_data with data[29:34]
[2025-09-18 16:08:17,134] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:08:17,134] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:08:17,134] [DEBUG] Calling on_field_name with data[35:43]
[2025-09-18 16:08:17,134] [DEBUG] Calling on_field_data with data[44:52]
[2025-09-18 16:08:17,134] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:08:17,134] [DEBUG] Calling on_end with no data
[2025-09-18 16:08:17,136] [DEBUG] SELECT `_password`,`id`,`is_active`,`updated_time`,`username`,`role_id`,`is_delete`,`last_login_time`,`created_time` FROM `user` WHERE `username`=%s LIMIT %s: ['admin', 2]
[2025-09-18 16:08:17,516] [DEBUG] UPDATE `user` SET `created_time`=%s,`updated_time`=%s,`username`=%s,`_password`=%s,`is_active`=%s,`is_delete`=%s,`last_login_time`=%s,`role_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 881226, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 8, 17, 514994, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), 'admin', '$2b$12$v525oPpSO2u.ZcmP6UdBxe0Yfr1NXolrJ86D.OScgsLV87BVJcWZ6', False, False, datetime.datetime(2025, 9, 18, 16, 8, 17, 513969), 1, 1]
[2025-09-18 16:08:17,536] [INFO] 127.0.0.1:30353 - "POST /api/login HTTP/1.1" 200
[2025-09-18 16:08:28,785] [INFO] 127.0.0.1:3130 - "GET /api/user/info?page=1&size=10 HTTP/1.1" 401
[2025-09-18 16:08:30,271] [INFO] 127.0.0.1:3130 - "GET /api/user/info?page=1&size=10 HTTP/1.1" 401
[2025-09-18 16:12:50,384] [INFO] Shutting down
[2025-09-18 16:12:50,490] [INFO] Waiting for application shutdown.
[2025-09-18 16:12:50,491] [DEBUG] Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 16:12:50,491] [INFO] Tortoise-ORM shutdown
[2025-09-18 16:12:50,491] [INFO] Application shutdown complete.
[2025-09-18 16:12:50,491] [INFO] Finished server process [23104]
[2025-09-18 16:12:51,256] [INFO] Started server process [44296]
[2025-09-18 16:12:51,256] [INFO] Waiting for application startup.
[2025-09-18 16:12:51,256] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 16:12:51,281] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 16:12:51,307] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x00000253DBDAD1C0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 16:12:51,307] [DEBUG] SELECT `version`,`content`,`app`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 16:12:51,309] [DEBUG] select version() as version: None
[2025-09-18 16:12:51,310] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918160146_None.py', 'models', 1]
[2025-09-18 16:12:51,311] [DEBUG] SELECT `updated_time`,`parent_id`,`label`,`path`,`created_time`,`icon`,`id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/home', 2]
[2025-09-18 16:12:51,311] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 667844, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 12, 51, 311176, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '首页', '/home', 'house', None, 1]
[2025-09-18 16:12:51,314] [DEBUG] SELECT `updated_time`,`parent_id`,`label`,`path`,`created_time`,`icon`,`id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/', 2]
[2025-09-18 16:12:51,315] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 668840, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 12, 51, 315177, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '环境', '/', 'location', None, 2]
[2025-09-18 16:12:51,317] [DEBUG] SELECT `updated_time`,`parent_id`,`label`,`path`,`created_time`,`icon`,`id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/env/info', 2]
[2025-09-18 16:12:51,318] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 670842, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 12, 51, 318161, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '环境信息', '/env/info', 'setting', 2, 3]
[2025-09-18 16:12:51,319] [DEBUG] SELECT `updated_time`,`parent_id`,`label`,`path`,`created_time`,`icon`,`id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/env/version', 2]
[2025-09-18 16:12:51,320] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 672346, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 12, 51, 320634, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '组件版本', '/env/version', 'setting', 2, 4]
[2025-09-18 16:12:51,322] [DEBUG] SELECT `updated_time`,`parent_id`,`label`,`path`,`created_time`,`icon`,`id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/env/compare', 2]
[2025-09-18 16:12:51,322] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 673360, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 12, 51, 322136, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '版本比较', '/env/compare', 'setting', 2, 5]
[2025-09-18 16:12:51,323] [DEBUG] SELECT `updated_time`,`parent_id`,`label`,`path`,`created_time`,`icon`,`id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/user', 2]
[2025-09-18 16:12:51,324] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 675362, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 12, 51, 324166, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '用户管理', '/user', 'user', None, 6]
[2025-09-18 16:12:51,325] [DEBUG] SELECT `updated_time`,`parent_id`,`label`,`path`,`created_time`,`icon`,`id` FROM `menu`: []
[2025-09-18 16:12:51,326] [DEBUG] SELECT `updated_time`,`parent_id`,`label`,`path`,`created_time`,`icon`,`id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/user', 2]
[2025-09-18 16:12:51,327] [DEBUG] SELECT `updated_time`,`name`,`created_time`,`desc`,`id` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 16:12:51,327] [DEBUG] DELETE FROM `role_menu` WHERE `role_id`=%s: [1]
[2025-09-18 16:12:51,328] [DEBUG] SELECT `menu_id` FROM `role_menu` WHERE `role_id`=%s AND `menu_id` IN (%s,%s,%s,%s,%s,%s): [1, 1, 2, 3, 4, 5, 6]
[2025-09-18 16:12:51,328] [DEBUG] INSERT INTO `role_menu` (`menu_id`,`role_id`) VALUES (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s): [1, 1, 2, 1, 3, 1, 4, 1, 5, 1, 6, 1]
[2025-09-18 16:12:51,330] [DEBUG] SELECT `updated_time`,`name`,`created_time`,`desc`,`id` FROM `role` WHERE `name`=%s LIMIT %s: ['common', 2]
[2025-09-18 16:12:51,330] [DEBUG] DELETE FROM `role_menu` WHERE `role_id`=%s: [2]
[2025-09-18 16:12:51,331] [DEBUG] SELECT `menu_id` FROM `role_menu` WHERE `role_id`=%s AND `menu_id` IN (%s,%s,%s,%s,%s): [2, 1, 2, 3, 4, 5]
[2025-09-18 16:12:51,332] [DEBUG] INSERT INTO `role_menu` (`menu_id`,`role_id`) VALUES (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s): [1, 2, 2, 2, 3, 2, 4, 2, 5, 2]
[2025-09-18 16:12:51,333] [DEBUG] SELECT `updated_time`,`name`,`created_time`,`desc`,`id` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 16:12:51,333] [DEBUG] SELECT `is_active`,`_password`,`updated_time`,`role_id`,`last_login_time`,`created_time`,`username`,`is_delete`,`id` FROM `user` WHERE `username`=%s LIMIT %s: ['admin', 2]
[2025-09-18 16:12:51,335] [INFO] 超级管理员已存在
[2025-09-18 16:12:51,335] [INFO] Application startup complete.
[2025-09-18 16:12:51,411] [ERROR] Traceback (most recent call last):
  File "D:\python\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\asyncio\base_events.py", line 685, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\python\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "D:\python\Lib\asyncio\runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\env\fastapi_platform\Lib\site-packages\starlette\routing.py", line 741, in lifespan
    await receive()
  File "E:\env\fastapi_platform\Lib\site-packages\uvicorn\lifespan\on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\asyncio\queues.py", line 158, in get
    await getter
asyncio.exceptions.CancelledError

[2025-09-18 16:12:52,166] [INFO] Started server process [30364]
[2025-09-18 16:12:52,166] [INFO] Waiting for application startup.
[2025-09-18 16:12:52,167] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 16:12:52,192] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 16:12:52,216] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x00000223B0B4BC20> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 16:12:52,216] [DEBUG] SELECT `version`,`content`,`app`,`id` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 16:12:52,219] [DEBUG] select version() as version: None
[2025-09-18 16:12:52,220] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918160146_None.py', 'models', 1]
[2025-09-18 16:12:52,220] [DEBUG] SELECT `updated_time`,`icon`,`created_time`,`id`,`parent_id`,`path`,`label` FROM `menu` WHERE `path`=%s LIMIT %s: ['/home', 2]
[2025-09-18 16:12:52,222] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 667844, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 12, 52, 222017, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '首页', '/home', 'house', None, 1]
[2025-09-18 16:12:52,224] [DEBUG] SELECT `updated_time`,`icon`,`created_time`,`id`,`parent_id`,`path`,`label` FROM `menu` WHERE `path`=%s LIMIT %s: ['/', 2]
[2025-09-18 16:12:52,224] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 668840, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 12, 52, 224838, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '环境', '/', 'location', None, 2]
[2025-09-18 16:12:52,226] [DEBUG] SELECT `updated_time`,`icon`,`created_time`,`id`,`parent_id`,`path`,`label` FROM `menu` WHERE `path`=%s LIMIT %s: ['/env/info', 2]
[2025-09-18 16:12:52,226] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 670842, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 12, 52, 226544, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '环境信息', '/env/info', 'setting', 2, 3]
[2025-09-18 16:12:52,228] [DEBUG] SELECT `updated_time`,`icon`,`created_time`,`id`,`parent_id`,`path`,`label` FROM `menu` WHERE `path`=%s LIMIT %s: ['/env/version', 2]
[2025-09-18 16:12:52,228] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 672346, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 12, 52, 228938, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '组件版本', '/env/version', 'setting', 2, 4]
[2025-09-18 16:12:52,230] [DEBUG] SELECT `updated_time`,`icon`,`created_time`,`id`,`parent_id`,`path`,`label` FROM `menu` WHERE `path`=%s LIMIT %s: ['/env/compare', 2]
[2025-09-18 16:12:52,230] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 673360, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 12, 52, 230634, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '版本比较', '/env/compare', 'setting', 2, 5]
[2025-09-18 16:12:52,232] [DEBUG] SELECT `updated_time`,`icon`,`created_time`,`id`,`parent_id`,`path`,`label` FROM `menu` WHERE `path`=%s LIMIT %s: ['/user', 2]
[2025-09-18 16:12:52,232] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 675362, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 12, 52, 232881, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '用户管理', '/user', 'user', None, 6]
[2025-09-18 16:12:52,233] [DEBUG] SELECT `updated_time`,`icon`,`created_time`,`id`,`parent_id`,`path`,`label` FROM `menu`: []
[2025-09-18 16:12:52,234] [DEBUG] SELECT `updated_time`,`icon`,`created_time`,`id`,`parent_id`,`path`,`label` FROM `menu` WHERE `path`=%s LIMIT %s: ['/user', 2]
[2025-09-18 16:12:52,235] [DEBUG] SELECT `desc`,`updated_time`,`created_time`,`name`,`id` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 16:12:52,235] [DEBUG] DELETE FROM `role_menu` WHERE `role_id`=%s: [1]
[2025-09-18 16:12:52,237] [DEBUG] SELECT `menu_id` FROM `role_menu` WHERE `role_id`=%s AND `menu_id` IN (%s,%s,%s,%s,%s,%s): [1, 1, 2, 3, 4, 5, 6]
[2025-09-18 16:12:52,237] [DEBUG] INSERT INTO `role_menu` (`menu_id`,`role_id`) VALUES (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s): [1, 1, 2, 1, 3, 1, 4, 1, 5, 1, 6, 1]
[2025-09-18 16:12:52,238] [DEBUG] SELECT `desc`,`updated_time`,`created_time`,`name`,`id` FROM `role` WHERE `name`=%s LIMIT %s: ['common', 2]
[2025-09-18 16:12:52,239] [DEBUG] DELETE FROM `role_menu` WHERE `role_id`=%s: [2]
[2025-09-18 16:12:52,240] [DEBUG] SELECT `menu_id` FROM `role_menu` WHERE `role_id`=%s AND `menu_id` IN (%s,%s,%s,%s,%s): [2, 1, 2, 3, 4, 5]
[2025-09-18 16:12:52,240] [DEBUG] INSERT INTO `role_menu` (`menu_id`,`role_id`) VALUES (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s): [1, 2, 2, 2, 3, 2, 4, 2, 5, 2]
[2025-09-18 16:12:52,242] [DEBUG] SELECT `desc`,`updated_time`,`created_time`,`name`,`id` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 16:12:52,243] [DEBUG] SELECT `updated_time`,`last_login_time`,`role_id`,`created_time`,`is_active`,`username`,`id`,`is_delete`,`_password` FROM `user` WHERE `username`=%s LIMIT %s: ['admin', 2]
[2025-09-18 16:12:52,244] [INFO] 超级管理员已存在
[2025-09-18 16:12:52,244] [INFO] Application startup complete.
[2025-09-18 16:15:49,711] [INFO] 127.0.0.1:39496 - "OPTIONS /api/user/get_menu HTTP/1.1" 200
[2025-09-18 16:15:49,711] [INFO] 127.0.0.1:4622 - "OPTIONS /api/user/info?page=1&size=10&username= HTTP/1.1" 200
[2025-09-18 16:15:49,747] [INFO] 127.0.0.1:4622 - "GET /api/user/get_menu HTTP/1.1" 401
[2025-09-18 16:15:49,748] [INFO] 127.0.0.1:39496 - "GET /api/user/info?page=1&size=10&username= HTTP/1.1" 401
[2025-09-18 16:15:57,106] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:15:57,106] [DEBUG] Calling on_field_name with data[0:8]
[2025-09-18 16:15:57,106] [DEBUG] Calling on_field_data with data[9:14]
[2025-09-18 16:15:57,106] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:15:57,106] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:15:57,106] [DEBUG] Calling on_field_name with data[15:23]
[2025-09-18 16:15:57,106] [DEBUG] Calling on_field_data with data[24:32]
[2025-09-18 16:15:57,106] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:15:57,106] [DEBUG] Calling on_end with no data
[2025-09-18 16:15:57,109] [DEBUG] SELECT `updated_time`,`last_login_time`,`role_id`,`created_time`,`is_active`,`username`,`id`,`is_delete`,`_password` FROM `user` WHERE `username`=%s LIMIT %s: ['admin', 2]
[2025-09-18 16:15:57,493] [DEBUG] UPDATE `user` SET `created_time`=%s,`updated_time`=%s,`username`=%s,`_password`=%s,`is_active`=%s,`is_delete`=%s,`last_login_time`=%s,`role_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 881226, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 15, 57, 493380, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), 'admin', '$2b$12$v525oPpSO2u.ZcmP6UdBxe0Yfr1NXolrJ86D.OScgsLV87BVJcWZ6', False, False, datetime.datetime(2025, 9, 18, 16, 15, 57, 493380), 1, 1]
[2025-09-18 16:15:57,494] [INFO] Shutting down
[2025-09-18 16:15:57,500] [INFO] 127.0.0.1:60000 - "POST /api/login HTTP/1.1" 200
[2025-09-18 16:15:57,609] [INFO] Waiting for application shutdown.
[2025-09-18 16:15:57,610] [DEBUG] Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 16:15:57,610] [INFO] Tortoise-ORM shutdown
[2025-09-18 16:15:57,611] [INFO] Application shutdown complete.
[2025-09-18 16:15:57,611] [INFO] Finished server process [30364]
[2025-09-18 16:15:58,532] [ERROR] Error loading ASGI app. Attribute "app" not found in module "app".
[2025-09-18 16:15:59,227] [ERROR] Error loading ASGI app. Attribute "app" not found in module "app".
[2025-09-18 16:16:02,448] [ERROR] Error loading ASGI app. Attribute "app" not found in module "app".
[2025-09-18 16:18:10,367] [ERROR] Error loading ASGI app. Attribute "app" not found in module "app".
[2025-09-18 16:18:14,478] [ERROR] Error loading ASGI app. Attribute "app" not found in module "app".
[2025-09-18 16:18:33,040] [ERROR] Error loading ASGI app. Attribute "app" not found in module "app".
[2025-09-18 16:18:55,517] [INFO] Started server process [22140]
[2025-09-18 16:18:55,517] [INFO] Waiting for application startup.
[2025-09-18 16:18:55,518] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 16:18:55,549] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 16:18:55,575] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001AA4C637740> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 16:18:55,575] [DEBUG] SELECT `content`,`id`,`app`,`version` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 16:18:55,578] [DEBUG] select version() as version: None
[2025-09-18 16:18:55,579] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918160146_None.py', 'models', 1]
[2025-09-18 16:18:55,580] [DEBUG] SELECT `created_time`,`label`,`id`,`icon`,`updated_time`,`parent_id`,`path` FROM `menu` WHERE `path`=%s LIMIT %s: ['/home', 2]
[2025-09-18 16:18:55,581] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 667844, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 18, 55, 581941, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '首页', '/home', 'house', None, 1]
[2025-09-18 16:18:55,585] [DEBUG] SELECT `created_time`,`label`,`id`,`icon`,`updated_time`,`parent_id`,`path` FROM `menu` WHERE `path`=%s LIMIT %s: ['/', 2]
[2025-09-18 16:18:55,586] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 668840, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 18, 55, 586429, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '环境', '/', 'location', None, 2]
[2025-09-18 16:18:55,588] [DEBUG] SELECT `created_time`,`label`,`id`,`icon`,`updated_time`,`parent_id`,`path` FROM `menu` WHERE `path`=%s LIMIT %s: ['/env/info', 2]
[2025-09-18 16:18:55,588] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 670842, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 18, 55, 588427, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '环境信息', '/env/info', 'setting', 2, 3]
[2025-09-18 16:18:55,590] [DEBUG] SELECT `created_time`,`label`,`id`,`icon`,`updated_time`,`parent_id`,`path` FROM `menu` WHERE `path`=%s LIMIT %s: ['/env/version', 2]
[2025-09-18 16:18:55,590] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 672346, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 18, 55, 590931, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '组件版本', '/env/version', 'setting', 2, 4]
[2025-09-18 16:18:55,592] [DEBUG] SELECT `created_time`,`label`,`id`,`icon`,`updated_time`,`parent_id`,`path` FROM `menu` WHERE `path`=%s LIMIT %s: ['/env/compare', 2]
[2025-09-18 16:18:55,593] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 673360, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 18, 55, 593599, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '版本比较', '/env/compare', 'setting', 2, 5]
[2025-09-18 16:18:55,594] [DEBUG] SELECT `created_time`,`label`,`id`,`icon`,`updated_time`,`parent_id`,`path` FROM `menu` WHERE `path`=%s LIMIT %s: ['/user', 2]
[2025-09-18 16:18:55,596] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 675362, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 18, 55, 596101, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '用户管理', '/user', 'user', None, 6]
[2025-09-18 16:18:55,597] [DEBUG] SELECT `created_time`,`label`,`id`,`icon`,`updated_time`,`parent_id`,`path` FROM `menu`: []
[2025-09-18 16:18:55,597] [DEBUG] SELECT `created_time`,`label`,`id`,`icon`,`updated_time`,`parent_id`,`path` FROM `menu` WHERE `path`=%s LIMIT %s: ['/user', 2]
[2025-09-18 16:18:55,599] [DEBUG] SELECT `created_time`,`name`,`id`,`desc`,`updated_time` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 16:18:55,599] [DEBUG] DELETE FROM `role_menu` WHERE `role_id`=%s: [1]
[2025-09-18 16:18:55,601] [DEBUG] SELECT `menu_id` FROM `role_menu` WHERE `role_id`=%s AND `menu_id` IN (%s,%s,%s,%s,%s,%s): [1, 1, 2, 3, 4, 5, 6]
[2025-09-18 16:18:55,603] [DEBUG] INSERT INTO `role_menu` (`menu_id`,`role_id`) VALUES (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s): [1, 1, 2, 1, 3, 1, 4, 1, 5, 1, 6, 1]
[2025-09-18 16:18:55,605] [DEBUG] SELECT `created_time`,`name`,`id`,`desc`,`updated_time` FROM `role` WHERE `name`=%s LIMIT %s: ['common', 2]
[2025-09-18 16:18:55,605] [DEBUG] DELETE FROM `role_menu` WHERE `role_id`=%s: [2]
[2025-09-18 16:18:55,607] [DEBUG] SELECT `menu_id` FROM `role_menu` WHERE `role_id`=%s AND `menu_id` IN (%s,%s,%s,%s,%s): [2, 1, 2, 3, 4, 5]
[2025-09-18 16:18:55,607] [DEBUG] INSERT INTO `role_menu` (`menu_id`,`role_id`) VALUES (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s): [1, 2, 2, 2, 3, 2, 4, 2, 5, 2]
[2025-09-18 16:18:55,609] [DEBUG] SELECT `created_time`,`name`,`id`,`desc`,`updated_time` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 16:18:55,610] [DEBUG] SELECT `is_active`,`created_time`,`role_id`,`id`,`_password`,`is_delete`,`updated_time`,`username`,`last_login_time` FROM `user` WHERE `username`=%s LIMIT %s: ['admin', 2]
[2025-09-18 16:18:55,611] [INFO] 超级管理员已存在
[2025-09-18 16:18:55,611] [INFO] Application startup complete.
[2025-09-18 16:19:01,644] [INFO] 127.0.0.1:35918 - "GET /api/user/get_menu HTTP/1.1" 401
[2025-09-18 16:19:10,099] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:19:10,099] [DEBUG] Calling on_field_name with data[0:8]
[2025-09-18 16:19:10,099] [DEBUG] Calling on_field_data with data[9:14]
[2025-09-18 16:19:10,099] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:19:10,099] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:19:10,099] [DEBUG] Calling on_field_name with data[15:23]
[2025-09-18 16:19:10,100] [DEBUG] Calling on_field_data with data[24:32]
[2025-09-18 16:19:10,100] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:19:10,100] [DEBUG] Calling on_end with no data
[2025-09-18 16:19:10,101] [DEBUG] SELECT `is_active`,`created_time`,`role_id`,`id`,`_password`,`is_delete`,`updated_time`,`username`,`last_login_time` FROM `user` WHERE `username`=%s LIMIT %s: ['admin', 2]
[2025-09-18 16:19:10,508] [DEBUG] UPDATE `user` SET `created_time`=%s,`updated_time`=%s,`username`=%s,`_password`=%s,`is_active`=%s,`is_delete`=%s,`last_login_time`=%s,`role_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 881226, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 19, 10, 507881, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), 'admin', '$2b$12$v525oPpSO2u.ZcmP6UdBxe0Yfr1NXolrJ86D.OScgsLV87BVJcWZ6', False, False, datetime.datetime(2025, 9, 18, 16, 19, 10, 507881), 1, 1]
[2025-09-18 16:19:10,514] [INFO] 127.0.0.1:8304 - "POST /api/login HTTP/1.1" 200
[2025-09-18 16:19:10,540] [DEBUG] SELECT `user`.`is_active`,`user`.`created_time`,`user`.`role_id`,`user`.`id`,`user`.`_password`,`user`.`is_delete`,`user`.`updated_time`,`user`.`username`,`user`.`last_login_time`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`id` `user__role.id`,`user__role`.`desc` `user__role.desc`,`user__role`.`updated_time` `user__role.updated_time` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [1, 2]
[2025-09-18 16:19:10,544] [DEBUG] SELECT `created_time`,`name`,`id`,`desc`,`updated_time` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 16:19:10,546] [DEBUG] SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`menu`.`created_time` `created_time`,`menu`.`label` `label`,`menu`.`id` `id`,`menu`.`icon` `icon`,`menu`.`updated_time` `updated_time`,`menu`.`parent_id` `parent_id`,`menu`.`path` `path` FROM `menu` JOIN (SELECT `role_id` `_backward_relation_key`,`menu_id` `_forward_relation_key` FROM `role_menu` WHERE `role_id` IN (%s)) `sq0` ON `sq0`.`_forward_relation_key`=`menu`.`id`: [1]
[2025-09-18 16:19:10,548] [DEBUG] SELECT `menu`.`id` `id`,`menu`.`label` `label`,`menu`.`path` `path`,`menu`.`icon` `icon`,`menu`.`parent_id` `parent_id` FROM `menu` LEFT OUTER JOIN `role_menu` ON `menu`.`id`=`role_menu`.`menu_id` WHERE `role_menu`.`role_id`=%s: [1]
[2025-09-18 16:19:10,551] [INFO] 127.0.0.1:8304 - "GET /api/user/get_menu HTTP/1.1" 200
[2025-09-18 16:19:11,743] [DEBUG] SELECT `user`.`is_active`,`user`.`created_time`,`user`.`role_id`,`user`.`id`,`user`.`_password`,`user`.`is_delete`,`user`.`updated_time`,`user`.`username`,`user`.`last_login_time`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`id` `user__role.id`,`user__role`.`desc` `user__role.desc`,`user__role`.`updated_time` `user__role.updated_time` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [1, 2]
[2025-09-18 16:19:11,746] [DEBUG] SELECT COUNT(*) FROM `user` WHERE `is_delete`=%s: [False]
[2025-09-18 16:19:11,747] [DEBUG] SELECT `is_active`,`created_time`,`role_id`,`id`,`_password`,`is_delete`,`updated_time`,`username`,`last_login_time` FROM `user` WHERE `is_delete`=%s ORDER BY `id` DESC LIMIT %s OFFSET %s: [False, 10, 0]
[2025-09-18 16:19:11,750] [DEBUG] SELECT `created_time`,`name`,`id`,`desc`,`updated_time` FROM `role` WHERE `id` IN (%s,%s): [2, 1]
[2025-09-18 16:19:11,752] [INFO] 127.0.0.1:8304 - "GET /api/user/info?page=1&size=10&username= HTTP/1.1" 200
[2025-09-18 16:24:06,922] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:24:06,922] [DEBUG] Calling on_field_name with data[0:10]
[2025-09-18 16:24:06,922] [DEBUG] Calling on_field_data with data[11:19]
[2025-09-18 16:24:06,922] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:24:06,923] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:24:06,923] [DEBUG] Calling on_field_name with data[20:28]
[2025-09-18 16:24:06,923] [DEBUG] Calling on_field_data with data[29:34]
[2025-09-18 16:24:06,923] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:24:06,923] [DEBUG] Calling on_end with no data
[2025-09-18 16:24:06,928] [INFO] 127.0.0.1:1174 - "POST /api/login HTTP/1.1" 422
[2025-09-18 16:24:17,753] [DEBUG] SELECT `user`.`is_active`,`user`.`created_time`,`user`.`role_id`,`user`.`id`,`user`.`_password`,`user`.`is_delete`,`user`.`updated_time`,`user`.`username`,`user`.`last_login_time`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`id` `user__role.id`,`user__role`.`desc` `user__role.desc`,`user__role`.`updated_time` `user__role.updated_time` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [1, 2]
[2025-09-18 16:24:17,757] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 16:24:17,759] [DEBUG] SELECT `user`.`is_active`,`user`.`created_time`,`user`.`role_id`,`user`.`id`,`user`.`_password`,`user`.`is_delete`,`user`.`updated_time`,`user`.`username`,`user`.`last_login_time`,`user__role`.`created_time` `user__role.created_time`,`user__role`.`name` `user__role.name`,`user__role`.`id` `user__role.id`,`user__role`.`desc` `user__role.desc`,`user__role`.`updated_time` `user__role.updated_time` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [1, 2]
[2025-09-18 16:24:17,761] [DEBUG] SELECT `created_time`,`name`,`id`,`desc`,`updated_time` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 16:24:17,763] [DEBUG] SELECT COUNT(*) FROM `user` WHERE `is_delete`=%s: [False]
[2025-09-18 16:24:17,765] [DEBUG] SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`menu`.`created_time` `created_time`,`menu`.`label` `label`,`menu`.`id` `id`,`menu`.`icon` `icon`,`menu`.`updated_time` `updated_time`,`menu`.`parent_id` `parent_id`,`menu`.`path` `path` FROM `menu` JOIN (SELECT `role_id` `_backward_relation_key`,`menu_id` `_forward_relation_key` FROM `role_menu` WHERE `role_id` IN (%s)) `sq0` ON `sq0`.`_forward_relation_key`=`menu`.`id`: [1]
[2025-09-18 16:24:17,766] [DEBUG] SELECT `is_active`,`created_time`,`role_id`,`id`,`_password`,`is_delete`,`updated_time`,`username`,`last_login_time` FROM `user` WHERE `is_delete`=%s ORDER BY `id` DESC LIMIT %s OFFSET %s: [False, 10, 0]
[2025-09-18 16:24:17,768] [DEBUG] SELECT `created_time`,`name`,`id`,`desc`,`updated_time` FROM `role` WHERE `id` IN (%s,%s): [2, 1]
[2025-09-18 16:24:17,769] [DEBUG] SELECT `menu`.`id` `id`,`menu`.`label` `label`,`menu`.`path` `path`,`menu`.`icon` `icon`,`menu`.`parent_id` `parent_id` FROM `menu` LEFT OUTER JOIN `role_menu` ON `menu`.`id`=`role_menu`.`menu_id` WHERE `role_menu`.`role_id`=%s: [1]
[2025-09-18 16:24:17,771] [INFO] 127.0.0.1:1851 - "GET /api/user/info?page=1&size=10&username= HTTP/1.1" 200
[2025-09-18 16:24:17,773] [INFO] 127.0.0.1:8331 - "GET /api/user/get_menu HTTP/1.1" 200
[2025-09-18 16:25:29,520] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:25:29,520] [DEBUG] Calling on_field_name with data[0:10]
[2025-09-18 16:25:29,520] [DEBUG] Calling on_field_data with data[11:19]
[2025-09-18 16:25:29,520] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:25:29,520] [DEBUG] Calling on_end with no data
[2025-09-18 16:25:29,521] [INFO] 127.0.0.1:34797 - "POST /api/login HTTP/1.1" 422
[2025-09-18 16:25:30,149] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:25:30,150] [DEBUG] Calling on_field_name with data[0:10]
[2025-09-18 16:25:30,150] [DEBUG] Calling on_field_data with data[11:19]
[2025-09-18 16:25:30,150] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:25:30,150] [DEBUG] Calling on_end with no data
[2025-09-18 16:25:30,150] [INFO] 127.0.0.1:34797 - "POST /api/login HTTP/1.1" 422
[2025-09-18 16:25:30,635] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:25:30,635] [DEBUG] Calling on_field_name with data[0:10]
[2025-09-18 16:25:30,635] [DEBUG] Calling on_field_data with data[11:19]
[2025-09-18 16:25:30,635] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:25:30,635] [DEBUG] Calling on_end with no data
[2025-09-18 16:25:30,636] [INFO] 127.0.0.1:34797 - "POST /api/login HTTP/1.1" 422
[2025-09-18 16:25:31,189] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:25:31,189] [DEBUG] Calling on_field_name with data[0:10]
[2025-09-18 16:25:31,189] [DEBUG] Calling on_field_data with data[11:19]
[2025-09-18 16:25:31,189] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:25:31,189] [DEBUG] Calling on_end with no data
[2025-09-18 16:25:31,191] [INFO] 127.0.0.1:34797 - "POST /api/login HTTP/1.1" 422
[2025-09-18 16:25:52,643] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:25:52,643] [DEBUG] Calling on_field_name with data[0:10]
[2025-09-18 16:25:52,643] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:25:52,643] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:25:52,643] [DEBUG] Calling on_field_name with data[12:20]
[2025-09-18 16:25:52,643] [DEBUG] Calling on_field_data with data[21:26]
[2025-09-18 16:25:52,643] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:25:52,643] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:25:52,643] [DEBUG] Calling on_field_name with data[27:35]
[2025-09-18 16:25:52,643] [DEBUG] Calling on_field_data with data[36:44]
[2025-09-18 16:25:52,643] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:25:52,643] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:25:52,644] [DEBUG] Calling on_field_name with data[45:50]
[2025-09-18 16:25:52,644] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:25:52,644] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:25:52,644] [DEBUG] Calling on_field_name with data[52:61]
[2025-09-18 16:25:52,644] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:25:52,644] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:25:52,644] [DEBUG] Calling on_field_name with data[63:76]
[2025-09-18 16:25:52,645] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:25:52,645] [DEBUG] Calling on_end with no data
[2025-09-18 16:25:52,646] [DEBUG] SELECT `is_active`,`created_time`,`role_id`,`id`,`_password`,`is_delete`,`updated_time`,`username`,`last_login_time` FROM `user` WHERE `username`=%s LIMIT %s: ['admin', 2]
[2025-09-18 16:25:52,989] [DEBUG] UPDATE `user` SET `created_time`=%s,`updated_time`=%s,`username`=%s,`_password`=%s,`is_active`=%s,`is_delete`=%s,`last_login_time`=%s,`role_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 881226, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 25, 52, 989203, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), 'admin', '$2b$12$v525oPpSO2u.ZcmP6UdBxe0Yfr1NXolrJ86D.OScgsLV87BVJcWZ6', False, False, datetime.datetime(2025, 9, 18, 16, 25, 52, 987482), 1, 1]
[2025-09-18 16:25:52,993] [INFO] 127.0.0.1:29446 - "POST /api/login HTTP/1.1" 200
[2025-09-18 16:26:45,928] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:26:45,928] [DEBUG] Calling on_field_name with data[0:10]
[2025-09-18 16:26:45,928] [DEBUG] Calling on_field_data with data[11:19]
[2025-09-18 16:26:45,928] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:26:45,928] [DEBUG] Calling on_end with no data
[2025-09-18 16:26:45,928] [INFO] 127.0.0.1:44856 - "POST /api/login HTTP/1.1" 422
[2025-09-18 16:26:46,582] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:26:46,582] [DEBUG] Calling on_field_name with data[0:10]
[2025-09-18 16:26:46,582] [DEBUG] Calling on_field_data with data[11:19]
[2025-09-18 16:26:46,582] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:26:46,582] [DEBUG] Calling on_end with no data
[2025-09-18 16:26:46,582] [INFO] 127.0.0.1:44856 - "POST /api/login HTTP/1.1" 422
[2025-09-18 16:26:47,161] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:26:47,161] [DEBUG] Calling on_field_name with data[0:10]
[2025-09-18 16:26:47,161] [DEBUG] Calling on_field_data with data[11:19]
[2025-09-18 16:26:47,161] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:26:47,161] [DEBUG] Calling on_end with no data
[2025-09-18 16:26:47,162] [INFO] 127.0.0.1:44856 - "POST /api/login HTTP/1.1" 422
[2025-09-18 16:26:47,610] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:26:47,610] [DEBUG] Calling on_field_name with data[0:10]
[2025-09-18 16:26:47,610] [DEBUG] Calling on_field_data with data[11:19]
[2025-09-18 16:26:47,610] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:26:47,610] [DEBUG] Calling on_end with no data
[2025-09-18 16:26:47,611] [INFO] 127.0.0.1:44856 - "POST /api/login HTTP/1.1" 422
[2025-09-18 16:28:17,689] [INFO] Shutting down
[2025-09-18 16:28:19,927] [INFO] Started server process [40168]
[2025-09-18 16:28:19,927] [INFO] Waiting for application startup.
[2025-09-18 16:28:19,928] [DEBUG] Tortoise-ORM startup
    connections: {'mysql': {'engine': 'tortoise.backends.mysql', 'credentials': {'host': 'localhost', 'port': 3306, 'user': 'root', 'password': 'ya***', 'database': 'platform'}}}
    apps: {'models': {'models': ['app.models', 'aerich.models'], 'default_connection': 'mysql'}}
[2025-09-18 16:28:19,958] [DEBUG] caching sha2: succeeded by fast path.
[2025-09-18 16:28:19,982] [DEBUG] Created connection <aiomysql.pool.Pool object at 0x000001E109E7D880> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'platform', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
[2025-09-18 16:28:19,982] [DEBUG] SELECT `content`,`version`,`id`,`app` FROM `aerich` WHERE `app`=%s ORDER BY `id` DESC LIMIT %s: ['models', 1]
[2025-09-18 16:28:19,984] [DEBUG] select version() as version: None
[2025-09-18 16:28:19,985] [DEBUG] SELECT 1 FROM `aerich` WHERE `version`=%s AND `app`=%s LIMIT %s: ['1_20250918160146_None.py', 'models', 1]
[2025-09-18 16:28:19,986] [DEBUG] SELECT `icon`,`id`,`label`,`path`,`updated_time`,`created_time`,`parent_id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/home', 2]
[2025-09-18 16:28:19,989] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 667844, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 28, 19, 989793, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '首页', '/home', 'house', None, 1]
[2025-09-18 16:28:19,992] [DEBUG] SELECT `icon`,`id`,`label`,`path`,`updated_time`,`created_time`,`parent_id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/', 2]
[2025-09-18 16:28:19,993] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 668840, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 28, 19, 993167, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '环境', '/', 'location', None, 2]
[2025-09-18 16:28:19,995] [DEBUG] SELECT `icon`,`id`,`label`,`path`,`updated_time`,`created_time`,`parent_id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/env/info', 2]
[2025-09-18 16:28:19,996] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 670842, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 28, 19, 996005, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '环境信息', '/env/info', 'setting', 2, 3]
[2025-09-18 16:28:19,997] [DEBUG] SELECT `icon`,`id`,`label`,`path`,`updated_time`,`created_time`,`parent_id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/env/version', 2]
[2025-09-18 16:28:19,998] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 672346, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 28, 19, 998319, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '组件版本', '/env/version', 'setting', 2, 4]
[2025-09-18 16:28:19,999] [DEBUG] SELECT `icon`,`id`,`label`,`path`,`updated_time`,`created_time`,`parent_id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/env/compare', 2]
[2025-09-18 16:28:20,000] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 673360, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 28, 20, 909, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '版本比较', '/env/compare', 'setting', 2, 5]
[2025-09-18 16:28:20,001] [DEBUG] SELECT `icon`,`id`,`label`,`path`,`updated_time`,`created_time`,`parent_id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/user', 2]
[2025-09-18 16:28:20,002] [DEBUG] UPDATE `menu` SET `created_time`=%s,`updated_time`=%s,`label`=%s,`path`=%s,`icon`=%s,`parent_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 675362, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 28, 20, 2893, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), '用户管理', '/user', 'user', None, 6]
[2025-09-18 16:28:20,004] [DEBUG] SELECT `icon`,`id`,`label`,`path`,`updated_time`,`created_time`,`parent_id` FROM `menu`: []
[2025-09-18 16:28:20,004] [DEBUG] SELECT `icon`,`id`,`label`,`path`,`updated_time`,`created_time`,`parent_id` FROM `menu` WHERE `path`=%s LIMIT %s: ['/user', 2]
[2025-09-18 16:28:20,005] [DEBUG] SELECT `id`,`name`,`desc`,`updated_time`,`created_time` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 16:28:20,006] [DEBUG] DELETE FROM `role_menu` WHERE `role_id`=%s: [1]
[2025-09-18 16:28:20,008] [DEBUG] SELECT `menu_id` FROM `role_menu` WHERE `role_id`=%s AND `menu_id` IN (%s,%s,%s,%s,%s,%s): [1, 1, 2, 3, 4, 5, 6]
[2025-09-18 16:28:20,009] [DEBUG] INSERT INTO `role_menu` (`menu_id`,`role_id`) VALUES (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s): [1, 1, 2, 1, 3, 1, 4, 1, 5, 1, 6, 1]
[2025-09-18 16:28:20,010] [DEBUG] SELECT `id`,`name`,`desc`,`updated_time`,`created_time` FROM `role` WHERE `name`=%s LIMIT %s: ['common', 2]
[2025-09-18 16:28:20,011] [DEBUG] DELETE FROM `role_menu` WHERE `role_id`=%s: [2]
[2025-09-18 16:28:20,012] [DEBUG] SELECT `menu_id` FROM `role_menu` WHERE `role_id`=%s AND `menu_id` IN (%s,%s,%s,%s,%s): [2, 1, 2, 3, 4, 5]
[2025-09-18 16:28:20,013] [DEBUG] INSERT INTO `role_menu` (`menu_id`,`role_id`) VALUES (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s): [1, 2, 2, 2, 3, 2, 4, 2, 5, 2]
[2025-09-18 16:28:20,015] [DEBUG] SELECT `id`,`name`,`desc`,`updated_time`,`created_time` FROM `role` WHERE `name`=%s LIMIT %s: ['superuser', 2]
[2025-09-18 16:28:20,015] [DEBUG] SELECT `last_login_time`,`id`,`_password`,`username`,`is_active`,`role_id`,`is_delete`,`updated_time`,`created_time` FROM `user` WHERE `username`=%s LIMIT %s: ['admin', 2]
[2025-09-18 16:28:20,016] [INFO] 超级管理员已存在
[2025-09-18 16:28:20,016] [INFO] Application startup complete.
[2025-09-18 16:28:23,659] [INFO] 127.0.0.1:25613 - "GET /docs HTTP/1.1" 200
[2025-09-18 16:28:23,731] [INFO] 127.0.0.1:25613 - "GET /openapi.json HTTP/1.1" 200
[2025-09-18 16:28:39,004] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:28:39,005] [DEBUG] Calling on_field_name with data[0:10]
[2025-09-18 16:28:39,005] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:28:39,005] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:28:39,005] [DEBUG] Calling on_field_name with data[12:20]
[2025-09-18 16:28:39,005] [DEBUG] Calling on_field_data with data[21:26]
[2025-09-18 16:28:39,005] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:28:39,005] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:28:39,005] [DEBUG] Calling on_field_name with data[27:35]
[2025-09-18 16:28:39,005] [DEBUG] Calling on_field_data with data[36:44]
[2025-09-18 16:28:39,005] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:28:39,005] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:28:39,005] [DEBUG] Calling on_field_name with data[45:50]
[2025-09-18 16:28:39,005] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:28:39,006] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:28:39,006] [DEBUG] Calling on_field_name with data[52:61]
[2025-09-18 16:28:39,006] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:28:39,006] [DEBUG] Calling on_field_start with no data
[2025-09-18 16:28:39,006] [DEBUG] Calling on_field_name with data[63:76]
[2025-09-18 16:28:39,006] [DEBUG] Calling on_field_end with no data
[2025-09-18 16:28:39,006] [DEBUG] Calling on_end with no data
[2025-09-18 16:28:39,007] [DEBUG] SELECT `last_login_time`,`id`,`_password`,`username`,`is_active`,`role_id`,`is_delete`,`updated_time`,`created_time` FROM `user` WHERE `username`=%s LIMIT %s: ['admin', 2]
[2025-09-18 16:28:39,362] [DEBUG] UPDATE `user` SET `created_time`=%s,`updated_time`=%s,`username`=%s,`_password`=%s,`is_active`=%s,`is_delete`=%s,`last_login_time`=%s,`role_id`=%s WHERE `id`=%s: [datetime.datetime(2025, 9, 18, 15, 46, 31, 881226, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 28, 39, 361679, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), 'admin', '$2b$12$v525oPpSO2u.ZcmP6UdBxe0Yfr1NXolrJ86D.OScgsLV87BVJcWZ6', False, False, datetime.datetime(2025, 9, 18, 16, 28, 39, 361679), 1, 1]
[2025-09-18 16:28:39,374] [INFO] 127.0.0.1:47208 - "POST /api/login HTTP/1.1" 200
[2025-09-18 16:29:26,171] [DEBUG] SELECT `user`.`last_login_time`,`user`.`id`,`user`.`_password`,`user`.`username`,`user`.`is_active`,`user`.`role_id`,`user`.`is_delete`,`user`.`updated_time`,`user`.`created_time`,`user__role`.`id` `user__role.id`,`user__role`.`name` `user__role.name`,`user__role`.`desc` `user__role.desc`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`created_time` `user__role.created_time` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [1, 2]
[2025-09-18 16:29:26,174] [DEBUG] SELECT COUNT(*) FROM `user` WHERE `is_delete`=%s: [False]
[2025-09-18 16:29:26,175] [DEBUG] SELECT `last_login_time`,`id`,`_password`,`username`,`is_active`,`role_id`,`is_delete`,`updated_time`,`created_time` FROM `user` WHERE `is_delete`=%s ORDER BY `id` DESC LIMIT %s OFFSET %s: [False, 10, 0]
[2025-09-18 16:29:26,177] [DEBUG] SELECT `id`,`name`,`desc`,`updated_time`,`created_time` FROM `role` WHERE `id` IN (%s,%s): [2, 1]
[2025-09-18 16:29:26,179] [INFO] 127.0.0.1:21064 - "GET /api/user/info?page=1&size=10 HTTP/1.1" 200
[2025-09-18 16:30:22,769] [DEBUG] SELECT `user`.`last_login_time`,`user`.`id`,`user`.`_password`,`user`.`username`,`user`.`is_active`,`user`.`role_id`,`user`.`is_delete`,`user`.`updated_time`,`user`.`created_time`,`user__role`.`id` `user__role.id`,`user__role`.`name` `user__role.name`,`user__role`.`desc` `user__role.desc`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`created_time` `user__role.created_time` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [1, 2]
[2025-09-18 16:30:22,773] [DEBUG] SELECT `id`,`name`,`desc`,`updated_time`,`created_time` FROM `project` WHERE `name`=%s LIMIT %s: ['Scnet', 1]
[2025-09-18 16:30:22,775] [DEBUG] INSERT INTO `project` (`created_time`,`updated_time`,`name`,`desc`) VALUES (%s,%s,%s,%s): [datetime.datetime(2025, 9, 18, 16, 30, 22, 775733, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 30, 22, 775733, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), 'Scnet', 'Scnet平台']
[2025-09-18 16:30:22,778] [INFO] 127.0.0.1:6092 - "POST /api/env/add_project HTTP/1.1" 200
[2025-09-18 16:31:43,589] [DEBUG] SELECT `user`.`last_login_time`,`user`.`id`,`user`.`_password`,`user`.`username`,`user`.`is_active`,`user`.`role_id`,`user`.`is_delete`,`user`.`updated_time`,`user`.`created_time`,`user__role`.`id` `user__role.id`,`user__role`.`name` `user__role.name`,`user__role`.`desc` `user__role.desc`,`user__role`.`updated_time` `user__role.updated_time`,`user__role`.`created_time` `user__role.created_time` FROM `user` LEFT OUTER JOIN `role` `user__role` ON `user__role`.`id`=`user`.`role_id` WHERE `user`.`id`=%s LIMIT %s: [1, 2]
[2025-09-18 16:31:43,591] [DEBUG] SELECT `user_id`,`id`,`name`,`domain`,`need_version`,`project_id`,`desc`,`updated_time`,`created_time` FROM `env` WHERE `name`=%s LIMIT %s: ['itos', 1]
[2025-09-18 16:31:43,593] [DEBUG] SELECT `id`,`name`,`desc`,`updated_time`,`created_time` FROM `project` WHERE `id`=%s LIMIT %s: [1, 2]
[2025-09-18 16:31:43,593] [DEBUG] INSERT INTO `env` (`created_time`,`updated_time`,`name`,`domain`,`need_version`,`desc`,`project_id`,`user_id`) VALUES (%s,%s,%s,%s,%s,%s,%s,%s): [datetime.datetime(2025, 9, 18, 16, 31, 43, 593899, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), datetime.datetime(2025, 9, 18, 16, 31, 43, 593899, tzinfo=<DstTzInfo 'Asia/Shanghai' CST+8:00:00 STD>), 'itos', 'https://itos.sugon.com/', True, '平台项目scnet', 1, 1]
[2025-09-18 16:31:43,596] [INFO] 127.0.0.1:2841 - "POST /api/env/add_env HTTP/1.1" 200
